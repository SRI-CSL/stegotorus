function getDeviceType(){var e="",b=/\b(Kindle|Fire|Silk|blaze)\b/.test(window.navigator.userAgent),d=/\b(Android)\b/.test(window.navigator.userAgent),a=/\b(iPhone)\b/.test(window.navigator.userAgent),c=/\b(iPad)\b/.test(window.navigator.userAgent),f=/\b(iPod)\b/.test(window.navigator.userAgent);if(b&&d){e="kindle";}else{if(b){e="kindle";}else{if(d){e="android";}else{if(a){e="iphone";}else{if(c){e="ipad";}else{if(f){e="ipod";}}}}}}return e;}$j(document).ready(function(){var a=getDeviceType();switch(a){case"ipad":$j("#cnn_ipadappbanner").html('<div class="cnn_ipadappbanner1"><a href="http://itunes.apple.com/us/app/cnn-app-for-ipad/id407824176?mt=8"><img src="http://i.cdn.turner.com/cnn/.e/img/3.0/main/CNN_iPad_banner_980x50_120910.png" alt="" border="0" height="50" width="980"/></a></div>');break;case"android":$j("#cnn_ipadappbanner").html('<div class="cnn_ipadappbanner1"><a href="https://play.google.com/store/apps/details?id=com.cnn.mobile.android.tablet"><img src="http://i.cdn.turner.com/cnn/.e/img/3.0/main/CNN_Android_banner_cross_sell.jpg" alt="" border="0" height="50" width="980"/></a></div>');break;case"iphone":$j("#cnn_ipadappbanner").html('<div class="cnn_ipadappbanner1"><a href="http://itunes.com/app/cnnmobile"><img src="http://i.cdn.turner.com/cnn/.element/img/3.0/main/cnn_long_iPhone_cross_sell.jpg" alt="" border="0" width="100%"/></a></div>');break;case"kindle":$j("#cnn_ipadappbanner").html('<div class="cnn_ipadappbanner1"><a href="http://www.amazon.com/gp/product/B0093QQCGI"><img src="http://i.cdn.turner.com/cnn/.e/img/3.0/main/CNN_Kindle.jpg" alt="" border="0" width="100%"/></a></div>');break;}});function cnnMakeHP(){var a;if(navigator.userAgent.indexOf("MSIE")<0){a=new CNN_handleOverlay("homepage_set_overlay");}}function linkTrackCall(a){var b=s_gi(s_account);b.linkTrackVars="none";b.linkTrackEvents="none";b.tl(this,"o",a);}var swfobject=function(){var aq="undefined",aD="object",ab="Shockwave Flash",X="ShockwaveFlash.ShockwaveFlash",aE="application/x-shockwave-flash",ac="SWFObjectExprInst",ax="onreadystatechange",af=window,aL=document,aB=navigator,aa=false,Z=[aN],aG=[],ag=[],al=[],aJ,ad,ap,at,ak=false,aU=false,aH,an,aI=true,ah=function(){var a=typeof aL.getElementById!=aq&&typeof aL.getElementsByTagName!=aq&&typeof aL.createElement!=aq,e=aB.userAgent.toLowerCase(),c=aB.platform.toLowerCase(),h=c?/win/.test(c):/win/.test(e),l=c?/mac/.test(c):/mac/.test(e),g=/webkit/.test(e)?parseFloat(e.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,d=!+"\v1",f=[0,0,0],m=null;if(typeof aB.plugins!=aq&&typeof aB.plugins[ab]==aD){m=aB.plugins[ab].description;if(m&&!(typeof aB.mimeTypes!=aq&&aB.mimeTypes[aE]&&!aB.mimeTypes[aE].enabledPlugin)){aa=true;d=false;m=m.replace(/^.*\s+(\S+\s+\S+$)/,"$1");f[0]=parseInt(m.replace(/^(.*)\..*$/,"$1"),10);f[1]=parseInt(m.replace(/^.*\.(.*)\s.*$/,"$1"),10);f[2]=/[a-zA-Z]/.test(m)?parseInt(m.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else{if(typeof af.ActiveXObject!=aq){try{var k=new ActiveXObject(X);if(k){m=k.GetVariable("$version");if(m){d=true;m=m.split(" ")[1].split(",");f=[parseInt(m[0],10),parseInt(m[1],10),parseInt(m[2],10)];}}}catch(b){}}}return{w3:a,pv:f,wk:g,ie:d,win:h,mac:l};}(),aK=function(){if(!ah.w3){return;}if((typeof aL.readyState!=aq&&aL.readyState=="complete")||(typeof aL.readyState==aq&&(aL.getElementsByTagName("body")[0]||aL.body))){aP();}if(!ak){if(typeof aL.addEventListener!=aq){aL.addEventListener("DOMContentLoaded",aP,false);}if(ah.ie&&ah.win){aL.attachEvent(ax,function(){if(aL.readyState=="complete"){aL.detachEvent(ax,arguments.callee);aP();}});if(af==top){(function(){if(ak){return;}try{aL.documentElement.doScroll("left");}catch(a){setTimeout(arguments.callee,0);return;}aP();})();}}if(ah.wk){(function(){if(ak){return;}if(!/loaded|complete/.test(aL.readyState)){setTimeout(arguments.callee,0);return;}aP();})();}aC(aP);}}();function aP(){if(ak){return;}try{var b=aL.getElementsByTagName("body")[0].appendChild(ar("span"));b.parentNode.removeChild(b);}catch(a){return;}ak=true;var d=Z.length;for(var c=0;c<d;c++){Z[c]();}}function aj(a){if(ak){a();}else{Z[Z.length]=a;}}function aC(a){if(typeof af.addEventListener!=aq){af.addEventListener("load",a,false);}else{if(typeof aL.addEventListener!=aq){aL.addEventListener("load",a,false);}else{if(typeof af.attachEvent!=aq){aM(af,"onload",a);}else{if(typeof af.onload=="function"){var b=af.onload;af.onload=function(){b();a();};}else{af.onload=a;}}}}}function aN(){if(aa){Y();}else{am();}}function Y(){var d=aL.getElementsByTagName("body")[0];var b=ar(aD);b.setAttribute("type",aE);var a=d.appendChild(b);if(a){var c=0;(function(){if(typeof a.GetVariable!=aq){var e=a.GetVariable("$version");if(e){e=e.split(" ")[1].split(",");ah.pv=[parseInt(e[0],10),parseInt(e[1],10),parseInt(e[2],10)];}}else{if(c<10){c++;setTimeout(arguments.callee,10);return;}}d.removeChild(b);a=null;am();})();}else{am();}}function am(){var g=aG.length;if(g>0){for(var h=0;h<g;h++){var c=aG[h].id;var n=aG[h].callbackFn;var a={success:false,id:c};if(ah.pv[0]>0){var k=aS(c);if(k){if(ao(aG[h].swfVersion)&&!(ah.wk&&ah.wk<312)){ay(c,true);if(n){a.success=true;a.ref=av(c);n(a);}}else{if(aG[h].expressInstall&&au()){var e={};e.data=aG[h].expressInstall;e.width=k.getAttribute("width")||"0";e.height=k.getAttribute("height")||"0";if(k.getAttribute("class")){e.styleclass=k.getAttribute("class");}if(k.getAttribute("align")){e.align=k.getAttribute("align");}var f={};var d=k.getElementsByTagName("param");var m=d.length;for(var l=0;l<m;l++){if(d[l].getAttribute("name").toLowerCase()!="movie"){f[d[l].getAttribute("name")]=d[l].getAttribute("value");}}ae(e,f,c,n);}else{aF(k);if(n){n(a);}}}}}else{ay(c,true);if(n){var b=av(c);if(b&&typeof b.SetVariable!=aq){a.success=true;a.ref=b;}n(a);}}}}}function av(b){var d=null;var c=aS(b);if(c&&c.nodeName=="OBJECT"){if(typeof c.SetVariable!=aq){d=c;}else{var a=c.getElementsByTagName(aD)[0];if(a){d=a;}}}return d;}function au(){return !aU&&ao("6.0.65")&&(ah.win||ah.mac)&&!(ah.wk&&ah.wk<312);}function ae(f,d,h,e){aU=true;ap=e||null;at={success:false,id:h};var a=aS(h);if(a){if(a.nodeName=="OBJECT"){aJ=aO(a);ad=null;}else{aJ=a;ad=h;}f.id=ac;if(typeof f.width==aq||(!/%$/.test(f.width)&&parseInt(f.width,10)<310)){f.width="310";}if(typeof f.height==aq||(!/%$/.test(f.height)&&parseInt(f.height,10)<137)){f.height="137";}aL.title=aL.title.slice(0,47)+" - Flash Player Installation";var b=ah.ie&&ah.win?"ActiveX":"PlugIn",c="MMredirectURL="+af.location.toString().replace(/&/g,"%26")+"&MMplayerType="+b+"&MMdoctitle="+aL.title;if(typeof d.flashvars!=aq){d.flashvars+="&"+c;}else{d.flashvars=c;}if(ah.ie&&ah.win&&a.readyState!=4){var g=ar("div");h+="SWFObjectNew";g.setAttribute("id",h);a.parentNode.insertBefore(g,a);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a);}else{setTimeout(arguments.callee,10);}})();}aA(f,d,h);}}function aF(a){if(ah.ie&&ah.win&&a.readyState!=4){var b=ar("div");a.parentNode.insertBefore(b,a);b.parentNode.replaceChild(aO(a),b);a.style.display="none";(function(){if(a.readyState==4){a.parentNode.removeChild(a);}else{setTimeout(arguments.callee,10);}})();}else{a.parentNode.replaceChild(aO(a),a);}}function aO(b){var d=ar("div");if(ah.win&&ah.ie){d.innerHTML=b.innerHTML;}else{var e=b.getElementsByTagName(aD)[0];if(e){var a=e.childNodes;if(a){var f=a.length;for(var c=0;c<f;c++){if(!(a[c].nodeType==1&&a[c].nodeName=="PARAM")&&!(a[c].nodeType==8)){d.appendChild(a[c].cloneNode(true));}}}}}return d;}function aA(e,g,c){var d,a=aS(c);if(ah.wk&&ah.wk<312){return d;}if(a){if(typeof e.id==aq){e.id=c;}if(ah.ie&&ah.win){var f="";for(var k in e){if(e[k]!=Object.prototype[k]){if(k.toLowerCase()=="data"){g.movie=e[k];}else{if(k.toLowerCase()=="styleclass"){f+=' class="'+e[k]+'"';}else{if(k.toLowerCase()!="classid"){f+=" "+k+'="'+e[k]+'"';}}}}}var h="";for(var l in g){if(g[l]!=Object.prototype[l]){h+='<param name="'+l+'" value="'+g[l]+'" />';}}a.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+f+">"+h+"</object>";ag[ag.length]=e.id;d=aS(e.id);
}else{var b=ar(aD);b.setAttribute("type",aE);for(var m in e){if(e[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){b.setAttribute("class",e[m]);}else{if(m.toLowerCase()!="classid"){b.setAttribute(m,e[m]);}}}}for(var n in g){if(g[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){aQ(b,n,g[n]);}}a.parentNode.replaceChild(b,a);d=b;}}return d;}function aQ(b,d,c){var a=ar("param");a.setAttribute("name",d);a.setAttribute("value",c);b.appendChild(a);}function aw(a){var b=aS(a);if(b&&b.nodeName=="OBJECT"){if(ah.ie&&ah.win){b.style.display="none";(function(){if(b.readyState==4){aT(a);}else{setTimeout(arguments.callee,10);}})();}else{b.parentNode.removeChild(b);}}}function aT(a){var b=aS(a);if(b){for(var c in b){if(typeof b[c]=="function"){b[c]=null;}}b.parentNode.removeChild(b);}}function aS(a){var c=null;try{c=aL.getElementById(a);}catch(b){}return c;}function ar(a){return aL.createElement(a);}function aM(a,c,b){a.attachEvent(c,b);al[al.length]=[a,c,b];}function ao(a){var b=ah.pv,c=a.split(".");c[0]=parseInt(c[0],10);c[1]=parseInt(c[1],10)||0;c[2]=parseInt(c[2],10)||0;return(b[0]>c[0]||(b[0]==c[0]&&b[1]>c[1])||(b[0]==c[0]&&b[1]==c[1]&&b[2]>=c[2]))?true:false;}function az(b,f,a,c){if(ah.ie&&ah.mac){return;}var e=aL.getElementsByTagName("head")[0];if(!e){return;}var g=(a&&typeof a=="string")?a:"screen";if(c){aH=null;an=null;}if(!aH||an!=g){var d=ar("style");d.setAttribute("type","text/css");d.setAttribute("media",g);aH=e.appendChild(d);if(ah.ie&&ah.win&&typeof aL.styleSheets!=aq&&aL.styleSheets.length>0){aH=aL.styleSheets[aL.styleSheets.length-1];}an=g;}if(ah.ie&&ah.win){if(aH&&typeof aH.addRule==aD){aH.addRule(b,f);}}else{if(aH&&typeof aL.createTextNode!=aq){aH.appendChild(aL.createTextNode(b+" {"+f+"}"));}}}function ay(a,c){if(!aI){return;}var b=c?"visible":"hidden";if(ak&&aS(a)){aS(a).style.visibility=b;}else{az("#"+a,"visibility:"+b);}}function ai(b){var a=/[\\\"<>\.;]/;var c=a.exec(b)!=null;return c&&typeof encodeURIComponent!=aq?encodeURIComponent(b):b;}var aR=function(){if(ah.ie&&ah.win){window.attachEvent("onunload",function(){var a=al.length;for(var b=0;b<a;b++){al[b][0].detachEvent(al[b][1],al[b][2]);}var d=ag.length;for(var c=0;c<d;c++){aw(ag[c]);}for(var e in ah){ah[e]=null;}ah=null;for(var f in swfobject){swfobject[f]=null;}swfobject=null;});}}();return{registerObject:function(a,e,c,b){if(ah.w3&&a&&e){var d={};d.id=a;d.swfVersion=e;d.expressInstall=c;d.callbackFn=b;aG[aG.length]=d;ay(a,false);}else{if(b){b({success:false,id:a});}}},getObjectById:function(a){if(ah.w3){return av(a);}},embedSWF:function(m,e,h,f,c,a,b,k,g,l){if(typeof(cnn_adbpswf)==="function"){cnn_adbpswf(m);}var d={success:false,id:e};if(ah.w3&&!(ah.wk&&ah.wk<312)&&m&&e&&h&&f&&c){ay(e,false);aj(function(){h+="";f+="";var s={};if(g&&typeof g===aD){for(var q in g){s[q]=g[q];}}s.data=m;s.width=h;s.height=f;var p={};if(k&&typeof k===aD){for(var r in k){p[r]=k[r];}}if(b&&typeof b===aD){for(var n in b){if(typeof p.flashvars!=aq){p.flashvars+="&"+n+"="+b[n];}else{p.flashvars=n+"="+b[n];}}}if(ao(c)){var o=aA(s,p,e);if(s.id==e){ay(e,true);}d.success=true;d.ref=o;}else{if(a&&au()){s.data=a;ae(s,p,e,l);return;}else{ay(e,true);}}if(l){l(d);}});}else{if(l){l(d);}}},switchOffAutoHideShow:function(){aI=false;},ua:ah,getFlashPlayerVersion:function(){return{major:ah.pv[0],minor:ah.pv[1],release:ah.pv[2]};},hasFlashPlayerVersion:ao,createSWF:function(a,b,c){if(ah.w3){return aA(a,b,c);}else{return undefined;}},showExpressInstall:function(b,a,d,c){if(ah.w3&&au()){ae(b,a,d,c);}},removeSWF:function(a){if(ah.w3){aw(a);}},createCSS:function(b,a,c,d){if(ah.w3){az(b,a,c,d);}},addDomLoadEvent:aj,addLoadEvent:aC,getQueryParamValue:function(b){var a=aL.location.search||aL.location.hash;if(a){if(/\?/.test(a)){a=a.split("?")[1];}if(b==null){return ai(a);}var c=a.split("&");for(var d=0;d<c.length;d++){if(c[d].substring(0,c[d].indexOf("="))==b){return ai(c[d].substring((c[d].indexOf("=")+1)));}}}return"";},expressInstallCallback:function(){if(aU){var a=aS(ac);if(a&&aJ){a.parentNode.replaceChild(aJ,a);if(ad){ay(ad,true);if(ah.ie&&ah.win){aJ.style.display="block";}}if(ap){ap(at);}}aU=false;}}};}();var cnnLockToggle=false;function CNN_getCookies(){var d=[];if(document.cookie){var c=document.cookie.split("; ");for(var b=0;b<c.length;b++){var a=c[b].split("=");d[a[0]]=unescape(a[1])||null;}}return d;}function CNN_parseCookieData(a){var d={};var e=a.split("&");for(var b=0;b<e.length;b++){var c=e[b].split(":");d[c[0]]=c[1]||null;}return d;}function CNN_setCookie(c,e,a,g,d,f){var b=0;if(a){if((typeof(a)=="string")&&Date.parse(a)){b=a;}else{if(typeof(a)=="number"){b=(new Date((new Date()).getTime()+a*3600000)).toGMTString();}}}document.cookie=c+"="+escape(e)+((b)?(";expires="+b):"")+((g)?";path="+g:"")+((d)?";domain="+d:"")+((f&&(f===true))?"; secure":"");}function CNN_removeCookie(b,d,c){var a=CNN_getCookies();var e=a[b]||null;if(e){document.cookie=b+"="+escape(e)+"; expires=Fri, 13-Apr-1970 00:00:00 GMT"+((d)?";path="+d:"")+((c)?";domain="+c:"");}}var allCookies=CNN_getCookies();var cnnDomainArray=location.hostname.split(".");var cnnCurrDomain=(cnnDomainArray.length>1)?"."+cnnDomainArray[cnnDomainArray.length-2]+"."+cnnDomainArray[cnnDomainArray.length-1]:"";function cnnLiveVideo(a){if(!a){a="1";}var b="/video/live/live.html?stream=stream"+a;if(html5Check){b="/video/flashLive/live.ipad_nf.html";}CNN_openPopup(b,"liveplayer","scrollbars=yes,resizable=yes,width=672,height=540");}function CNN_openPopup(c,b,e,a){var f=location.hostname;if(window==top){window.top.name="opener";}var d=window.open(c,b,e);if(d){cnnHasOpenPopup=1;}if(d&&d.opener){if(a){d.opener.location=a;}}if(d){d.focus();}}function cnnToggleUGC(a,c){if(cnnLockToggle){return;}cnnLockToggle=true;var b=(c.parentNode.className.indexOf("Closed")>-1)?true:false;Effect.toggle(a,"blind",{beforeStart:function(f){try{c.blur();}catch(d){}if(b){switch(c.parentNode.className){case"cnnOpinionClosed":c.parentNode.className="cnnOpinion";break;case"cnnIReportClosed":c.parentNode.className="cnnIReport";break;case"cnnBlogsClosed":c.parentNode.className="cnnBlogs";Sphere.Widget.search();break;default:}}},afterFinish:function(d){if(!b){switch(c.parentNode.className){case"cnnOpinion":c.parentNode.className="cnnOpinionClosed";break;case"cnnIReport":c.parentNode.className="cnnIReportClosed";break;case"cnnBlogs":c.parentNode.className="cnnBlogsClosed";break;default:}}cnnLockToggle=false;}});}var cnnHorizontalSlider=(typeof Class=="object")?Class.create():{};cnnHorizontalSlider.prototype={initialize:function(d,g,b,c,a){try{this.locked=false;this.objName=d;this.elIdentifier=b;this.container=g;this.navDiv=c;this.viewPort=a;this.sliderWidth=this.findPanels();this.numScreens=Math.round(this.sliderWidth/2);this.negativeOffSetMax=this.setOffSet();this.positiveOffSetMax=0;this.currentPanel=0;this.inactiveDot;this.activeDot;this.setSliderWidth();this.buildNav();this.getCurrentOffSet();}catch(f){}},findPanels:function(){var a=$(this.container).getElementsByTagName("div");var c=0;for(var b=0;b<a.length;b++){if(a[b].className==this.elIdentifier+" cnnMar9L"||a[b].className==this.elIdentifier){c++;}}return c;},setCurrentPanel:function(a){this.getCurrentOffSet();this.currentPanel=(this.currOffSet/this.viewPort)*-1;this.updateNav();},setOffSet:function(){return((this.numScreens*this.viewPort)-this.viewPort)*-1;},calculateSliderWidth:function(){return this.viewPort*this.numScreens;},setSliderWidth:function(){$(this.container).style.width=this.calculateSliderWidth()+"px";},buildNav:function(){},updateNav:function(){},getCurrentOffSet:function(a){this.currOffSet=(!isNaN(parseInt($(this.container).style.left,10)))?parseInt($(this.container).style.left,10):0;},btnSlide:function(a){if(!this.locked){this.locked=true;var b=this;this.timer=setTimeout(function(){b.getCurrentOffSet();var c=(a*b.viewPort)*-1;var d=(c>b.currOffSet)?(c-b.currOffSet):(b.currOffSet-c)*-1;var e=(d>0)?2*(d/b.viewPort):(2*(d/b.viewPort))*-1;if(e<0){e=e*-1;}if(b.currOffSet>b.negativeOffSetMax||b.currOffSet<b.positiveOffSetMax){new Effect.MoveBy($(b.container).id,0,d,{duration:e,beforeStart:function(){b.showImages();
},afterFinish:function(){b.setCurrentPanel();}});}b.locked=false;},300);}}};var globalSlideCheck=0;var globalTabCheck=0;var cnn_GallerySlider=(typeof Class==="object")?Class.create():{};cnn_GallerySlider.prototype=Object.extend(new cnnHorizontalSlider(),{initialize:function(a){this.config=a;this.defaults={galleryContainerId:"cnn_GallerySliderContainer",galleryStripClass:"cnn_fabcaslab",galleryTabContainerId:"cnnGalleryTabs",nextButtonContainerId:"cnn_fabcnext",prevButtonContainerId:"cnn_fabcprev",galleryAdPrefix:"gallery_",displayWidth:906};this.settings=Object.extend(this.defaults,this.config);try{this.elIdentifier=this.settings.galleryStripClass;this.container=this.settings.galleryContainerId;this.navDiv=this.settings.navContainer;this.viewPort=this.settings.displayWidth;this.currentTab=this.settings.currentTab||0;}catch(b){}try{this.locked=false;this.sliderWidth=this.findPanels();this.numScreens=this.sliderWidth;this.negativeOffSetMax=this.setOffSet();this.positiveOffSetMax=0;this.currentPanel=0;this.inactiveDot="";this.activeDot="";this.setSliderWidth();this.buildNav();this.getCurrentOffSet();this.tabLnks;this.numTabs;this.requestPanelAd(this.currentTab,this.currentPanel);this.numImgsPerPanel=7;this.showImages("init");}catch(b){}},callOmniture:function(a){},showImages:function(a){var b=a?$(this.settings.galleryContainerId).down():$(this.settings.galleryContainerId);b.select(".cnn_fabcatz img").each(function(d,c){if(d.className=="cnnContentImg"&&d.style.display!="block"){d.style.display="block";}});},buildTabs:function(c){tabBtnContainer=$(this.settings.galleryTabContainerId);this.tabLnks=tabBtnContainer.getElementsByTagName("a");this.numTabs=this.tabLnks.length;var a=false;var d=this;var b=0;if(typeof(c)!="undefined"){this.callOmniture("HP mid button "+(c+1));}if(typeof c==="undefined"){for(b=0,len=this.numTabs;b<len;b++){if(this.tabLnks[b].className=="cnn_fabtabbtn cnn_fabtabbtnon"){c=b;a=true;}}if(!a){c=0;this.currentTab=0;}this.currentTab=c;}else{this.currentTab=c;}for(b=0,len=this.numTabs;b<len;b++){if(b!=c){this.tabLnks[b].className="cnn_fabtabbtn";this.tabLnks[b].onclick=function(){d.changeTab(this.href);return false;};}else{this.tabLnks[b].className="cnn_fabtabbtn cnn_fabtabbtnon";this.tabLnks[b].onclick=function(){return false;};}}},buildNav:function(){this.buildTabs();prevBtnContainer=$(this.settings.prevButtonContainerId);nextBtnContainer=$(this.settings.nextButtonContainerId);prevBtnContainer.className="cnn_fabcprv_off";nextBtnContainer.className=this.sliderWidth>1?"cnn_fabcnxt":"cnn_fabcnxt_off";if(this.sliderWidth>1){prevBtnContainer.observe("click",this.slidePrev.bind(this));nextBtnContainer.observe("click",this.slideNext.bind(this));}},slideNext:function(){if((this.currentPanel+1)<this.numScreens){this.btnSlide(this.currentPanel+1);}if(globalSlideCheck!=this.currentPanel+1||globalTabCheck!=0){globalSlideCheck=this.currentPanel+1;globalTabCheck=0;this.callOmniture("HP mid right arrow");}},slidePrev:function(){if(this.currentPanel>0){this.btnSlide(this.currentPanel-1);}if(globalSlideCheck!=this.currentPanel-1||globalTabCheck!=0){globalSlideCheck=this.currentPanel-1;globalTabCheck=0;this.callOmniture("HP mid left arrow");}},updateNav:function(){this.requestPanelAd(this.currentTab,this.currentPanel);if((this.currentPanel+1)<this.numScreens){$(this.settings.nextButtonContainerId).className="cnn_fabcnxt";}else{$(this.settings.nextButtonContainerId).className="cnn_fabcnxt_off";}if(this.currentPanel>0){$(this.settings.prevButtonContainerId).className="cnn_fabcprv";}else{$(this.settings.prevButtonContainerId).className="cnn_fabcprv_off";}},changeTab:function(a,b){var c=this;new Ajax.Request(a,{method:"get",onSuccess:function(f){c.resetSlider(f.responseText);for(var e=0,d=c.numTabs;e<d;e++){if(a==c.tabLnks[e].href){c.buildTabs(e);}}}});globalTabCheck=1;},resetSlider:function(b){var c=this,a=$(c.settings.galleryContainerId).up();Effect.Fade(this.container,{duration:0.5,afterFinish:function(){$(c.container).remove();var d=document.createElement("div");d.setAttribute("style","display:none");d.setAttribute("id",c.settings.galleryContainerId);a.appendChild(d);$(c.container).update(b);c.initialize(Object.extend(c.settings,{currentTab:c.currentTab}));Effect.Appear(c.container,{duration:0.5});}});},requestPanelAd:function(c,b){var d=this;if($(this.settings.galleryAdPrefix+c+"_ad_"+b)&&!$(this.settings.galleryAdPrefix+c+"_ad_"+b+"Container")){if(this.varDefined("CNN_"+this.settings.galleryAdPrefix+c+"_ad_"+b)){var a=document.createElement("div");a.setAttribute("id",this.settings.galleryAdPrefix+c+"_ad_"+b+"Container");$(this.settings.galleryAdPrefix+c+"_ad_"+b).appendChild(a);new Ajax.Updater({success:$(this.settings.galleryAdPrefix+c+"_ad_"+b+"Container")},this.returnVarValue("CNN_"+this.settings.galleryAdPrefix+c+"_ad_"+b),{method:"get",evalScripts:true,asynchronous:true,onSuccess:function(){if($(d.settings.galleryAdPrefix+c+"_ad_"+b+"_adgif")){$(d.settings.galleryAdPrefix+c+"_ad_"+b+"_adgif").innerHTML='<img src="http://i.cdn.turner.com/cnn/.element/img/3.0/global/misc/advertisement.gif" width="58" height="5" alt="" border="0">';}}});}}},varDefined:function(val){var t;var expression="t = (typeof("+val+') !== "undefined");';eval(expression);return t;},returnVarValue:function(val){return eval(val);}});var cnn_SectionGallery,cnn_SectionGallery2;Event.observe(window,"load",function(){if($("cnn_GallerySliderContainer")&&typeof cnn_SectionGallery!=="object"){cnn_SectionGallery=new cnn_GallerySlider();}if($("cnn_Gallery2SliderContainer")&&typeof cnn_SectionGallery2!=="object"){cnn_SectionGallery2=new cnn_GallerySlider({galleryContainerId:"cnn_Gallery2SliderContainer",galleryTabContainerId:"cnnGallery2Tabs",nextButtonContainerId:"cnn_fabcnext2",prevButtonContainerId:"cnn_fabcprev2",galleryAdPrefix:"gallery2_"});}cnnInitOverlay();});function limitBinList(a,b){a.each(function(e,g){var l=82;var f=b;var h=$j("ul");var k=$j(".cnn_relpostn .cnn_mtt1img div a img");var d=$j(g).find(k).height();if(!d){f=b+l;}function c(m){if($j(g).find(h).height()>f){$j(g).find(h).children().last().remove();c();}return false;}if(c(d)){c(d);}});}var CNN_T1Flipper={prev:function(){},next:function(){},play:function(){},stop:function(){},imgClick:function(){}};var cnnT1Flipper=CNN_T1Flipper;if(typeof Class==="object"){CNN_T1Flipper=Class.create();CNN_T1Flipper.prototype={initialize:function(){this.locked=false;this.panels=$$("#cnn_maint1lftf .cnn_flpprt1pnl");this.navboxes=$$("#cnn_maint1lftf .cnn_flpprt1nvbx");this.iterator=0;this.timer;this.autoPlay=false;for(var b=1,a=this.panels.length;b<a;++b){this.panels[b].hide();}},navigatePanel:function(b){var a=this.iterator;if(b==="prev"){if(a<=0){a=this.panels.size()-1;}else{a-=1;}}else{if(a>=this.panels.size()-1){a=0;}else{a+=1;}}this.showPanel(a);},showPanel:function(b){var a=this;if(a.panels.size()>0&&a.navboxes.size()>0&&typeof b==="number"&&b!==a.iterator&&0<=b&&b<=a.panels.size()){a.locked=true;Effect.Fade(a.panels[a.iterator],{duration:0.25,afterFinish:function(){a.panels[a.iterator].removeClassName("cnn_flpprt1pnl_active");a.navboxes[a.iterator].removeClassName("cnn_flpprt1nvbx_active");a.iterator=b;a.panels[a.iterator].addClassName("cnn_flpprt1pnl_active");a.navboxes[a.iterator].addClassName("cnn_flpprt1nvbx_active");Effect.Appear(a.panels[a.iterator],{duration:0.25,afterFinish:function(){a.locked=false;if(a.autoPlay){a.play();}}});}});}},prev:function(){this.stop();this.navigatePanel("prev");},next:function(){this.stop();this.navigatePanel("next");},play:function(){var a=this;if(a.panels.size()>0&&a.navboxes.size()>0){a.autoPlay=true;a.timer=window.setTimeout(function(){a.navigatePanel("next");},8000);}},stop:function(){this.autoPlay=false;window.clearTimeout(this.timer);},imgClick:function(a){if(a){window.location.href=a;}}};}var cnn_stryichgcrr=1;var cnn_stryichgmax=0;function cnn_stryichgS(a){if(a!=cnn_stryichgcrr){$("cnn_stryichgnm"+cnn_stryichgcrr).className="cnn_stryichgn"+cnn_stryichgcrr;$("cnn_stryichgnm"+a).className="cnn_stryichgn"+a+" cnn_stryichgn"+a+"on";
$("cnnImageChangerImg").src=CNN_storyImageGallery[a-1].image;if($("cnnImageChangerCap")){$("cnnImageChangerCap").update(CNN_storyImageGallery[a-1].caption);$("cnnImageChangerImg").setAttribute("alt",CNN_storyImageGallery[a-1].caption);}else{$("cnnImageChangerImg").setAttribute("alt",CNN_storyImageGallery[a-1].image);}cnn_stryichgcrr=a;}}function cnn_stryichgP(){var a=cnn_stryichgcrr;if(a==1){a=cnn_stryichgmax;}else{a--;}cnn_stryichgS(a);}function cnn_stryichgN(){var a=cnn_stryichgcrr;if(a==cnn_stryichgmax){a=1;}else{a++;}cnn_stryichgS(a);}function cnn_stryichgInit(){temp_s="";cnn_stryichgmax=CNN_storyImageGallery.length;for(i=1;i<=cnn_stryichgmax;i++){temp_s+='<a id="cnn_stryichgnm'+i+'" href="javascript:cnn_stryichgS('+i+');" class="cnn_stryichgn'+i;if(i==1){temp_s+=" cnn_stryichgn"+i+"on";}temp_s+='"><img src="http://i.cdn.turner.com/cnn/.element/img/3.0/1px.gif" border="0"></a>';}Element.update("cnn_stryichgnm",temp_s);}function cnn_stryichgS_New(a){if(a!=cnn_stryichgcrr){$("cnn_stryichgnmL"+cnn_stryichgcrr).className="cnn_stryichgn"+cnn_stryichgcrr;$("cnn_stryichgnmL"+a).className="cnn_stryichgn"+a+" cnn_stryichgn"+a+"on";$("cnnImageChangerImg").src=CNN_storyImageGallery[a-1].image;if($("cnnImageChangerCap")){$("cnnImageChangerCap").update(CNN_storyImageGallery[a-1].caption);$("cnnMediaTitleCap").update(CNN_storyImageGallery[a-1].head);$("cnnImageChangerImg").setAttribute("alt",CNN_storyImageGallery[a-1].caption);}else{$("cnnImageChangerImg").setAttribute("alt",CNN_storyImageGallery[a-1].image);}cnn_stryichgcrr=a;if(typeof(cnn_adbptrackpgalimg)=="function"&&typeof(CNN_storyImageGallery)!="undefined"){cnn_adbptrackpgalimg(CNN_storyImageGallery[a-1].image,photo_gallery);}}}function cnn_storyChanger(){var a="";var b=CNN_storyImageGallery.length;for(i=1;i<=b;i++){a+='<a title="cnn_galleryhvr'+i+'" id="cnn_stryichgnmL'+i+'" href="javascript:cnn_stryichgS_New('+i+');" class="cnn_stryichgn'+i;if(i==1){a+=" cnn_stryichgn"+i+"on";}a+='"><img src="http://i.cdn.turner.com/cnn/.element/img/3.0/1px.gif" border="0"></a>';}Element.update("cnn_stryichgnmL",a);}function cnn_stryichgP_New(){var a=cnn_stryichgcrr;if(a==1){a=cnn_stryichgmax;}else{a--;}cnn_stryichgS_New(a);}function cnn_stryichgN_New(){var a=cnn_stryichgcrr;if(a==cnn_stryichgmax){a=1;}else{a++;}cnn_stryichgS_New(a);}function CNN_renderRecommend(e){var a=e.assets.length;var d=0;var c='<h4>We recommend</h4><ul class="cnn_bulletbin">';for(var b=0;b<a;b++){var f="";if(e.assets[b].site.toLowerCase()!=="cnn"&&e.assets[b]["site-url"]!==""&&e.assets[b].siteId.indexOf("http://")===-1){f+=e.assets[b]["site-url"];}f+=e.assets[b].siteId;c+='<li><a href="'+f+'">'+e.assets[b].headline+"</a>";if(e.assets[b].wool!=""){c+=" <span>"+e.assets[b].wool.replace(": ","")+"</span>";}c+="</li>";d++;if(d>2){break;}}c+="</ul>";return c;}function cnnMouseDown(a){if(cnnDropdownOpen){cnnDD.mouseDownBody(a);}if(cnnOverlayMenuOpen){cnnOverlayMouseDownBody(a);}return true;}var cnnOverlayOpenId="";var cnnOverlayClickedId="";var cnnOverlayMenuOpen=false;var cnnOverlayClass=[];function cnnInitOverlay(){document.body.onmousedown=cnnMouseDown;cnnAddOverlayEvents("cnnOverlayLnk");}function cnnShowOverlay(a){if($(a)){if($(a).style.display=="block"){$(a).style.display="none";}else{$(a).style.display="block";cnnOverlayOpenId=a;cnnOverlayMenuOpen=true;cnnOverlayClickedId="";}}}function cnnHideOverlay(a){if($(a)){$(a).style.display="none";cnnOverlayOpenId="";cnnOverlayMenuOpen=false;}}function cnnGetOverlayMenuId(a){return a.href.substring(a.href.indexOf("'")+1,a.href.lastIndexOf("'"));}function cnnAddOverlayEvents(e){var a=document.getElementsByClassName(e);for(var d=0;d<a.length;d++){var c=a[d];c.onmousedown=cnnOverlayMouseDownBtn;var f=cnnGetOverlayMenuId(c);if($(f)){$(f).onmousedown=cnnOverlayMouseDownMenu;}cnnOverlayClass[f]=e;if((navigator.userAgent.indexOf("Safari")!=-1)&&(navigator.userAgent.indexOf("Mac")!=-1)){if(c.onmouseout&&c.onmouseout.toString().indexOf("cnnImgSwap")!=-1){c.onclick=function b(){this.onmouseout();return true;};}}}}function cnnOverlayMouseDownBtn(a){var b=cnnGetOverlayMenuId(this);cnnOverlayClickedId=b;return true;}function cnnOverlayMouseDownMenu(a){cnnOverlayClickedId=this.id;return true;}function cnnOverlayMouseDownBody(a){if(cnnOverlayOpenId!=cnnOverlayClickedId){cnnHideOverlay(cnnOverlayOpenId);}cnnOverlayClickedId="";return true;}var cdn_prefix="http://i.cdn.turner.com/cnn/";function cnn_EleObjs(a){if(typeof(a)=="string"){if(document.getElementById){a=document.getElementById(a);}else{if(document.all){a=document.all[a];}else{a=null;}}}return a;}function cnnRenderTimeStamp(s,g){var a=(location.hostname.indexOf("edition.")>-1)?true:false;var c=(s)?new Date(s):c;var e=new Array("Sun","Mon","Tue","Wed","Thur","Fri","Sat");var l=new Array("January","February","March","April","May","June","July","August","September","October","November","December");var f=new Date();var r="";var k=f.getTime()-c.getTime();var o=Math.floor(k/1000/60/60/24);k-=o*1000*60*60*24;var m=Math.floor(k/1000/60/60);k-=m*1000*60*60;var d=Math.floor(k/1000/60);k-=d*1000*60;var t=(o>1)?"days":"day";var h=(m>1)?"hours":"hour";var b=(d>1)?"minutes":"minute";var p="min";var q="";var n="";if(g){q=(a)?g[0]:g[1];}else{q="updated "+(!a?e[c.getUTCDay()]:"")+" "+l[c.getUTCMonth()]+" "+c.getUTCDate()+", "+c.getUTCFullYear();}if(m>4&&o>=0||o>=1){return n;}else{if(m<=4&&m>=1){switch(r){case"homepage":return n;break;case"search_07":if(d>0){return'<span class="cnnContentTimeStampGrey">updated '+m+" "+h+", "+d+" "+b+" ago</span>";}else{return'<span class="cnnContentTimeStampGrey">updated '+m+" "+h+" ago</span>";}break;case"sectionSpr10":if(d>0){return'<span class="cnnContentTimeStampGrey">updated '+m+" "+h+", "+d+"mins ago</span>";}else{return'<span class="cnnContentTimeStampGrey">updated '+m+" "+h+" ago</span>";}break;case"mosaic":default:if(d>0){return'<div class="cnnGryTmeStmp">updated '+m+" "+h+", "+d+" "+b+" ago</div>";}else{return'<div class="cnnGryTmeStmp">updated '+m+" "+h+" ago</div>";}}}else{switch(r){case"homepage":if(m<1&&d>0){return"<span>"+d+" min</span>";}else{return"<span>1 min</span>";}break;case"sectionSpr10":if(m<1&&d>0){return"<span>"+d+" mins ago</span>";}else{return"<span>1 min</span>";}break;case"search_07":if(m<1&&d>0){return'<span class="cnnContentTimeStamp">updated '+d+" "+b+" ago</span>";}else{return'<span class="cnnContentTimeStamp">updated 1 minute ago</span>';}case"mosaic":default:if(m<1&&d>0){return"<span>updated "+d+" "+b+" ago</span>";}else{return"<span>updated 1 minute ago</span>";}}}}}function cnn_clsbnbnnr(a){$("cnnBannerContainer").style.display="none";document.cookie="bannerLastClosed="+a+"; path=/; domain=cnn.com";}function cnnRenderGenericBanner(c,g,e,f,b,a){if(document.cookie.length>0){cookieName="bannerLastClosed";cookieStart=document.cookie.indexOf(cookieName+"=");if(cookieStart!=-1){cookieStart=cookieStart+cookieName.length+1;cookieEnd=document.cookie.indexOf(";",cookieStart);if(cookieEnd==-1){cookieEnd=document.cookie.length;}bannerLastClosed=unescape(document.cookie.substring(cookieStart,cookieEnd));currentBannerTimestamp=c.id;if(parseInt(bannerLastClosed,10)>=parseInt(currentBannerTimestamp,10)){return"<!-- Breaking news banner not updated since "+c.id+" -->";}}}var d='<div class="cnn_maincntnr';if(c.size=="xlarge"){d+=" cnn_xlrg_banner";}d+='" style="margin-top:6px;"><div class="cnn_contentarea"><div class="cnn_sdbx"><div class="cnn_sdbx1"><div class="cnn_sdbx2"><div class="cnn_sdbx3"><div class="cnn_sdbx4"><div class="cnn_sdbx5"><div class="cnn_sdbxcntnt"><div id="cnn_bnbcntr"><div id="cnn_bnblft">';if(b.length>0){if(a.length>0){d+='<a href="'+a+'">';}d+='<img border="0" height="70" width="120" src="'+cdn_prefix+"/.element/img/3.0/main/"+b+'">';if(a.length>0){d+="</a>";}}else{if(swfobject.hasFlashPlayerVersion("8.0.0")){d+='<object id="cnnAnimatedBannerTitle" height="52" width="156" data="'+g+'" pluginspage="http://www.macromedia.com/go/getflashplayer" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" type="application/x-shockwave-flash">';
d+='<param value="'+g+'" name="movie"/>';d+='<param value="false" name="menu"/>';d+='<param value="high" name="quality"/>';d+='<param value="always" name="allowScriptAccess"/>';d+='<param value="transparent" name="wmode"/>';d+='<embed height="52" width="156" wmode="transparent" allowscriptaccess="always" quality="high" menu="false" src="'+g+'" name="cnnAnimatedBannerTitle" pluginspage="http://www.macromedia.com/go/getflashplayer" type="application/x-shockwave-flash"/></object>';}else{d+='<img height="52" width="156" src="'+cdn_prefix+'/.element/img/3.0/main/breakingnews.gif">';}}d+='</div><div id="cnn_bnbrgt0"></div><div id="cnn_bnbrgt1"><div>';if(a.length>0){d+='<a style="color: rgb(255, 255, 255)" href="'+a+'">';}d+=c.content+"&nbsp;";if(a.length>0){d+="</a>";}if(typeof(c.linkTitle)!="undefined"){d+='<a id="cnn_bnbrgt3" style="opacity: 1; filter: alpha(opacity = 100);" href="'+c.linkURL+'">'+c.linkTitle+"</a>";}d+="</div></div>";d+='<div id="cnn_bnbrgt2" style="opacity: 1; filter: alpha(opacity = 100);"><a href="javascript:cnn_clsbnbnnr('+c.id+');"><div id="cnn_bnbrgt4">';d+="</div></a></div></div>";return d;}function cnnRenderDomesticBanner(c){var f=cdn_prefix+"/.element/swf/3.0/breaking.news/yellowBanner2.swf";var d="";var e="";var b="";var a="";switch(c.type){case"Live Breaking News":d="cnnYellow";e="cnnBlack";break;case"Breaking News":d="cnnBlack";e="cnnYellow";b="breaking-120x70.png";break;case"Live Developing Story":d="cnnRed";e="cnnBlack";f="http://i2.cdn.turner.com/cnn/.element/swf/2.0/breaking_news/bn_dev_domestic.swf";break;case"Developing Story":d="cnnBlack";e="cnnRed";break;case"Watch Now":d="cnnBlue";e="cnnBlue";break;case"Live Election Coverage":d="cnnBlackElex";e="cnnDrkBlue";break;case"Live Inauguration Coverage":d="cnnBlackElex";e="cnnDrkGry";break;case"Connect with CNN":d="cnnBlue";e="cnnBlack";f="http://i2.cdn.turner.com/cnn/.element/swf/2.0/breaking_news/bn_connectWithCNN.swf";break;case"Live Now (sponsored)":d="cnnBlue";e="cnnBlack";f="http://i2.cdn.turner.com/cnn/.element/swf/2.0/breaking_news/bn_liveNow.swf";break;case"Live Now":d="cnnBlue";e="cnnBlack";f="http://i2.cdn.turner.com/cnn/.element/swf/2.0/breaking_news/bn_liveNow.swf";break;case"Royal Wedding":b="RW_live_banner.jpg";a="http://www.cnn.com/SPECIALS/2011/royal.wedding/live/";if(document.location.pathname=="/"||document.location.pathname=="/index.html"||document.location.pathname=="/SPECIALS/2011/royal.wedding/live/"){return"";}break;default:return"";}return cnnRenderGenericBanner(c,f,d,e,b,a);}function cnnRenderInternationalBanner(c){var f=cdn_prefix+"/.element/swf/3.0/breaking.news/yellowBanner2.swf";var d="";var e="";var b="";var a="";switch(c.type){case"Live Breaking News":d="cnnYellow";e="cnnBlack";break;case"Breaking News":d="cnnBlack";e="cnnYellow";b="breaking-120x70.png";break;case"Live Developing Story":d="cnnYellow";e="cnnBlack";f=cdn_prefix+"/.element/swf/2.0/breaking_news/bn_dev.swf";break;case"Developing Story":d="cnnBlack";e="cnnYellow";break;case"Watch Now":d="cnnBlue";e="cnnBlue";break;case"Connect with CNN":d="cnnBlue";e="cnnBlack";f=cdn_prefix+"/.element/swf/2.0/breaking_news/bn_connectWithCNN.swf";break;case"Live Now (sponsored)":d="cnnBlue";e="cnnBlack";f=cdn_prefix+"/.element/swf/2.0/breaking_news/bn_liveNow.swf";break;case"Live Now":d="cnnBlue";e="cnnBlack";f=cdn_prefix+"/.element/swf/2.0/breaking_news/bn_liveNow.swf";break;case"Royal Wedding":b="RW_live_banner.jpg";a="http://www.cnn.com/SPECIALS/2011/royal.wedding/live/";if(document.location.pathname=="/"||document.location.pathname=="/index.html"||document.location.pathname=="/SPECIALS/2011/royal.wedding/live/"){return"";}break;default:return"";}return cnnRenderGenericBanner(c,f,d,e,b,a);}var VBS_Result=false;function CNN_FlashDetect(){}CNN_FlashDetect.prototype.maxVersionToDetect=10;CNN_FlashDetect.prototype.minVersionToDetect=3;CNN_FlashDetect.prototype.hasPlugin=(navigator.mimeTypes&&navigator.mimeTypes.length&&navigator.mimeTypes["application/x-shockwave-flash"]&&navigator.mimeTypes["application/x-shockwave-flash"].enabledPlugin);CNN_FlashDetect.prototype.hasActiveX=window.ActiveXObject;CNN_FlashDetect.prototype.hasWinIE=(navigator.userAgent&&(navigator.userAgent.indexOf("MSIE")!=-1)&&navigator.appVersion&&(navigator.appVersion.indexOf("Win")!=-1));CNN_FlashDetect.prototype.getVersion=function(){var b=0;var d=0;if(this.hasActiveX){var c=false;for(d=this.maxVersionToDetect;d>=this.minVersionToDetect&&!c;b=(c?d:b),d--){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+d);}catch(f){}}}else{if(this.hasWinIE){VBS_Result=false;for(d=this.maxVersionToDetect;d>=this.minVersionToDetect&&!VBS_Result;b=(VBS_Result?d:b),d--){execScript('on error resume next: VBS_Result = IsObject( CreateObject( "ShockwaveFlash.ShockwaveFlash.'+d+'" ) )',"VBScript");}}else{if(this.hasPlugin){if(navigator.plugins&&navigator.plugins.length&&navigator.plugins["Shockwave Flash"]){var g=navigator.plugins["Shockwave Flash"].description.split(" ");for(d=0;d<g.length;++d){var a=parseInt(g[d],10);if(isNaN(a)){continue;}else{b=a;break;}}}}}}return(b);};CNN_FlashDetect.prototype.detectVersion=function(b){var a=false;if(!isNaN(b)){a=(parseInt(this.getVersion(),10)>=parseInt(b,10));}return(a);};function CNN_FlashObject(b,a,e,d,c,f){this.m_name=b;this.m_src=a;this.m_width=e;this.m_height=d;this.m_flashVars=f;if(c){this.setParams(c);}}CNN_FlashObject.prototype.m_name="";CNN_FlashObject.prototype.m_src="";CNN_FlashObject.prototype.m_width="";CNN_FlashObject.prototype.m_height="";CNN_FlashObject.prototype.m_flashVars="";CNN_FlashObject.prototype.m_params={menu:"false",quality:"high",allowScriptAccess:"always",wmode:"transparent"};CNN_FlashObject.prototype.setParam=function(a,b){this.m_params[a]=b;};CNN_FlashObject.prototype.setParams=function(a){if(typeof a=="object"){for(var b in a){if(a[b]){this.setParam(b,a[b]);}}}};CNN_FlashObject.prototype.getParam=function(a){return(this.m_params[a]);};CNN_FlashObject.prototype.getParams=function(){return(this.m_params);};CNN_FlashObject.prototype.getFlashVarsString=function(){var a="";if(typeof this.m_flashVars=="string"){a=this.m_flashVars;}else{if(typeof this.m_flashVars=="object"){for(var b in this.m_flashVars){if(a!=""){a+="&";}a+=b+"="+escape(this.m_flashVars[b]);}}}return(a);};CNN_FlashObject.prototype.getAttributeString=function(a,b){return(b?" "+a+'="'+b+'"':"");};CNN_FlashObject.prototype.getParamTag=function(a,b){return(b?'<param name="'+a+'" value="'+b+'">':"");};CNN_FlashObject.prototype.getHtml=function(){var b="";var a="";var c="http://www.macromedia.com/go/getflashplayer";b+='<object type="application/x-shockwave-flash" 					classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"';b+=this.getAttributeString("pluginspage",c);b+=this.getAttributeString("id",this.m_name);b+=this.getAttributeString("data",this.m_src);b+=this.getAttributeString("width",this.m_width);b+=this.getAttributeString("height",this.m_height);b+=">";b+=this.getParamTag("movie",this.m_src);for(a in this.getParams()){b+=this.getParamTag(a,this.getParam(a));}b+=this.getParamTag("flashVars",this.getFlashVarsString());b+='<embed type="application/x-shockwave-flash"';b+=this.getAttributeString("pluginspage",c);b+=this.getAttributeString("name",this.m_name);b+=this.getAttributeString("src",this.m_src);b+=this.getAttributeString("width",this.m_width);b+=this.getAttributeString("height",this.m_height);for(a in this.getParams()){b+=this.getAttributeString(a,this.getParam(a));}b+=this.getAttributeString("flashVars",this.getFlashVarsString());b+=">";b+="</embed>";b+="</object>";return(b);};CNN_FlashObject.prototype.writeHtml=function(){document.write(this.getHtml());};CNN_FlashObject.prototype.writeMosaicHtml=function(a){document.getElementById(a).innerHTML=this.getHtml();};var cnnDropdownOpen=false;var cnnDocDomain="";if(location.hostname.indexOf("cnn.com")>0){cnnDocDomain="cnn.com";}if(location.hostname.indexOf("turner.com")>0){cnnDocDomain="turner.com";}if(cnnDocDomain){document.domain=cnnDocDomain;}function validateSearch(b){var d=b.elements["query"];
var c=d.value;if(c!=""||c!=null){c=cnnLeftTrim(c);var a=new RegExp("[w*|W*]*<[[w*|W*]*|/[w*|W*]]>[w*|W*]*");if(a.exec(c)||(c==null)||(c.length==0)||(c.indexOf(">")>=0)||(c.indexOf(";")>=0)){alert("Please enter a valid search term and try again."+"\n"+"HTML, URLs, and Scripts are not allowed.");}else{d.value=c;b.submit();}}return false;}function cnnLeftTrim(a){while(a.substring(0,1)==" "){a=a.substring(1,a.length);}return a;}var cnnPSproducts="";var cnnProducts=[];function cnn_geturlqargs(){var b={};var f=location.search.substring(1);var e=f.split("&");for(var c=0;c<e.length;c++){var g=e[c].indexOf("=");if(g==-1){continue;}var a=e[c].substring(0,g);var d=e[c].substring(g+1);b[a]=unescape(d);}return b;}var html5Check=/\b(iPad|iPod|iPhone)\b/.test(window.navigator.userAgent);var CNN_GalleryManager=function(){this.id=settings.id;var a;a=new Element("div",{"class":"cnn_gallery_test"}).update(""+"</div>");return a;};var CNN_SlideShowManager=(function(){var a=function(l){this.index=-1;this.id=l.id;this.xmlurl=l.xmlurl;this.width=l.width||640;this.height=l.height||360;this.xmldoc=l.xmldoc;this.imageUrlRoot=l.imageUrlRoot||this.xmldoc.querySelector("gallery:root > dir").firstChild.nodeValue||"";this.images=[];this.inited=false;this.wrapper=null;this.media=null;this.title=null;this.caption=null;this.pager=null;this.pages=null;var o=function(r,s){var q="";try{q=r.querySelector(s).firstChild.nodeValue;}catch(t){}return q;};for(var k=0,m=this.xmldoc.querySelectorAll("gallery:root > imgs > img"),h=m.length,p=null,n={};k<h;k++){p=m.item(k);n={};n["caption"]=o(p,"caption");n["title"]=o(p,"title");n["lgUrl"]=""+this.imageUrlRoot+o(p,"lgUrl");n["source"]=o(p,"source");if(n["lgUrl"]){this.images.push(n);}}};a.prototype={slideshowTemplate:(function(){var h;h=new Element("div",{"class":"cnn_html_slideshow"}).update(""+'<div class="cnn_html_slideshow_media">'+'<div class="cnn_html_media">'+"</div>"+'<div class="cnn_html_slideshow_media_overlay">'+'<div class="cnn_html_slideshow_media_caption"></div>'+"</div>"+"</div>"+'<div class="cnn_html_slideshow_metadata">'+'<div class="cnn_html_media_title"></div>'+"</div>");return h;})(),pagerTemplate:(function(){var h;h=new Element("div",{"class":"cnn_html_slideshow_controls"}).update(""+'<span class="prev_slide">&lt;</span>'+'<span class="next_slide">&gt;</span>'+'<div class="cnn_html_slideshow_pager_container">'+'<ul class="cnn_html_slideshow_pager">'+"</ul>"+"</div>");return h;})(),init:function(){if(this.inited){console.log('already inited slideshow "'+this.id+'"');}else{this.inited=true;if(this.images.length===0){$(this.id).update('<img src="http://i.cdn.turner.com/cnn/.element/img/3.0/global/misc/640x360_ns_ipad.gif" width="'+this.width+'" height="'+this.height+'" alt="" border="0">');}else{this.wrapper=this.slideshowTemplate.cloneNode(true);this.media=this.wrapper.select(".cnn_html_media")[0];this.media.setStyle({width:this.width,height:this.height});this.title=this.wrapper.select(".cnn_html_media_title")[0];this.caption=this.wrapper.select(".cnn_html_slideshow_media_caption")[0];if(this.images.length>1){this.pager=this.pagerTemplate.cloneNode(true);this.pages=this.pager.select(".cnn_html_slideshow_pager")[0];this.pager.select(".prev_slide")[0].observe("click",this.showPrev.bind(this));this.pager.select(".next_slide")[0].observe("click",this.showNext.bind(this));for(var k=0,h=this.images.length;k<h;k++){this.pages.insert(new Element("li").update(""+(k+1)).observe("click",this.show.bind(this,k)));}this.wrapper.insert(this.pager);}$(this.id).update(this.wrapper);this.show(0);}}},showPrev:function(){var h=this.index;if(h<=0){h=this.images.length-1;}else{h-=1;}this.show(h);},showNext:function(){var h=this.index;if(h>=this.images.length-1){h=0;}else{h+=1;}this.show(h);},show:function(k){var p;if(this.media!==null&&k!==this.index){p=this.images[k];this.media.setStyle({backgroundImage:"url('"+p["lgUrl"]+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"auto auto"});this.title.update(p["title"]);this.caption.update(p["caption"]);if(this.index!==-1){this.pages.childElements()[this.index].removeClassName("selected");}if(k!==-1){this.pages.childElements()[k].addClassName("selected");}if(k!==-1&&this.index!==-1){var h=this.pages.parentElement,o=h.offsetWidth,l=this.pages.offsetWidth,n=l/this.images.length,m=-1*k*n+((o-n)/2);if(l>o){if(m>0){m=0;}if(m<o-l){m=o-l;}this.pages.style.left=""+m+"px";}}this.index=k;}}};var c=[],g={},e=function(m,k,l){var h=l?l:{};if(typeof h.width!=="undefined"&&h.width===416){h.height=234;}if(c.indexOf(m)!==-1){console.log('slideshow id "'+m+'" was already registered');}else{h.id=m;h.xmlurl=k;new Ajax.Request(k,{onSuccess:function(n){h.xmldoc=n.responseXML;c.push(m);g[m]=new a(h);g[m].init();},onFailure:function(n){$(m).update('<img src="http://i.cdn.turner.com/cnn/.element/img/3.0/global/misc/640x360_ns_ipad.gif" width="'+this.width+'" height="'+this.height+'" alt="" border="0">');}});}},d=function(){return c;},b=function(){var h=[];c.each(function(k){h.push(g[k]);});return h;},f=function(h){if(c.indexOf(h)===-1){console.log('There is no slideshow with id "'+h+'"');}else{return g[h];}};return({register:e,getIds:d,getSlideShows:b,getSlideShow:f});})();function cnn_onMemFBinit(){}var CNN_SlideShowManagerAlt=(function(){var a=function(l){this.index=-1;this.id=l.id;this.xmlurl=l.xmlurl;this.width=l.width||640;this.height=l.height||360;this.xmldoc=l.xmldoc;this.explainer=(this.xmlurl.indexOf("explainer.")>-1)?1:0;if(this.explainer===1){this.imageUrlRoot=this.xmlurl.split("data.xml")[0]+"media/";}else{this.imageUrlRoot=l.imageUrlRoot||this.xmldoc.querySelector("gallery:root > dir").firstChild.nodeValue||"";}this.images=[];this.inited=false;this.wrapper=null;this.media=null;this.title=null;this.caption=null;this.pager=null;this.pages=null;var n=function(t,u){var s="";try{s=t.querySelector(u).firstChild.nodeValue;}catch(v){}return s;};var h=this.explainer?"data:root > tabs > tab":"gallery:root > imgs > img";for(var o=0,p=this.xmldoc.querySelectorAll(h),m=p.length,r=null,k={};o<m;o++){r=p.item(o);k={};k["caption"]=n(r,"caption");if(this.explainer){k["headline"]=n(r,"headline");var q=this.xmldoc.getElementsByTagName("headline")[0].firstChild.nodeValue;console.log("title = "+q);k["label"]=n(r,"label");k["file"]=""+this.imageUrlRoot+r.querySelector("content").getAttribute("file");k["caption"]="<h4>"+n(r,"headline")+"</h4>"+k["caption"];k["lgUrl"]=k["file"];}else{k["title"]=n(r,"title");k["lgUrl"]=""+this.imageUrlRoot+n(r,"lgUrl");k["source"]=n(r,"source");}if(k["lgUrl"]){this.images.push(k);}}};a.prototype={slideshowTemplate:(function(){var h;h=new Element("div",{"class":"cnnExplainer cnn_html_slideshow"}).update(""+'<div class="cnn_html_slideshow_media">'+'<div class="cnn_html_media">'+"</div>"+'<div class="cnn_html_slideshow_media_overlay">'+'<div class="cnn_html_slideshow_media_caption"></div>'+"</div>"+"</div>"+'<div class="cnn_html_slideshow_metadata">'+'<div class="cnn_html_media_title"></div>'+"</div>");return h;}()),pagerTemplate:(function(){var h;h=new Element("div",{"class":"cnn_html_slideshow_controls"}).update(""+'<span class="prev_slide">&lt;</span>'+'<span class="next_slide">&gt;</span>'+'<div class="cnn_html_slideshow_pager_container">'+'<ul class="cnn_html_slideshow_pager">'+"</ul>"+"</div>");return h;}()),init:function(){if(this.inited){console.log('already inited slideshow "'+this.id+'"');}else{this.inited=true;if(this.images.length===0){$(this.id).update('<img src="http://i.cdn.turner.com/cnn/.element/img/3.0/global/misc/640x360_ns_ipad.gif" width="'+this.width+'" height="'+this.height+'" alt="" border="0">');}else{this.wrapper=this.slideshowTemplate.cloneNode(true);this.media=this.wrapper.select(".cnn_html_media")[0];this.media.setStyle({width:this.width,height:this.height});this.title=this.wrapper.select(".cnn_html_media_title")[0];console.log("this.title = "+this.title);this.caption=this.wrapper.select(".cnn_html_slideshow_media_caption")[0];if(this.images.length>1){this.pager=this.pagerTemplate.cloneNode(true);
this.pages=this.pager.select(".cnn_html_slideshow_pager")[0];this.pager.select(".prev_slide")[0].observe("click",this.showPrev.bind(this));this.pager.select(".next_slide")[0].observe("click",this.showNext.bind(this));for(var l=0,k=this.images.length;l<k;l++){var h=(this.explainer===1)?this.images[l]["label"]:(""+(l+1));this.pages.insert(new Element("li").update(h).observe("click",this.show.bind(this,l)));}this.wrapper.insert(this.pager);}$(this.id).update(this.wrapper);this.show(0);}}},showPrev:function(){var h=this.index;if(h<=0){h=this.images.length-1;}else{h-=1;}this.show(h);},showNext:function(){var h=this.index;if(h>=this.images.length-1){h=0;}else{h+=1;}this.show(h);},show:function(k){var p;if(this.media!==null&&k!==this.index){p=this.images[k];this.media.setStyle({backgroundImage:"url('"+p["lgUrl"]+"')",backgroundRepeat:"no-repeat",backgroundPosition:"center center",backgroundSize:"auto auto"});this.title.update(p["title"]);this.caption.update(p["caption"]);if(this.index!==-1){this.pages.childElements()[this.index].removeClassName("selected");}if(k!==-1){this.pages.childElements()[k].addClassName("selected");}if(k!==-1&&this.index!==-1){var h=this.pages.parentNode,o=h.offsetWidth,l=this.pages.offsetWidth,n=l/this.images.length,m=-1*k*n+((o-n)/2);if(l>o){if(m>0){m=0;}if(m<o-l){m=o-l;}this.pages.style.left=""+m+"px";}}this.index=k;}}};var c=[],g={},e=function(m,k,l){var h=l?l:{};if(typeof h.width!=="undefined"&&h.width===416){h.height=234;}if(c.indexOf(m)!==-1){console.log('slideshow id "'+m+'" was already registered');}else{h.id=m;h.xmlurl=k;new Ajax.Request(k,{onSuccess:function(n){h.xmldoc=n.responseXML;c.push(m);g[m]=new a(h);g[m].init();},onFailure:function(n){$(m).update('<img src="http://i.cdn.turner.com/cnn/.element/img/3.0/global/misc/640x360_ns_ipad.gif" width="'+this.width+'" height="'+this.height+'" alt="" border="0">');}});}},d=function(){return c;},b=function(){var h=[];c.each(function(k){h.push(g[k]);});return h;},f=function(h){if(c.indexOf(h)===-1){console.log('There is no slideshow with id "'+h+'"');}else{return g[h];}};return({register:e,getIds:d,getSlideShows:b,getSlideShow:f});}());if(Object.isUndefined(cnn_metadata)){var cnn_metadata={"section":[],"friendly_name":"","template_type":"","template_type_content":"","business":{"cnn":{"page":{"broadcast_franchise":""},"video":{}}},"user":{"authenticated":"","segment":{"age":"","zip":"","gender":""}}};}if(allCookies["CNN_memberID"]){cnn_metadata.user.authenticated=1;}function CSIManager(){if((CSIManager.caller&&CSIManager.getInstance)&&(CSIManager.caller!=CSIManager.getInstance)){if((navigator.userAgent.indexOf("Safari")==-1)&&(navigator.userAgent.indexOf("Opera")==-1)){throw new Error("There is no public constructor for CSIManager.");}}this.CSIObjects=new Array();this.delayedCSIList=new Array();this.domIDConfig=new Array();this.domOnLoad=new Array();this.domOnBeforeLoad=new Array();this.useDelayedCSI=false;this.numberofRequests=0;var a=new Date();this.iframeOffset=0;this.queueAllCalls=false;this.queuedCallArray=new Array();this.eventTypes=new Array();this.currentEventType="";this.eventTypeFunctions=new Array();this.watchEventTypeNodes=new Array();this.isPolling=false;this.pollingInterval=10000;this.minimumInterval=9999;this.domRefreshHook=false;this.pollingUrl=false;var d=navigator.userAgent.toLowerCase();if((d.indexOf("msie")>-1)&&(d.indexOf("mac")>-1)){this.useDelayedCSI=true;}this.dojoSupport=(typeof dojo=="undefined")?false:true;this.prototypeSupport=(typeof Prototype=="undefined")?false:true;this.noFramework=(!this.dojoSupport&&!this.prototypeSupport)?true:false;var e=this;var c=function(){e.initialize();};var b=function(g){if(g.persisted){window.setTimeout("CSIManager.getInstance().delayedProcessing();",2000);}};if(this.prototypeSupport){Event.observe(window,"load",c);Event.observe(window,"pageshow",b);}else{if(this.dojoSupport){dojo.addOnLoad(c);}else{if(this.noFramework){if(window.addEventListener){window.addEventListener("load",c,false);window.addEventListener("pageshow",b,false);}else{if(window.attachEvent){window.attachEvent("onload",c);}else{var f=null;if(window.onload){f=window.onload;}window.onload=function(){c();if(f!=null){f();}};}}}}}}CSIManager.prototype.initialize=function(){if(!this.useDelayedCSI){this.queueAllCalls=true;var a=document.createElement("div");a.setAttribute("id","csimanagerdiv");document.body.appendChild(a);var a=document.createElement("div");a.setAttribute("id","csimanagerdivdelayed");document.body.appendChild(a);this.useDelayedCSI=true;this.queueAllCalls=false;this.processAnyQueuedCalls();this.queuedCallArray=null;}};CSIManager.prototype.processAnyQueuedCalls=function(){if(this.queuedCallArray&&this.queuedCallArray!=null){for(var b=0;b<this.queuedCallArray.length;b++){var a=this.queuedCallArray[b];this.queuedCallArray[b]="";if(a){this.call(a.url,a.args,a.domId,a.funcObj,a.breakCache,a.overrideID);}}}};CSIManager.__instance__=null;CSIManager.getInstance=function(){if(this.__instance__==null){this.__instance__=new CSIManager();}return this.__instance__;};CSIManager.prototype.addOnLoadById=function(c,b){var a=this.domOnLoad[c];if(!a){a=new Array();}a.push(b);this.domOnLoad[c]=a;};CSIManager.prototype.addOnBeforeLoadById=function(c,b){var a=this.domOnBeforeLoad[c];if(!a){a=new Array();}a.push(b);this.domOnBeforeLoad[c]=a;};CSIManager.prototype.setConfigForId=function(b,a){this.domIDConfig[b]=a;};CSIManager.prototype.getConfigForId=function(b){var a=this.domIDConfig[b];if(!a){a=new Object();}return a;};CSIManager.prototype.registerEventType=function(b,a){if(b&&a){this.eventTypes[b]=a;}};CSIManager.prototype.callObject=function(callObj,eventType){var resultObj;var url;var args;var domId;var decoratingFunction;var breakCache;var overrideID;var callEventType=eventType;var forcediframe;this.currentEventType=eventType;if(callObj){resultObj=callObj;url=resultObj.url;args=resultObj.args;domId=resultObj.domId;funcObj=resultObj.funcObj;breakCache=resultObj.breakCache;overrideID=resultObj.overrideID;forcediframe=resultObj.isIframeForced;if(this.queueAllCalls){var queuedObj=new Object();queuedObj.url=url;queuedObj.args=args;queuedObj.domId=domId;queuedObj.funcObj=funcObj;queuedObj.breakCache=breakCache;queuedObj.overrideId=overrideId;this.queuedCallArray.push(queuedObj);}else{if((!this.useDelayedCSI)&&(document&&document.readyState&&(document.readyState=="complete"))){this.initialize();}if(forcediframe===undefined||forcediframe===false){forcediframe=false;if(url.indexOf("http")==0){forcediframe=true;if(url.indexOf(window.location.hostname)>-1){forcediframe=false;}}}this.numberofRequests++;var internalDomId="csi"+(this.iframeOffset+this.numberofRequests);if(overrideID){internalDomId=overrideID;}var domList=new Array();var functionList=new Array();if(url.indexOf(document.domain)==-1&&url.indexOf("http")>-1){return false;}if(domId.join){domList=domId;}else{domList.push(domId);}if(funcObj){if(funcObj.join){functionList=funcObj;}else{functionList.push(funcObj);}}this.CSIObjects[internalDomId]={functionList:functionList,dom:domList,url:url,args:args,csiRequestNum:this.numberofRequests,disableCache:breakCache};var newCSI=new Object();newCSI.src=url;newCSI.id=internalDomId;newCSI.domId=domList;newCSI.args=args;newCSI.breakCache=breakCache;newCSI.csiRequestNum=this.numberofRequests;this.delayedCSIList[this.delayedCSIList.length]=newCSI;var today=new Date();var currTime=today.getTime()%60;var iframeArgs=(breakCache)?"time="+currTime:"";if(args){iframeArgs=(iframeArgs)?iframeArgs+"&":"";iframeArgs+=args;}if(forcediframe===false){try{if(funcObj){var xhrObject=null;if(this.dojoSupport){try{if(navigator.userAgent.toLowerCase().indexOf("msie 7.0")!=-1){throw new Error("NoDojoSupport");}var bindArgs={url:url+"?"+iframeArgs+"&csiID="+internalDomId,mimetype:"text/html",transport:"IframeTransport"};xhrObject=dojo.io.bind(bindArgs);}catch(err){throw new Error("DojoFailure");}}else{if(this.prototypeSupport){try{if(navigator.userAgent.toLowerCase().indexOf("safari")!=-1){throw new Error("SafariCrossDomainFailure");
}var csiMgr=this;xhrObject=new Ajax.Request(url,{method:"get",parameters:iframeArgs+"&csiID="+internalDomId,onComplete:function(response){if(response&&response.responseText&&response.responseText.indexOf('id="jsCode"')!=-1){var startStr='id="jsCode"';var startPos=response.responseText.indexOf(startStr)+startStr.length;var firstSlice=response.responseText.slice(startPos,response.responseText.indexOf("</textarea>"));var beginningNode=firstSlice.indexOf(">")+1;var myCode=firstSlice.substring(beginningNode);var obj=eval("("+myCode+")");csiMgr.callBackJS(obj,internalDomId);}if(response&&(!response.responseText)){callObj.isIframeForced=true;CSIManager.getInstance().callObject(callObj,eventType);}},onException:function(x,o){throw new Error("PrototypeException for url ["+url+"]: "+o.messageText);},onFailure:function(x,o){throw new Error("PrototypeFailure");}});}catch(err){throw new Error("PrototypeFailure");}}else{throw new Error("NoXHRFramework");}}}else{throw new Error("NoCallBackFunction");}}catch(err){forcediframe=true;}}if(forcediframe){if(this.useDelayedCSI){var realIframeUrl=url+"?"+iframeArgs+"&csiID="+internalDomId;var iframeObj=document.createElement("iframe");iframeObj.setAttribute("src",realIframeUrl);iframeObj.setAttribute("id","csiDataIframe"+internalDomId);iframeObj.setAttribute("name","csiDataIframe"+internalDomId);iframeObj.setAttribute("width","10");iframeObj.setAttribute("height","10");iframeObj.setAttribute("style","visibility:hidden;position:absolute;top:0px;left:-100px;");iframeObj.style.top="0px";iframeObj.style.left="-100px";iframeObj.style.position="absolute";var containerDiv=document.createElement("div");containerDiv.setAttribute("id","csiIframeObjs"+internalDomId);containerDiv.appendChild(iframeObj);if(document.getElementById("csimanagerdiv")){document.getElementById("csimanagerdiv").appendChild(containerDiv);if(navigator.userAgent.indexOf("MSIE")!=-1){window.setTimeout("var tmpIframObj=document.getElementById('csiDataIframe"+internalDomId+"');if(tmpIframObj.readyState=='uninitialized'){tmpIframObj.src=tmpIframObj.getAttribute('src');tmpIframObj.position='absolute';tmpIframObj.style.left='-100px';}",500);}}}else{var iframeHtmlSrc='<div id="csiIframeObjs'+internalDomId+'"><iframe src="'+url+"?"+iframeArgs+"&csiID="+internalDomId+'" name="csiDataIframe'+internalDomId+'" id="csiDataIframe'+internalDomId+'" width="10" height="10" style="visibility:hidden;position:absolute;top:0px;left:-100px;"></iframe></div>';document.write(iframeHtmlSrc);}}}}};CSIManager.prototype.call=function(a,g,c,b,h,d,k,e){var f=new Object();f.url=a;f.args=g;f.domId=c;f.funcObj=b;f.breakCache=h;f.overrideID=d;f.isIframeForced=e;revertToCallObject(f,k);};CSIManager.prototype.callBackHtml=function(b,e){var a=false;if(document.getElementById){a=document.getElementById(e);if(!a){if(this.CSIObjects[e]&&this.CSIObjects[e].dom){e=this.CSIObjects[e].dom;a=document.getElementById(e);}}}else{if(document.all){a=document.all[e];if(!a){if(this.CSIObjects[e]&&this.CSIObjects[e].dom){e=this.CSIObjects[e].dom;a=document.all[e];}}}}if(a){a.innerHTML=b;}var c=0;if(c){var d=c.style.top||"0px";c.style.top="1px";c.style.top=d;}};CSIManager.prototype.callBackJS=function(p,n){if(this.CSIObjects[n]){var b=this.CSIObjects[n].functionList;var m=this.CSIObjects[n].dom;if(b){var q=b.length;var c=m.length;if(q!=c){if(c<q){var l=m[c-1];for(var g=c;g<q;g++){m.push(l);}c=m.length;}else{var a=b[q-1];for(var g=q;g<c;g++){b.push(a);}q=b.length;}}for(var h=0;h<b.length;h++){var k=b[h];if(k){var e=this.getConfigForId(m[h]);var o=this.domOnBeforeLoad[m[h]];if(o){for(var g=0;g<o.length;g++){var d=o[g];d(p,m[h],e);}}this.callBackHtml(k(p,m[h],e,this.currentEventType),m[h]);var f=this.domOnLoad[m[h]];if(f){for(var g=0;g<f.length;g++){var d=f[g];d(p,m[h],e);}}}}this.CSIObjects[n]="";}}};CSIManager.prototype.delayedProcessing=function(){if(document.body&&document.body.innerHTML&&this.useDelayedCSI){var d=document.getElementById("csimanagerdivdelayed")||document.all["csimanagerdivdelayed"];var k="";for(var f=0;f<this.delayedCSIList.length;f++){var a=this.delayedCSIList[f].src;var b=this.delayedCSIList[f].id;var h=new Date();var g=this.delayedCSIList[f].breakCache;var c=h.getTime()%60;var e=(g)?"&time="+c:"";if(this.delayedCSIList[f].args){e=e+"&"+this.delayedCSIList[f].args;}k+='<iframe src="'+a+"?csiID="+b+e+'" name="csiDataIframe'+b+'" id="csiDataIframe'+b+'" width="10" height="10" style="visibility:hidden;position:absolute;top:0px;left:-100px;"></iframe>';}if(d){d.innerHTML=k;}}};CSIManager.prototype.handleClientData=function(cliWinbj,cliDoc){var targetWindow=top;try{if(parent.CSIManager){targetWindow=parent;}}catch(err){}var docId="";var paramStr=cliWinbj.location.hash;if(!paramStr){paramStr=cliWinbj.location.search.substring(1);}var queryId="";var keyValPairs=paramStr.split("&");if(!keyValPairs){keyValPairs=new Array();keyValPairs[keyValPairs.length]=query;}for(var counter=0;counter<keyValPairs.length;counter++){var keyVal=keyValPairs[counter].split("=");if(keyVal[0]=="csiID"){queryId=keyVal[1];counter=keyValPairs.length+1;}}var wId="";if(cliWinbj.name&&(cliWinbj.name.indexOf("csiDataIframe")==0)){wId=cliWinbj.name.substring(13);}if(wId==""&&cliWinbj.frameElement&&cliWinbj.frameElement.id&&(cliWinbj.frameElement.id.indexOf("csiDataIframe")==0)){wId=cliWinbj.frameElement.id.substring(13);}docId=wId;if(cliDoc.mainForm.htmlArea&&cliDoc.mainForm.htmlArea.value){var rawHtml=cliDoc.mainForm.htmlArea.value;if(rawHtml){targetWindow.CSIManager.getInstance().callBackHtml(rawHtml,docId);}}else{if(cliDoc.mainForm.jsCode.value){var rawJS=cliDoc.mainForm.jsCode.value;if(rawJS){targetWindow.CSIManager.getInstance().callBackJS(eval("("+rawJS+")"),docId);}}}};CSIManager.prototype.registerEventTypeNode=function(b,a){if(this.eventTypes[a]){this.watchEventTypeNodes[b]=a;}if(!this.isPolling){this.startPoll();}};CSIManager.prototype.setPollingUrl=function(b,a){this.pollingUrl=b;if(a&&a>this.minimumInterval){this.pollingInterval=a;}};CSIManager.prototype.startPoll=function(){if(!this.isPolling&&(this.pollingUrl)){this.pollingId=window.setTimeout("CSIManager.getInstance().poll()",this.pollingInterval);this.isPolling=true;}};CSIManager.prototype.poll=function(){if(!this.domRefreshHook){var a=document.createElement("iframe");this.domRefreshHook=document.body.appendChild(a);}this.domRefreshHook.setAttribute("src",this.pollingUrl);};CSIManager.prototype.handleData=function(d){this.isPolling=false;if(d.intervalTime){if(d.intervalTime>this.minimumInterval){this.pollingInterval=d.intervalTime;}}if(d.entries){for(var a=0;a<d.entries.length;a++){var e=d.entries[a];var c=this.watchEventTypeNodes[e];if(c){var b=this.eventTypes[c];b(c,e);}}}this.startPoll();};CSIManager.prototype.reset=function(){this.eventTypes=new Array();this.currentEventType="";this.eventTypeFunctions=new Array();this.watchEventTypeNodes=new Array();};CSIManager.getInstance();function revertToCallObject(b,a){CSIManager.getInstance().callObject(b,a);}function StorageManager(){if(StorageManager.caller!=StorageManager.getInstance){if((navigator.userAgent.indexOf("Safari")==-1)&&(navigator.userAgent.indexOf("Opera")==-1)){throw new Error("There is no public constructor for StorageManager.");}}this.ondownloadFunctionArray=new Array();this.onloadFunctionArray=new Array();this.failedStorageOptions=new Array();this.loadComplete=function(){var f=true;try{this.getStorage().put("validationTest","test");var e=this.getStorage().get("validationTest");if(e!="test"){f=false;}this.getStorage().remove("validationTest");}catch(c){f=false;}if(f){var d=this.onloadFunctionArray;for(var b=0;b<d.length;b++){var a=d[b];a(StorageManager.getInstance().getStorage());}}else{this.reselectStorage();}};this.downloadComplete=function(){this.loadComplete();var c=this.ondownloadFunctionArray;for(var b=0;b<c.length;b++){var a=c[b];a(StorageManager.getInstance().getStorage());}};this.addOnLoad=function(a){this.onloadFunctionArray.push(a);};this.addOnDownLoad=function(a){this.ondownloadFunctionArray.push(a);
};this.availableStores=new Array();this.addStorageType=function(a){this.availableStores.push(a);};this.currentStorageMechanism=false;this.getStorage=function(){if(this.currentStorageMechanism){return this.currentStorageMechanism;}for(var b=0;b<this.availableStores.length;b++){var a=this.availableStores[b];if((a.isSupported())&&(!this.failedStorageOptions[a.name])){this.currentStorageMechanism=a;this.currentStorageMechanism.initialize();return this.currentStorageMechanism;}}return false;};this.reselectStorage=function(){this.failedStorageOptions[this.getStorage().name]=1;this.currentStorageMechanism=false;this.getStorage();};this.currentSync=false;this.setSyncMechanism=function(a){this.currentSync=a;};this.download=function(){this.getStorage().load();if(this.currentSync){if(this.currentSync.hasUpdatedContent(this.currentStorageMechanism)){this.currentSync.getUpdatedContent(this.currentStorageMechanism);}else{this.downloadComplete();}}};this.mergeNewData=function(c){var e=this.getStorage();var d=this.currentSync.getBaseManagedKey();for(var b=0;b<c.length;b++){var a=c[b];e.put(a.key,a.value);}e.save();this.downloadComplete();};this.upload=function(){if(this.currentSync){var g=this.getStorage();if(g){var f=g.getAllKeys();var b=new Array();var d=this.currentSync.getBaseManagedKey();for(var a=0;a<f.length;a++){var e=f[a].indexOf(d);if(e==0){var c=new Object();c.key=f[a].substring(e);c.value=g.get(f[a]);b.push(c);}}this.currentSync.send(b);}}};}StorageManager.__instance__=null;StorageManager.getInstance=function(){if(this.__instance__==null){this.__instance__=new StorageManager();}return this.__instance__;};function AbstractStorageMechanism(){this.name="AbstractStorage";this.dataObjects;this.keysExpireDates;this.maxCapacity=Number.MAX_VALUE;this.singleEntrymaxCapacity=Number.MAX_VALUE;this.allKeys;this.isSupported=function(){return false;};this.initialize=function(){this.dataObjects=new Array();this.allKeys=new Array();this.keysExpireDates=new Array();};this.setOnload=function(a){StorageManager.getInstance().addOnLoad(a);};this.put=function(b,d,a){try{if(this.dataObjects[b]===undefined||this.dataObjects[b]===false){if(!a){a=new Date(new Date().getTime()+7*24*3600000);}this.keysExpireDates[b]=a;this.allKeys.push(b);}this.dataObjects[b]=d;return true;}catch(c){return false;}};this.get=function(a){return this.dataObjects[a];};this.remove=function(c){if(this.contains(c)){var a=new Array();for(var b=0;b<this.allKeys.length;b++){if(this.allKeys[b]!=c){a.push(this.allKeys[b]);}}this.allKeys=a;this.dataObjects[c]=false;}};this.contains=function(a){if(this.dataObjects[a]){return true;}else{return false;}};this.getAllKeys=function(a){return this.allKeys;};this.save=function(){};this.load=function(){StorageManager.getInstance().loadComplete();};this.clear=function(){};}function CookieStorageMechanism(){this.name="CookieStorage";this.maxCapacity=20480;this.path="/";this.domain="";this.secure=false;this.createCookie=function(key,value,expiration){document.cookie=key+"="+value+((expiration)?(";expires="+expiration):"")+((this.path)?";path="+this.path:"")+((this.domain)?";domain="+this.domain:"")+((this.secure&&(this.secure==true))?"; secure":"");};this.isSupported=function(){return(document.cookie||document.cookie=="");};this.save=function(){this.clear();var allKeys=this.getAllKeys();var lengthCount=0;for(var i=0;i<allKeys.length;i++){var currentKey=allKeys[i];var value=this.get(currentKey);var newObject=new Object();newObject.value=value;newObject.expireDate=(this.keysExpireDates[currentKey]).getTime();dataString=escape(JSON.stringify(newObject));if((lengthCount+dataString.length)>this.maxCapacity){return false;}else{lengthCount+=dataString.length;this.createCookie("js_"+currentKey,dataString,(this.keysExpireDates[currentKey]).toGMTString());}}return true;};this.load=function(){if(document.cookie!=""){var cookieArr=document.cookie.split("; ");for(var i=0;i<cookieArr.length;i++){var key=cookieArr[i].substring(0,cookieArr[i].indexOf("="));if(key.indexOf("js_")==0){storedObject=eval("("+(unescape(cookieArr[i].substring(cookieArr[i].indexOf("=")+1)))+")");key=key.substring(3);this.put(key,storedObject.value,new Date(storedObject.expireDate));}}}StorageManager.getInstance().loadComplete();};this.clear=function(){if(document.cookie!=""){var cookieArr=document.cookie.split("; ");for(var i=0;i<cookieArr.length;i++){var key=cookieArr[i].substring(0,cookieArr[i].indexOf("="));if(key.indexOf("js_")==0){toExpireDateString=(new Date((new Date()).getTime()-(24*60*60*60*1000))).toGMTString();this.createCookie(key,"clear this",toExpireDateString);}}}};}function DOMStorageMechanism(){this.name="DOMStorage";this.maxCapacity=3145728;this.isSupported=function(){return(window.globalStorage&&(window.globalStorage!=null));};this.save=function(){var allKeys=this.getAllKeys();var storedObject=new Array();for(var i=0;i<allKeys.length;i++){var currentKey=allKeys[i];var value=this.get(currentKey);var newObject=new Object();newObject.key=currentKey;newObject.value=value;newObject.expireDate=(this.keysExpireDates[currentKey]).toGMTString();storedObject.push(newObject);}dataString=JSON.stringify(storedObject);if(dataString.length>this.maxCapacity){return false;}else{window.globalStorage[document.domain].storage=dataString;}return true;};this.load=function(){var storedDataObjectsStr=window.globalStorage[document.domain].storage+"";if(storedDataObjectsStr){storedDataObjects=eval("("+storedDataObjectsStr+")");if(storedDataObjects&&storedDataObjects!=""){for(var i=0;i<storedDataObjects.length;i++){var storedObject=storedDataObjects[i];if((new Date(storedObject.expireDate)).getTime()>(new Date().getTime())){this.put(storedObject.key,storedObject.value,new Date(storedObject.expireDate));}}}}StorageManager.getInstance().loadComplete();};this.clear=function(){window.globalStorage[document.domain].storage=JSON.stringify(new Object());};}function LocalStorageMechanism(){this.name="localStorage";this.maxCapacity=5000000;this.key="undefined";this.isSupported=function(){return(window.localStorage&&(window.localStorage!=null));};this.save=function(){var allKeys=this.getAllKeys();var currentSize=0;for(var i=0;i<allKeys.length;i++){var currentKey=allKeys[i];var value=this.get(currentKey);var newObject=new Object();newObject.key=currentKey;newObject.value=value;newObject.expireDate=(this.keysExpireDates[currentKey]).toGMTString();dataString=JSON.stringify(newObject);currentSize+=dataString.length;if(currentSize>this.maxCapacity){return false;}else{window.localStorage.setItem(currentKey,dataString);}}return true;};this.load=function(){if(window.localStorage){var localStorage=window.localStorage;for(j=0;j<=localStorage.length-1;j++){var key=localStorage.key(j);var storedDataString=localStorage.getItem(key);var storedDataObject;try{storedDataObject=eval("("+storedDataString+")");}catch(e){}if(storedDataObject&&storedDataObject!=""){if((new Date(storedDataObject.expireDate)).getTime()>(new Date().getTime())){this.put(storedDataObject.key,storedDataObject.value,new Date(storedDataObject.expireDate));}}}}StorageManager.getInstance().loadComplete();};this.clear=function(){window.localStorage.clear();};}function IEStorageMechanism(){this.name="IEStorage";this.maxCapacity=65536;this.isSupported=function(){return(navigator.userAgent.indexOf("MSIE")!=-1);};this.initialize=function(){this.dataObjects=new Array();this.allKeys=new Array();this.keysExpireDates=new Array();this.dataHook=false;var a=document.createElement("iframe");a.setAttribute("src","/.element/js/3.0/scripts/IEPersistence.html");a.setAttribute("name","IEPersistence");a.setAttribute("width","10");a.setAttribute("height","10");a.setAttribute("style","visibility:hidden;position:absolute;top:0px;left:-100px;");a.style.top="0px";a.style.left="-100px";a.style.position="absolute";document.documentElement.appendChild(a);};this.load=function(){};this.save=function(){var c=this.getAllKeys();var e=new Array();for(var b=0;b<c.length;b++){var f=c[b];var d=this.get(f);var a=new Object();
a.key=f;a.value=d;a.expireDate=(this.keysExpireDates[f]).toGMTString();e.push(a);}dataString=JSON.stringify(e);if(dataString.length>this.maxCapacity){return false;}else{if(this.dataHook&&this.dataHook.saveData){this.dataHook.saveData(JSON.stringify(e));}}return true;};this.clear=function(){this.dataHook.saveData("");};}CookieStorageMechanism.prototype=new AbstractStorageMechanism;DOMStorageMechanism.prototype=new AbstractStorageMechanism;LocalStorageMechanism.prototype=new AbstractStorageMechanism;IEStorageMechanism.prototype=new AbstractStorageMechanism;StorageManager.getInstance().addStorageType(new LocalStorageMechanism());StorageManager.getInstance().addStorageType(new DOMStorageMechanism());StorageManager.getInstance().addStorageType(new IEStorageMechanism());StorageManager.getInstance().addStorageType(new CookieStorageMechanism());Array.prototype.______array="______array";var JSON={org:"http://www.JSON.org",copyright:"(c)2005 JSON.org",license:"http://www.crockford.com/JSON/license.html",stringify:function(a,g){var h,e,b,f="",d;switch(typeof a){case"object":if(a){if(a.______array=="______array"){for(e=0;e<a.length;++e){d=this.stringify(a[e]);if(f){f+=",";}f+=d;}return"["+f+"]";}else{if(typeof a.toString!="undefined"){for(e in a){d=a[e];if(typeof d!="undefined"&&typeof d!="function"){d=this.stringify(d);if(f){f+=",";}f+=this.stringify(e,true)+":"+d;}}return"{"+f+"}";}}}return"null";case"number":return isFinite(a)?String(a):"null";case"string":b=a.length;if(!g){f='"';}for(e=0;e<b;e+=1){h=a.charAt(e);if(h>=" "){if(h=="\\"||h=='"'){f+="\\";}f+=h;}else{switch(h){case"\b":f+="\\b";break;case"\f":f+="\\f";break;case"\n":f+="\\n";break;case"\r":f+="\\r";break;case"\t":f+="\\t";break;default:h=h.charCodeAt();f+="\\u00"+Math.floor(h/16).toString(16)+(h%16).toString(16);}}}if(!g){return f+'"';}else{return f;}case"boolean":return String(a);default:return"null";}},parse:function(n){var d=0;var a=" ";function m(o){throw {name:"JSONError",message:o,at:d-1,text:n};}function g(){a=n.charAt(d);d+=1;return a;}function k(){while(a!=""&&a<=" "){g();}}function l(){var q,r="",p,o;if(a=='"'){outer:while(g()){if(a=='"'){g();return r;}else{if(a=="\\"){switch(g()){case"b":r+="\b";break;case"f":r+="\f";break;case"n":r+="\n";break;case"r":r+="\r";break;case"t":r+="\t";break;case"u":o=0;for(q=0;q<4;q+=1){p=parseInt(g(),16);if(!isFinite(p)){break outer;}o=o*16+p;}r+=String.fromCharCode(o);break;default:r+=a;}}else{r+=a;}}}}m("Bad string");}function h(){var o=[];if(a=="["){g();k();if(a=="]"){g();return o;}while(a){o.push(c());k();if(a=="]"){g();return o;}else{if(a!=","){break;}}g();k();}}m("Bad array");}function e(){var p,q={};if(a=="{"){g();k();if(a=="}"){g();return q;}while(a){p=l();k();if(a!=":"){break;}g();q[p]=c();k();if(a=="}"){g();return q;}else{if(a!=","){break;}}g();k();}}m("Bad object");}function f(){var p="",o;if(a=="-"){p="-";g();}while(a>="0"&&a<="9"){p+=a;g();}if(a=="."){p+=".";while(g()&&a>="0"&&a<="9"){p+=a;}}if(a=="e"||a=="E"){p+="e";g();if(a=="-"||a=="+"){p+=a;g();}while(a>="0"&&a<="9"){p+=a;g();}}o=+p;if(!isFinite(o)){m("Bad number");}else{return o;}}function b(){switch(a){case"t":if(g()=="r"&&g()=="u"&&g()=="e"){g();return true;}break;case"f":if(g()=="a"&&g()=="l"&&g()=="s"&&g()=="e"){g();return false;}break;case"n":if(g()=="u"&&g()=="l"&&g()=="l"){g();return null;}break;}m("Syntax error");}function c(){k();switch(a){case"{":return e();case"[":return h();case'"':return l();case"-":return f();default:return a>="0"&&a<="9"?f():b();}}return c();}};var is_loadedOvly=0;function ms_QueueManager(){var queue=[];var queueCurrentItem=null;var iframeDivId="";var iframeId="";var iframeBlankUrl="";var isIframeReady=false;var isQueueRunning=false;var requestMade=false;var waitingForResponse=false;var blankIframeTimer=null;var requestTimer=null;var queuePosition=-1;var iframeTimeoutCounter=0;var requestTimeoutCounter=0;var TIMEOUT=50;var REQUEST_TIMEOUT=10;this.init=function(divId,blankUrl){document.write('<div id="'+divId+'" style="position:absolute; bottom:0; left: -700px;"></div>');iframeDivId=divId;iframeId=divId+"_iframe";iframeBlankUrl=blankUrl;REQUEST_TIMEOUT=REQUEST_TIMEOUT*1000;};this.addRequest=function(queueItem){queue[queue.length]=queueItem;if(isQueueRunning==false){isQueueRunning=true;processQueue();}};this.requestReceived=function(){waitingForResponse=false;clearWaitForRequest();destroyIframe();processQueue();};var processQueue=function(){queuePosition++;if(queuePosition>=queue.length){resetQueue();}else{queueCurrentItem=queue[queuePosition];createIframe();}};var createIframe=function(){isIframeReady=false;var thebody=document.getElementsByTagName("body")[0];var tempIFrame=document.createElement("iframe");tempIFrame.setAttribute("id",iframeId);tempIFrame.setAttribute("name",iframeId);tempIFrame.style.position="absolute";tempIFrame.style.bottom="0";tempIFrame.style.left="-600px";thebody.appendChild(tempIFrame);if(location.pathname.indexOf("profile")>-1){frames[iframeId].location.replace(iframeBlankUrl);}waitForRequest("iframe");};var destroyIframe=function(){if(location.pathname.indexOf("profile")>-1){$(iframeDivId).innerHTML="";}x=window.frames[iframeId];};var resetQueue=function(){isQueueRunning=false;destroyIframe();queue=[];queuePosition=-1;queueItem=null;};var doGet=function(){waitingForResponse=true;var url=makeQueryString(queueCurrentItem);frames[iframeId].location.replace(url);waitForRequest("get");};var doPost=function(){var html=drawForm(queueCurrentItem,"msHiddenIframeForm");var iframeWin=getIframeWindow();waitingForResponse=true;iframeWin.document.body.innerHTML=html;iframeWin.document.getElementById("msHiddenIframeForm").submit();waitForRequest("post");};var waitForRequest=function(type){switch(type){case"post":if(waitingForResponse==false){clearWaitForRequest();processQueue();return;}break;case"get":if(waitingForResponse==false){clearWaitForRequest();processQueue();return;}break;case"blankForPost":if(isIframeReady==true){clearWaitForRequest();doPost();return;}break;case"iframe":if(isIframeReady==true){clearWaitForRequest();if(queueCurrentItem.method=="post"){doPost();}else{doGet();}return;}break;}if((requestTimeoutCounter*TIMEOUT)>=REQUEST_TIMEOUT){clearWaitForRequest();requestFailed(type);return;}else{requestTimeoutCounter++;requestTimer=setTimeout(function timeoutWaitForRequest(){waitForRequest(type);},TIMEOUT);}};var clearWaitForRequest=function(){clearTimeout(requestTimer);requestTimeoutCounter=0;};var requestFailed=function(type){destroyIframe();var response={};response["errors"]=["request timed out"];eval(queueCurrentItem.params.callback+"(response);");processQueue();};var makeQueryString=function(queueItem){var queryString="";queryString+=queueItem.url;if(queueItem.params.len>0){queryString+="?";var i=0;for(key in queueItem.params){if(key!="len"){queryString+=key+"="+escapeParam(queueItem.params[key]);if(i<(queueItem.params.len-1)){queryString+="&";}}i++;}}return queryString;};var escapeParam=function(param){return escape(param).replace(/\+/g,"%2b");};var drawForm=function(queueItem,formId){var html="";for(key in queueItem.params){html+='<input type="hidden" name="'+key+'" value="'+queueItem.params[key]+'"/>';}html='<form id="'+formId+'" method="'+queueItem.method+'" action="'+queueItem.url+'">'+html+"</form>";return html;};var getIframeWindow=function(){var r=$(iframeId).contentWindow||$(iframeId).contentDocument;return r;};this.setIframeReady=function(){isIframeReady=true;};}function ms_QueueItem(a,c){var b=a;var e=c;var d={};this.addParam=function(f,g){d[f]=g;};this.getQueueItem=function(){var f=0;for(key in d){f++;}d["len"]=f;return{"url":b,"method":e,"params":d};};}var ms_documentDomain="cnn.com";var ms_baseStandard="http://audience.cnn.com/services/cnn/";var ms_baseSecure="http://audience.cnn.com/services/cnn/";var ms_echoURL="http://audience.cnn.com/services/cnn/echo.api";var ms_blankURL="http://audience.cnn.com/services/cnn/blank.api?callback=msQueueManager.setIframeReady";var msIframeDiv="cnnConnectMsIframe";var msQueueManager=null;var msStorage={};document.domain=ms_documentDomain;msQueueManager=new ms_QueueManager();
function ms_isLoggedIn(){var a=allCookies["authid"]||null;if(a==null){return false;}else{return true;}}function ms_isNull(a){return(a!="undefined"&&a!=null)?false:true;}function ms_getEmails(a){var c=new ms_QueueItem(ms_baseStandard+"user.api","get");c.addParam("action","getEmails");c.addParam("callback",a);var b=c.getQueueItem();msQueueManager.addRequest(b);}function ms_uiGetEmails(d){msQueueManager.requestReceived();var c=(typeof d.errors=="undefined")?false:true;if(c==false){msStorage.emails=d.emails;var b=true;for(var f=0;f<d.emails.length;f++){if(d.emails[f].isPrimary=="true"&&d.emails[f].status!="confirmed"){b=false;}}if(b==false){var e=$("cnnConnectWelcomeNotConfirmed");var a=$("cnnConnectBreakNewsEmails");if(e&&a){$("cnnConnectWelcomeNotConfirmed").style.display="block";$("cnnConnectBreakNewsEmails").style.display="none";}}}else{}}window.msReload=function(){if(window.location.href.indexOf("?")>-1){window.location.href=window.location.href.substr(0,window.location.href.indexOf("?"));}else{window.location.href=window.location.href;}};function utilSelectOption(c,b){for(var a=0;a<c.options.length;a++){if(c.options[a].value==b){c.selectedIndex=a;return;}}}function utilGetSelectValue(a){return a.options[a.selectedIndex].value;}function validateEmail(b){var a=/^([a-zA-Z0-9_\.\'\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return a.test(b);}function ms_init(){ms_getEmails("ms_uiGetEmails");}function ms_initProfile(){if(ms_isLoggedIn()==true){}else{}}Event.observe(window,"load",function(){ms_init();});String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"");};function ms_initOverlay(){checkUrlForParams();generateCaptchaImage();if(ms_isLoggedIn()==true){}else{}}function cnn_formConnectLogin(f){var d=$(f).email.value;var c=$(f).password.value;var g=$(f).rememberme.checked;var e=true;var a="Registration isn't complete without your ";var b=[];if(validateEmail(d)==false){e=false;b[b.length]="e-mail address";$("psigninp2_email").addClassName("redtexterror");$(f).email.className="redinput_error";}if(c==""){e=false;$("psigninp2_password").addClassName("redtexterror");b[b.length]="password";$(f).password.className="redinput_error";}if(e){ms_doLogin(d,c,g,"ms_uiDoLogin");}else{cnnConnectOverlayLoginValidationError("clear");if(b.length==2){cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" and "+b[1]+" to log in.");}else{if(b[0]=="e-mail address"&&validateEmail(d)==false&&d!=""){cnnConnectOverlayLoginValidationError("add","You entered an invalid e-mail address.");}else{if(b[0]=="e-mail address"&&d==""){cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" to log in.");}else{cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" to log in.");}}}cnnConnectOverlayLoginValidationError("show");}}var cnn_screenname="";function ms_formEnterScreenname(b){cnn_screenname=$("cnnscreenname").value;var c=/^\w+$/;var a=true;$("cnnConnectScreennameErrors").innerHTML="";if(cnn_screenname==""){a=false;$("cnnConnectScreennameErrors").innerHTML="You need to enter a screen name.";$("cnnscreenname").addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");return;}else{if(cnn_screenname.length<3){a=false;$("cnnConnectScreennameErrors").innerHTML="The screen name that you entered is too short.";$("cnnscreenname").addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");return;}else{if(cnn_screenname.length>12){a=false;$("cnnConnectScreennameErrors").innerHTML="Your screen name must be 3-12 characters; numbers and letters only.";$("cnnscreenname").addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");return;}else{if(c.test(cnn_screenname)==false){a=false;$("cnnConnectScreennameErrors").innerHTML="Your screen name includes invalid characters";$("cnnscreenname").addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");return;}else{$("cnnscreenname").removeClassName("redinput_error");$("cnnConnectScreennameErrors").removeClassName("redtexterror");$("screenname_label").removeClassName("redtexterror");}}}}if(a==true){ms_getProfile("ms_addScreenName");}else{}}function ms_addScreenName(d){msQueueManager.requestReceived();var c=(typeof d.errors=="undefined")?false:true;var b=(typeof d.warnings=="undefined")?false:true;if(c==false&&b==false){var f=d.profile;f["screenName"]=cnn_screenname;var a=f["monthOfBirth"];var e=["January","February","March","April","May","June","July","August","September","October","November","December"];f["monthOfBirth"]=e.indexOf(a)+1;ms_updateProfile(f,"ms_uiAddScreenName");}else{$("cnnConnectScreennameErrors").innerHTML="There was an error registering your screen name.  Please try again.";$("cnnscreenname").addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");}}function ms_uiAddScreenName(c){msQueueManager.requestReceived();var b=(typeof c.errors=="undefined")?false:true;var a=(typeof c.warnings=="undefined")?false:true;if(b==false&&a==false){ms_doGetUser("ms_uiDoGetUser");}else{$("cnnConnectScreennameErrors").innerHTML="There was an error registering your screen name.  Please try again.";$("cnnscreenname").addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");}}function ms_getProfile(a){var c=new ms_QueueItem(ms_baseStandard+"user.api","get");c.addParam("action","getProfile");c.addParam("callback",a);var b=c.getQueueItem();msQueueManager.addRequest(b);}function ms_updateProfile(c,a){var d=new ms_QueueItem(ms_baseStandard+"user.api","post");d.addParam("action","updateProfile");for(key in c){d.addParam(key,c[key]);}d.addParam("callback",a);var b=d.getQueueItem();msQueueManager.addRequest(b);}function ms_doGetUser(a){var c=new ms_QueueItem(ms_baseStandard+"user.api","get");c.addParam("action","getUser");c.addParam("echourl",ms_echoURL);c.addParam("callback",a);var b=c.getQueueItem();msQueueManager.addRequest(b);}function ms_uiDoGetUser(b){msQueueManager.requestReceived();var a=(typeof b.warnings=="undefined")?false:true;var c=(typeof b.user.screenName==null)?false:true;if(a==false&&c==true){CNN_setCookie("displayname",b.user.screenName,854400,"/",document.domain);closeOverlay("profile_enter_screenname");window.msReload();}else{$("cnnConnectScreennameErrors").innerHTML="There was an error registering your screen name.  Please try again.";$("cnnConnectFormScreenname").screenname.addClassName("redinput_error");$("cnnConnectScreennameErrors").addClassName("redtexterror");$("screenname_label").addClassName("redtexterror");}}function clearInputErrors(){$("cnnOverlayEmail1l").removeClassName("redinput_error");$("cnnOverlayEmail1l").value="";$("cnnOverlayPwd").removeClassName("redinput_error");$("cnnOverlayPwd").value="";$("psigninp2_email").removeClassName("redtexterror");$("psigninp2_password").removeClassName("redtexterror");$("cnnConnectLoginErrors").update("");$("cnnConnectLoginErrors").hide();}var newuser=false;function ms_formRegister(l){newuser=true;var f=$(l).email.value.trim();var m=$(l).password.value;var h=$(l).screenName.value.trim();var c=$(l).facebookID.value;$(l).screenName.value=h;var g=$(l).captcha.value;var b="domestic_version";var o="";if($(l).specialOffers.checked==true){o="member_services";}var k=true;var e="A required field is missing! Registration isn't complete without your ";var n=[];if(f==""||validateEmail(f)==false){k=false;n[n.length]="e-mail address";cnnConnectOverlayRegisterError("email");}else{$("cnnConnectFormRegister").email.className="cnnConnectFormbg1 cnn_connectoverlay_email2";$("signup_email").previous("p").removeClassName("redtexterror");}if(m==""){k=false;n[n.length]="password";
cnnConnectOverlayRegisterError("password");}else{if(m.length<6||m.indexOf(" ")!=-1||m.length>10){k=false;cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("errorText","You entered an invalid password.");return;}else{$("cnnConnectFormRegister").password.className="cnnConnectFormbg2 cnn_connectoverlay_password2";$("signup_password").previous("p").removeClassName("redtexterror");}}var a=/^\w+$/;if(h==""){k=false;n[n.length]="screen name";cnnConnectOverlayRegisterError("screenName");}else{if(h.length<3){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","The screen name that you entered is too short.");return;}else{if(h.length>12){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","Your screen name must be 3-12 characters; numbers and letters only.");return;}else{if(a.test(h)==false){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","Your screen name includes invalid characters.");return;}else{$("cnnConnectFormRegister").screenName.className="cnnConnectFormbg3 cnn_connectoverlay_screenname";$("signup_screenname").previous("p").removeClassName("redtexterror");}}}}if(g==""){k=false;generateCaptchaImage();n[n.length]="security word";cnnConnectOverlayRegisterError("captcha");cnnConnectOverlayError("errorText","You must enter a security word.");}else{$("cnnConnectFormRegister").captcha.className="cnnConnectFormbg4 cnn_connectoverlay_enterit";$("signup_kaptcha_p1").removeClassName("redtexterror");}if(k==true){ms_doRegister(f,m,h,g,b,o,c,"ms_uiDoRegister");}else{switch(n.length){case 1:if(n[0]=="e-mail address"&&validateEmail(f)==false&&f!=""){e="You entered an invalid e-mail address.";}else{if(n[0]=="e-mail address"&&f==""){e+=n[0];}else{e+=n[0];}}break;case 2:e+=n[0]+" and "+n[1];break;default:for(var d=0;d<n.length;d++){e+=(d==(n.length-1))?"and "+n[d]+".":n[d]+", ";}break;}cnnConnectOverlayError("errorText",e);}}function ms_formResetUserPassword(b){var a=$(b).email.value;if(validateEmail(a)==false){cnnConnectOverlayForgotValidationError("clear");cnnConnectOverlayForgotValidationError("add","You must enter your e-mail address to reset your password.");cnnConnectOverlayForgotValidationError("show");}else{ms_resetUserPassword(a,"ms_uiResetUserPassword");}}function ms_formSetUserPassword(f){var d=$(f).email.value;var e=$(f).resetCode.value;var h=$(f).newPassword.value;var a=h;var g=true;var c="Reset Password isn't complete without your ";var k=[];if(validateEmail(d)==false||d=="Email Address"){g=false;k[k.length]="e-mail address";cnnConnectOverlayResetError("email");}else{$("new_password_email").previous("p").removeClassName("redtexterror");$("cnnConnectFormReset").email.className="cnn_connectoverlay_email3 cnnredtxt";}if(e==""||e=="Reset Code"){g=false;k[k.length]="reset code";cnnConnectOverlayResetError("resetCode");}else{$("reset_code").previous("p").removeClassName("redtexterror");$("cnnConnectFormReset").resetCode.className="cnn_connectoverlay_password3 cnnredtxt";}if(h==""||h=="New Password"){g=false;k[k.length]="new password";cnnConnectOverlayResetError("newPassword");}else{$("new_password").previous("p").removeClassName("redtexterror");$("cnnConnectFormReset").newPassword.className="cnn_connectoverlay_password4 cnnredtxt";}if(g==true){ms_setUserPassword(e,d,h,a,"ms_uiSetUserPassword");}else{cnnConnectOverlayResetValidationError("clear");switch(k.length){case 1:c+=k[0]+".";break;case 2:c+=k[0]+" and "+k[1]+".";break;default:for(var b=0;b<k.length;b++){c+=(b==(k.length-1))?"and "+k[b]+".":k[b]+", ";}break;}cnnConnectOverlayResetValidationError("add",c);cnnConnectOverlayResetValidationError("show");}}function ms_doLogout(){CNN_removeCookie("the_forum","/","cnn.com");CNN_removeCookie("authid","/","cnn.com");CNN_removeCookie("authpass","/","cnn.com");CNN_removeCookie("displayname","/","cnn.com");CNN_removeCookie("firstName","/","cnn.com");var b=new ms_QueueItem(ms_baseStandard+"logout.api","post");b.addParam("callback","ms_uiDoLogout");var a=b.getQueueItem();msQueueManager.addRequest(a);document.location="http://www.disqus.com/saml/cnn/logout/?target="+document.location;}function ms_doLogin(c,b,f,a){var e=new ms_QueueItem(ms_baseStandard+"login.api","post");e.addParam("email",c);e.addParam("password",b);e.addParam("keepMeLoggedIn",f);e.addParam("echourl",ms_echoURL);e.addParam("callback",a);var d=e.getQueueItem();msQueueManager.addRequest(d);}function createLoginIframe(){var a="disqus_login";iframeDivId=a;iframeId=a+"_iframe";var c=location.href;c=c.split("/");c="http://"+c[2]+"/.element/ssi/www/misc/3.0/connect/connect-disqus-target.html";iframeBlankUrl=ms_baseStandard+"gsso?assertionConsumerUrl=http://www.disqus.com/saml/cnn/postback/&target="+c;var d=document.getElementsByTagName("body")[0];var b=document.createElement("iframe");b.setAttribute("id",iframeId);b.setAttribute("name",iframeId);b.style.position="absolute";b.style.bottom="0";b.style.left="-600px";d.appendChild(b);frames[iframeId].location.replace(iframeBlankUrl);}function createLogoutIframe(){var a="disqus_logout";iframeDivId=a;iframeId=a+"_iframe";var c=location.href;c=c.split("/");c="http://"+c[2]+"/.element/ssi/www/misc/3.0/connect/connect-disqus-target.html";iframeBlankUrl="http://www.disqus.com/saml/cnn/logout/?target="+c;var d=document.getElementsByTagName("body")[0];var b=document.createElement("iframe");b.setAttribute("id",iframeId);b.setAttribute("name",iframeId);b.style.position="absolute";b.style.bottom="0";b.style.left="-600px";d.appendChild(b);frames[iframeId].location.replace(iframeBlankUrl);}function ms_doRegister(d,k,h,e,a,l,c,g){var b=new ms_QueueItem(ms_baseStandard+"register.api","post");b.addParam("email",d);b.addParam("password",k);b.addParam("displayname",h);b.addParam("kaptcha",e);b.addParam("privacy",a);b.addParam("newsletters",l);b.addParam("echourl",ms_echoURL);b.addParam("facebookUserID",c);b.addParam("callback",g);if(location.hostname.indexOf("edition")!=-1){b.addParam("pid","intl.default");}var f=b.getQueueItem();msQueueManager.addRequest(f);}function ms_resetUserPassword(b,a){var d=new ms_QueueItem(ms_baseStandard+"passwordRecovery.api","post");d.addParam("action","sendResetPasswordCode");d.addParam("email",b);d.addParam("callback",a);var c=d.getQueueItem();msQueueManager.addRequest(c);}function ms_setUserPassword(e,d,c,b,a){var g=new ms_QueueItem(ms_baseStandard+"passwordRecovery.api","post");g.addParam("action","changePassword");g.addParam("email",d);g.addParam("resetCode",e);g.addParam("password",c);g.addParam("confirmPassword",b);g.addParam("callback",a);var f=g.getQueueItem();msQueueManager.addRequest(f);}function ms_sendConfirmEmailAgain(b,a){var d=new ms_QueueItem(ms_baseStandard+"emailConfirm.api","post");d.addParam("action","resendEmailConfirmation");d.addParam("email",b);d.addParam("callback",a);var c=d.getQueueItem();msQueueManager.addRequest(c);}function ms_uiDoLogout(b){msQueueManager.requestReceived();var a=(typeof b.errors=="undefined")?false:true;if(a==false){CNN_updateHeaderOptions();window.msReload();}else{window.msReload();}}function ms_uiDoLogin(c){msQueueManager.requestReceived();var b=(typeof c.errors=="undefined")?false:true;if(b==false){$("profile_overlaybg").hide();$("profile_signin_overlay").hide();var a=true;CNN_updateHeaderOptions();}else{cnnConnectOverlayLoginValidationError("clear");cnnConnectOverlayLoginValidationError("add","Your email address or password doesn't match our records. Please try again.");cnnConnectOverlayLoginValidationError("show");}}function ms_uiDoRegister(b){msQueueManager.requestReceived();var a=(typeof b.errors=="undefined")?false:true;if(a==false){closeOverlay("profile_signup_overlay");showOverlay("profile_followtopic11_overlay");}else{cnnConnectOverlayError("clearErrorText");generateCaptchaImage();for(var c=0;c<b.errors.length;c++){switch(b.errors[c]){case"email address not available":cnnConnectOverlayRegisterError("email");cnnConnectOverlayError("addErrorText","That e-mail address is already taken.<br/>");
break;case"missing email address":cnnConnectOverlayRegisterError("email");cnnConnectOverlayError("addErrorText","You forgot to enter your e-mail address.<br/>");break;case"bad email address":cnnConnectOverlayRegisterError("email");cnnConnectOverlayError("addErrorText","You entered an invalid e-mail address.<br/>");break;case"missing password":cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("addErrorText","You forgot to enter your password.<br/>");break;case"bad password":cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("addErrorText","You entered an invalid password.<br/>");break;case"missing screen name":cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("addErrorText","You forgot to enter your screen name.<br/>");break;case"screen name not available":cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("addErrorText","That screen name is already taken. Please choose another.<br/>");break;case"missing captcha":cnnConnectOverlayRegisterError("captcha");cnnConnectOverlayError("addErrorText","You forgot to type in the security word in the grey box.<br/>");break;case"bad captcha":cnnConnectOverlayRegisterError("captcha");cnnConnectOverlayError("addErrorText","You entered the security word in the grey box incorrectly.<br/>");break;case"missing privacy policy":cnnConnectOverlayError("addErrorText","You must agree to the privacy policy.<br/>");break;default:break;}}cnnConnectOverlayError("showErrorText");}}function ms_uiResetUserPassword(b){msQueueManager.requestReceived();var d="cnnConnectFormForgot";var e="cnnConnectFormReset";var a=(typeof b.errors=="undefined")?false:true;var c="";if(a==false){cnnConnectOverlayUpdate("forgot2reset");}else{cnnConnectOverlayForgotValidationError("clear");cnnConnectOverlayForgotValidationError("add","Your e-mail address doesn't match our records. Please try again.");cnnConnectOverlayForgotValidationError("show");}}function ms_uiSetUserPassword(b){msQueueManager.requestReceived();var a=(typeof b.errors=="undefined")?false:true;if(a==false){cnnConnectOverlayUpdate("reset2loginsuccess");}else{cnnConnectOverlayResetValidationError("clear");for(var c=0;c<b.errors.length;c++){switch(b.errors[c]){case"missing email address":cnnConnectOverlayResetError("email");cnnConnectOverlayResetValidationError("add","You forgot to enter your e-mail address.<br/>");break;case"profile not found":cnnConnectOverlayResetError("email");cnnConnectOverlayResetValidationError("add","Your e-mail address or reset code doesn't match our records. Please try again.<br/>");break;case"missing new password":cnnConnectOverlayResetError("newPassword");cnnConnectOverlayResetValidationError("add","You forgot to enter your new password.<br/>");break;case"missing confirm new password":cnnConnectOverlayResetError("confirmNewPassword");cnnConnectOverlayResetValidationError("add","You forgot to confirm your new password.<br/>");break;case"confirm password did not match":cnnConnectOverlayResetError("newPassword");cnnConnectOverlayResetError("confirmNewPassword");cnnConnectOverlayResetValidationError("add","Your passwords do not match.<br/>");break;case"reset code has expired":cnnConnectOverlayResetError("resetCode");cnnConnectOverlayResetValidationError("add","Your reset code has expired. <a href=\"javascript: void(0);\" onclick=\"closeOverlay('profile_forgotpass2_overlay');showOverlay('profile_forgotpass_overlay');\">Send another e-mail</a> with an updated link and reset code to reset your password.<br/>");break;default:cnnConnectOverlayResetError("default");cnnConnectOverlayResetValidationError("add","We're sorry! This service is temporarily unavailable. Please try again soon.");break;}}cnnConnectOverlayResetValidationError("show");}}function ms_uiSendConfirmEmailAgain(b){msQueueManager.requestReceived();var a=(typeof b.errors=="undefined")?false:true;if(a==false){}else{}}function cnnConnectOverlayUpdate(a){switch(a){case"login2forgot":cnnConnectOverlayResetGetEmailFromLogin();cnnConnectOverlayHideLogin();cnnConnectOverlayShowForgot();cnnConnectOverlayClearLogin();break;case"forgot2reset":cnnConnectOverlayHideForgot();cnnConnectOverlayGetEmailFromForgot();cnnConnectOverlayClearForgot();cnnConnectOverlayShowReset();break;case"all2login":cnnConnectOverlayHideForgot();cnnConnectOverlayHideReset();cnnConnectOverlayClearRegister();cnnConnectOverlayShowLogin();break;case"forgot2login":cnnConnectOverlayHideForgot();cnnConnectOverlayShowLogin();cnnConnectOverlayClearForgot();break;case"reset2login":cnnConnectOverlayHideReset();cnnConnectOverlayLoginShowText1();cnnConnectOverlayShowLogin();cnnConnectOverlayClearReset();break;case"2resetWithCode":cnnConnectOverlayShowResetWithPasscode("test1@test.com","asdf");cnnConnectOverlayHideLogin();cnnConnectOverlayShowReset();break;case"forgot2resetWithoutCode":cnnConnectOverlayShowMsg2();cnnConnectOverlayHideForgot();cnnConnectOverlayShowReset();break;case"reset2loginsuccess":cnnConnectOverlayHideReset();cnnConnectOverlayLoginShowText2();cnnConnectOverlayShowLogin();cnnConnectOverlayClearReset();break;}}function cnnConnectOverlayShowOverlay(){$("cnnConnectOverlayBox").show();}function cnnConnectOverlayHideOverlay(){cnnConnectOverlayUpdate("all2login");$("cnnConnectOverlayBox").hide();}function cnnConnectOverlayShowLogin(){showOverlay("profile_signin_overlay");}function cnnConnectOverlayHideLogin(){closeOverlay("profile_signin_overlay");}function cnnConnectOverlayClearLogin(){cnnConnectOverlayLoginShowText1();$("cnnConnectLoginErrors").hide();$("cnnConnectFormLogin").email.value="";$("cnnConnectFormLogin").password.value="";$("cnnConnectFormLogin").email.className="cnnConnectFormbg5 cnn_connectoverlay_email";$("cnnConnectFormLogin").password.className="cnnConnectFormbg6 cnn_connectoverlay_password";$("psigninp2_email").removeClassName("redtexterror");$("psigninp2_password").removeClassName("redtexterror");}function cnnConnectOverlayLoginShowText1(){}function cnnConnectOverlayLoginShowText2(){}function cnnConnectOverlayLoginValidationError(a,b){switch(a){case"clear":$("cnnConnectLoginErrors").hide();$("cnnConnectLoginErrors").innerHTML="<br/>";$("cnnConnectFormLogin").email.removeClassName("redinput_error");$("cnnConnectFormLogin").password.removeClassName("redinput_error");$("psigninp2_email").removeClassName("redtexterror");$("psigninp2_password").removeClassName("redtexterror");break;case"add":$("psigninp2_email").addClassName("redtexterror");$("psigninp2_password").addClassName("redtexterror");$("cnnConnectLoginErrors").innerHTML+=b;break;case"show":$("cnnConnectFormLogin").email.className="redinput_error";$("cnnConnectFormLogin").password.className="redinput_error";$("cnnConnectLoginErrors").className="redtexterror";$("cnnConnectLoginErrors").show();break;}}function cnnConnectOverlayShowForgot(){showOverlay("profile_forgotpass_overlay");}function cnnConnectOverlayHideForgot(){closeOverlay("profile_forgotpass_overlay");}function cnnConnectOverlayClearForgot(){$("cnnConnectForgotErrors").hide();$("cnnConnectFormForgot").email.value="";$("cnnConnectFormForgot").email.className="cnnConnectFormbg5 cnn_connectoverlay_email";}function cnnConnectOverlayForgotShowErrors(){$("cnnConnectFormForgot").email.className="cnn_connectoverlay_email cnnredtxt redinput_error";$("cnnConnectForgotErrors").className="redtexterror";$("forgotpass_email").addClassName("redtexterror");$("cnnConnectForgotErrors").show();}function cnnConnectOverlayResetGetEmailFromLogin(){if($("cnnConnectFormLogin").email.value!=""){$("cnnConnectFormForgot").email.value=$("cnnConnectFormLogin").email.value;$("cnnConnectFormForgot").email.className="cnnConnectFormbgnone cnn_connectoverlay_email";}}function cnnConnectOverlayForgotValidationError(a,b){switch(a){case"clear":$("forgotpass_email").removeClassName("redtexterror");$("cnnConnectForgotErrors").hide();$("cnnConnectForgotErrors").innerHTML="<br/>";break;case"add":$("forgotpass_email").addClassName("redtexterror");$("cnnConnectForgotErrors").innerHTML+=b;break;
case"show":$("cnnConnectFormForgot").email.className="cnn_connectoverlay_email cnnredtxt redinput_error";$("cnnConnectForgotErrors").className="redtexterror";$("forgotpass_email").addClassName("redtexterror");$("cnnConnectForgotErrors").show();break;}}function cnnConnectOverlayShowReset(){showOverlay("profile_forgotpass2_overlay");}function cnnConnectOverlayHideReset(){closeOverlay("profile_forgotpass2_overlay");}function cnnConnectOverlayClearReset(){cnnConnectOverlayResetValidationError("clear");}function cnnConnectOverlayGetEmailFromForgot(){$("cnnConnectFormReset").email.value=$("cnnConnectFormForgot").email.value;$("cnnConnectFormReset").email.className="cnnblacktxt cnn_connectoverlay_email3";showOverlay("profile_forgotpass2_overlay");cnnConnectOverlayShowMsg1();}function cnnConnectOverlayShowResetWithPasscode(a,b){}function cnnConnectOverlayShowMsg1(){showOverlay("profile_forgotpass2_overlay");}function cnnConnectOverlayShowMsg2(){showOverlay("profile_forgotpass2_overlay");}function cnnConnectOverlayResetValidationError(a,b){switch(a){case"clear":$("cnnConnectResetErrors").hide();$("cnnConnectResetErrors").innerHTML="<br/>";break;case"add":$("cnnConnectResetErrors").innerHTML+=b;break;case"show":$("cnnConnectResetErrors").className="redtexterror";$("cnnConnectResetErrors").show();break;}}function cnnConnectOverlayResetError(a){switch(a){case"email":$("cnnConnectFormReset").email.className="cnn_connectoverlay_email3 cnnredtxt redinput_error";$("new_password_email").previous("p").addClassName("redtexterror");break;case"resetCode":$("cnnConnectFormReset").resetCode.className="cnn_connectoverlay_password3 cnnredtxt redinput_error";$("reset_code").previous("p").addClassName("redtexterror");break;case"newPassword":$("cnnConnectFormReset").newPassword.className="cnn_connectoverlay_password4 cnnredtxt redinput_error";$("new_password").previous("p").addClassName("redtexterror");break;case"confirmNewPassword":$("cnnConnectFormReset").confirmNewPassword.className="cnn_connectoverlay_password5 cnnredtxt redinput_error";break;default:$("new_password_email").previous("p").addClassName("redtexterror");$("cnnConnectFormReset").email.className="cnn_connectoverlay_email3 cnnredtxt redinput_error";$("reset_code").previous("p").addClassName("redtexterror");$("cnnConnectFormReset").resetCode.className="cnn_connectoverlay_password3 cnnredtxt redinput_error";$("new_password").previous("p").addClassName("redtexterror");$("cnnConnectFormReset").newPassword.className="cnn_connectoverlay_password4 cnnredtxt redinput_error";break;}}function cnnConnectOverlayShowRegister(){$("cnnConnectResetContainer").show();}function cnnConnectOverlayHideRegister(){$("cnnConnectResetContainer").hide();}function cnnConnectOverlayClearRegister(){if($("signup_email")){$("signup_email").previous("p").removeClassName("redtexterror");}if($("signup_password")){$("signup_password").previous("p").removeClassName("redtexterror");}if($("signup_screenname")){$("signup_screenname").previous("p").removeClassName("redtexterror");}if($("signup_kaptcha_p1")){$("signup_kaptcha_p1").removeClassName("redtexterror");}generateCaptchaImage();}function cnnConnectOverlayError(b,a){switch(b){case"email":if($("cnnConnectFormRegister").email.value!=""){$("cnnConnectFormRegister").email.className="cnnConnectFormbgnone cnn_connectoverlay_email2 cnnredtxt redinput_error";}break;case"password":if($("cnnConnectFormRegister").password.value!=""){$("cnnConnectFormRegister").password.className="cnnConnectFormbgnone cnn_connectoverlay_password2 cnnredtxt redinput_error";}break;case"errorText":$("cnnConnectRegisterErrors").hide();$("cnnConnectRegisterErrors").innerHTML=a;$("cnnConnectRegisterErrors").className="redtexterror";$("cnnConnectRegisterErrors").show();break;case"clearErrorText":$("cnnConnectRegisterErrors").hide();$("cnnConnectRegisterErrors").className="";$("cnnConnectRegisterErrors").innerHTML="";break;case"addErrorText":$("cnnConnectRegisterErrors").innerHTML+=a;$("cnnConnectRegisterErrors").className="redtexterror";break;case"showErrorText":$("cnnConnectRegisterErrors").className="redtexterror";$("cnnConnectRegisterErrors").show();break;}}function cnnConnectOverlayRegisterError(a){switch(a){case"email":$("cnnConnectFormRegister").email.className="cnnConnectFormbgnone cnn_connectoverlay_email2 cnnredtxt redinput_error";$("signup_email").previous("p").addClassName("redtexterror");break;case"password":$("cnnConnectFormRegister").password.className="cnnConnectFormbgnone cnn_connectoverlay_password2 cnnredtxt redinput_error";$("signup_password").previous("p").addClassName("redtexterror");break;case"screenName":$("cnnConnectFormRegister").displayname.className="cnnConnectFormbgnone cnn_connectoverlay_screenname cnnredtxt redinput_error";$("signup_displayname").previous("p").addClassName("redtexterror");break;case"captcha":$("cnnConnectFormRegister").captcha.className="cnnConnectFormbgnone cnn_connectoverlay_enterit cnnredtxt redinput_error";$("signup_kaptcha_p1").addClassName("redtexterror");$("cnnConnectRegisterErrors").className="redtexterror";break;}}function getRandomId(){var a=Math.round(Math.random()*9999999999);return a;}function generateCaptchaImage(){var a=getRandomId();$("cnnConnectCaptchaImage").src=ms_baseStandard+"kaptcha?challenge_id="+a;$("cnnConnectCaptchaImage").width="200";$("cnnConnectCaptchaImage").height="50";$("cnnConnectFormRegister").captcha.value="";}function showToggleOverlay(){var a="cnnConnectOverlayBox";if($(a).style.display=="none"){$(a).style.display="block";centerDivOfPage("cnnConnectOverlayBox");cnnConnectOverlayClearLogin();}else{$(a).style.display="none";}}function checkUrlForParams(){if(location.href.indexOf("code=")!=-1){var a=location.href.toQueryParams();CNN_handleOverlay("profile_forgotpass2_overlay");}else{if(location.href.indexOf("emailConfirmed=success")>-1){showOverlayMessage(1);}else{if(location.href.indexOf("emailConfirmed=error")>-1){showOverlayMessage(2);}}}}function showOverlayMessage(a){if(a=="hide"){$("cnnConnectMessageContent").innerHTML="";$("cnnConnectMessageContainer").style.display="none";}else{var b=[];if(typeof(msStorage.profile)=="undefined"){b[0]="<h1>Thanks! You are a CNN.com member</h1>";}else{if(msStorage.profile.firstName!=""){b[0]='<h1>Thanks, <span id="cnnConnectThankYouName">'+msStorage.profile.firstName+"</span>! You are a CNN.com member</h1>";}else{if(msStorage.profile.screenName!=""){b[0]='<h1>Thanks, <span id="cnnConnectThankYouName">'+msStorage.profile.screenName+"</span>! You are a CNN.com member</h1>";}else{b[0]="<h1>Thanks! You are a CNN.com member</h1>";}}}b[0]+='<p class="connectptxt3">You are ready to participate in all activities and conversations on this site. Enjoy!</p>';b[0]+='<p class="connectptxt4"><div class="cnnConnectReturnLink" onclick="window.msReload();">Go to Your Profile Page</div></p>';b[1]="<h1>Thank you for confirming your email address.</h1>";b[1]+='<p class="connectptxt3">You are ready to participate in all activities and conversations on this site. Enjoy!</p>';if(ms_isLoggedIn()==true){b[1]+='<p class="connectptxt4"><div class="cnnConnectReturnLink" onclick="window.msReload();">Go to Your Profile Page</div></p>';}b[2]="<h1>There was an error confirming your e-mail address.</h1>";if(ms_isLoggedIn()==true){b[2]+='<p class="connectptxt3">In order to correct this problem, please resend your confirmation e-mail by <a href="javascript:void(0);" onclick="showOverlayMessage(\'hide\');showToggleProfile();">going to Your Profile Page</a>.';}else{b[2]+='<p class="connectptxt3">In order to correct this problem, please resend your confirmation e-mail by logging in and then going to edit my details.';}$("cnnConnectMessageContainer").style.display="block";$("cnnConnectMessageContent").innerHTML=b[a];centerDivOfPage("cnnConnectMessageContainer");}}function disqusConnectStatus(e){var d=window.location.href;var c=window.location.hash.length;var a=d.length-c;if(c>0){var b=d.substr(0,a);window.location.href=b;}if(e===false){window.msReload();
}else{window.msReload();}}function closeOverlay(a){$("profile_overlaybg").hide();$(a).hide();}function showOverlay(g){var b=document.viewport.getHeight();var d=document.viewport.getWidth();var f=Math.max(document.documentElement["clientHeight"],document.body["scrollHeight"],document.documentElement["scrollHeight"],document.body["offsetHeight"],document.documentElement["offsetHeight"]);var c=Math.max(document.documentElement["clientWidth"],document.body["scrollWidth"],document.documentElement["scrollWidth"],document.body["offsetWidth"],document.documentElement["offsetWidth"]);var e=(f>b)?f:b;var a=(c>d)?c:d;switch(g){case"profile_signup_overlay":generateCaptchaImage();break;default:}if(g=="profile_signin_overlay"){clearInputErrors();}$("profile_overlaybg").setStyle({width:a+"px",height:e+"px"});$("profile_overlaybg").show();$(g).show();centerDivOfPage(g);globalDiv=g;Event.observe(window,"resize",function(){centerDivOfPage(globalDiv);});}function showOrHide(a){$(a).toggleClassName("displayon");}function hideDiv(a){$(a).hide();}function getScrollOffset(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset;}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft;}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft;}}}return[b,a];}function centerDivOfPage(k){var e=getScrollOffset();var a=$(k).getWidth();var c=$(k).getHeight();var m=document.viewport.getHeight();var b=document.viewport.getWidth();var n=Math.max(document.documentElement["clientHeight"],document.body["scrollHeight"],document.documentElement["scrollHeight"],document.body["offsetHeight"],document.documentElement["offsetHeight"]);var d=Math.max(document.documentElement["clientWidth"],document.body["scrollWidth"],document.documentElement["scrollWidth"],document.body["offsetWidth"],document.documentElement["offsetWidth"]);var o=(n>m)?n:m;var g=(d>b)?d:b;$("profile_overlaybg").setStyle({width:g+"px",height:o+"px"});var h=e[1];var l=Math.floor((b/2)-(a/2));var f=Math.floor((h+(m/2))-(c/2));if((f+c)>n){f=((n-c)-100);}f=(f<=110)?110:f;l=(f<=9)?10:l;$(k).style.top=f+"px";$(k).style.left=l+"px";}function stringTrim(a){return(a.replace(/^\s+|\s+$/g,""));}function submitenter(c,b){var a;if(window.event){a=window.event.keyCode;}else{if(b){a=b.which;}else{return true;}}if(a==13){$("cnnConnectFormLogin").email.value=stringTrim($("cnnConnectFormLogin").email.value);cnn_formConnectLogin("cnnConnectFormLogin");return false;}else{return true;}}function cnnUpdateFBLogin(){var a=" ";if(Member.isLoggedIn("facebook")&&!Member.isConnected()&&!Member.isLoggedIn("cnn")){a='<a href="javascript:FB.login();" title="Connect your Facebook account to CNN">Connect your Facebook account to CNN</a>';}else{if(!Member.isConnected()){a='<a href="javascript:CNN_handleOverlay(\'fb_profile_signin_init_overlay\');" title="Connect your CNN &amp; Facebook accounts">Connect your CNN &amp; Facebook accounts</a>';}else{if((Member.isLoggedIn("cnn")&&!Member.isLoggedIn("facebook"))||(Member.isLoggedIn("facebook")&&!Member.isLoggedIn("cnn"))&&!Member.isConnected()){a='<a href="javascript:CNN_handleOverlay(\'fb_profile_signin_init_overlay\');" title="Log in with Facebook">Log in with Facebook</a>';}}}$("fbLoginOptions").update(a);}var allCookies=CNN_getCookies();function CNN_updateHeaderOptions(){var d=document.location.host;if(d.indexOf("ireport")>-1){d="www.cnn.com";}var c=d.split(".");if(c[0]=="newspulse"){c.splice(0,1);}d=c.join(".");var e=$("hdr-auth");if(e){if(Member.isLoggedIn("cnn")||(Member.isLoggedIn("facebook")&&Member.isConnected())){if($("user_avatar")){if((Member.isConnected()&&CNN_FB_user.avatar==="fb")||(Member.isConnected()&&!Member.isLoggedIn("cnn"))){if(!$("fbAvatar")){var g=new Element("div",{id:"fbAvatar"});$("user_avatar").appendChild(g);}}}var a=(Member.isLoggedIn("facebook")&&Member.isConnected())?CNN_FB_user.accounts[CNN_FB_user.namePref].displayName:CNN_FB_user.accounts.cnn.displayName;if(Member.isLoggedIn("facebook")&&Member.isConnected()&&Member.isLoggedIn("cnn")){a=CNN_FB_user.accounts[CNN_FB_user.namePref].displayName;}else{if(Member.isLoggedIn("facebook")&&Member.isConnected()&&!Member.isLoggedIn("cnn")){a=CNN_FB_user.accounts.fb.displayName;}else{a=(CNN_FB_user.accounts[CNN_FB_user.namePref].displayName!="")?CNN_FB_user.accounts[CNN_FB_user.namePref].displayName:CNN_FB_user.accounts.cnn.displayName;}}if(a==""){return;}var b="<ul>";var f="";b+='<li><a href="http://'+d+'/profile/" title="">'+a+"'s profile</a></li>";b+='<li class="no-border no-pad-right"><a href="javascript:Member.fullLogout();" title="">Log out</a></li>';b+="</ul>";$("hdr-auth").innerHTML=b;}else{var b="<ul>";b+='<li><a href="javascript:CNN_handleOverlay(\'profile_signup_overlay\');" title="">Sign up</a></li>';b+='<li class="no-border no-pad-right"><a href="javascript:CNN_handleOverlay(\'profile_signin_overlay\');" title="">Log in</a></li>';b+="</ul>";$("hdr-auth").innerHTML=b;}if($("displayname")){if(Member.isLoggedIn("facebook")&&!Member.isLoggedIn("cnn")){if(Member.isConnected()){$("displayname").update(a);}else{$("displayname").update("Hi!");}$("cnnLoginOptions").update('<a href="javascript:CNN_handleOverlay(\'profile_signin_overlay\');" title="Log in">Log in</a>&nbsp;or&nbsp;<a href="javascript:CNN_handleOverlay(\'profile_signup_overlay\');" title="sign up">sign up</a> with CNN to get personalized features such as breaking news alerts and newsletters.');$("user_profile").select(".welcome_details")[0].hide();$("user_profile").select(".user_details_box")[0].style.display="block";}cnnUpdateFBLogin();}}else{}if($("loading_overlay")&&!is_loadedOvly){closeOverlay("loading_overlay");is_loadedOvly=1;checkUrlForParams();}}function onUserInfoLoadComplete(a){}Event.observe(window,"load",function(){if($("cnnConnectFormForgot")){$("cnnConnectFormForgot").observe("keyup",function(a){if(a.keyCode==Event.KEY_RETURN){ms_formResetUserPassword("cnnConnectFormForgot");Event.stop(a);}});}if($("cnnConnectFormReset")){$("cnnConnectFormReset").observe("keyup",function(a){if(a.keyCode==Event.KEY_RETURN){ms_formSetUserPassword("cnnConnectFormReset");Event.stop(a);}});}if($("cnnConnectFormRegister")){$("cnnConnectFormRegister").observe("keyup",function(a){if(a.keyCode==Event.KEY_RETURN){ms_formRegister("cnnConnectFormRegister");Event.stop(a);}});}if($("cnnConnectFormLogin")){$("cnnConnectFormLogin").observe("keyup",function(a){if(a.keyCode==Event.KEY_RETURN){$("cnnConnectFormLogin").email.value=stringTrim($("cnnConnectFormLogin").email.value);cnn_formConnectLogin("cnnConnectFormLogin");Event.stop(a);}});}if($("cnnConnectFormScreenname")){$("cnnConnectFormScreenname").observe("keyup",function(a){if(a.keyCode==Event.KEY_RETURN){ms_formEnterScreenname("cnnConnectFormScreenname");Event.stop(a);}});}});Ajax.JSONRequest=Class.create(Ajax.Base,(function(){var b=0,a=document.getElementsByTagName("head")[0];return{initialize:function($super,d,c){$super(c);this.options.url=d;this.options.callbackParamName=this.options.callbackParamName||"callback";this.options.timeout=this.options.timeout||3;this.options.invokeImmediately=(!Object.isUndefined(this.options.invokeImmediately))?this.options.invokeImmediately:true;if(this.options.invokeImmediately){this.request();}},_cleanup:function(){if(this.timeout){clearTimeout(this.timeout);this.timeout=null;}if(this.transport&&Object.isElement(this.transport)){this.transport.remove();}},request:function(){var d=new Ajax.JSONResponse(this);var g=this.options.callbackParamName,f="_prototypeJSONPCallback_"+(b++),c=function(){if(Object.isFunction(this.options.onComplete)){this.options.onComplete.call(this,d);}}.bind(this);this.options.params[g]=f;var e=this.options.url+((this.options.url.include("?")?"&":"?")+Object.toQueryString(this.options.params));window[f]=function(h){this._cleanup();window[f]=undefined;
if(h.status=="error"&&Object.isFunction(this.options.onError)){d.status=200;d.statusText="ERROR";d.setResponseContent(h);this.options.onError.call(this,d);}else{if(Object.isFunction(this.options.onSuccess)){d.status=200;d.statusText="OK";d.setResponseContent(h);this.options.onSuccess.call(this,d);}}c();}.bind(this);this.transport=new Element("script",{type:"text/javascript",src:e});if(Object.isFunction(this.options.onCreate)){this.options.onCreate.call(this,d);}a.appendChild(this.transport);this.timeout=setTimeout(function(){this._cleanup();window[f]=Prototype.emptyFunction;if(Object.isFunction(this.options.onFailure)){d.status=504;d.statusText="Gateway Timeout";this.options.onFailure.call(this,d);}c();}.bind(this),this.options.timeout*1000);},toString:function(){return"[object Ajax.JSONRequest]";}};})());Ajax.JSONResponse=Class.create({initialize:function(a){this.request=a;},request:undefined,status:0,statusText:"",responseJSON:undefined,responseText:undefined,setResponseContent:function(a){this.responseJSON=a;this.responseText=Object.toJSON(a);},getTransport:function(){if(this.request){return this.request.transport;}},toString:function(){return"[object Ajax.JSONResponse]";}});var ms_isLoggedIn=function(){var a=allCookies["authid"]||null;if(a==null){return false;}else{return true;}};if(!ms_isLoggedIn&&allCookies["CNN_memberID"]){CNN_removeCookie("CNN_memberID","/",document.domain);}var CNN_FB_user=(ms_isLoggedIn&&allCookies["CNN_memberID"])?allCookies["CNN_memberID"].evalJSON(true):{accounts:{cnn:{displayName:allCookies["displayname"]||""},fb:{displayName:""}},namePref:"cnn",avatar:"cnn",prefs:false};var CNN_FB_data={cnn:{"loginStatus":false},fb:{"loginStatus":false,"connectedStatus":false}};var CNN_IsFBInit=false;var CNN_IsMemInit=false;var CNN_memberInit=true;Event.observe(window,"load",function(){if(navigator.userAgent.toLowerCase().indexOf("msie 6")==-1){Member.init();}else{if($("hdr-auth")){$("hdr-auth").hide();}if($("pmUserPanel")){$("pmUserPanel").hide();}if($("pmFacebookTab")){var a=CSIManager.getInstance();var b={url:"/.element/ssi/auto/3.0/sect/MAIN/facebook_rec.wrapper.html",args:"",domId:"pmFacebookTab",funcObj:false,breakCache:false};CSIManager.getInstance().callObject(b);}}});var Member=function(){var b;var n="CNN_memberAccnts_dev";var q="CNN_member_dev";var k="CNN_memberExpires_dev";var o=false;var d="http://audience.cnn.com/services/cnn/flow/";var p="http://audience.cnn.com/services/cnn/";var g=(window.location.href.indexOf("?")>-1)?window.location.href.substr(0,window.location.href.indexOf("?")):window.location.href;var a=false;var l=function(){var u=new Array;if(document.cookie){var t=document.cookie.split("; ");for(var s=0;s<t.length;s++){var r=t[s].split("=");u[r[0]]=unescape(r[1])||null;}}return u;};var f=function(t){var s=l();t.params.format=t.format||"jsonp";t.params=t.params||{};var r=d;if(t.legacy){r=p+t.legacy;}else{r+=t.flow;}new Ajax.JSONRequest(r,t);};var e=function(v,w){var r={};r.params={};var v=typeof(v)!="undefined"?v:r;var s=w.requiredParams||[];var t=0;for(i=0;i<s.length;i++){if(!v.params[s[i]]&&(v.params[s[i]]!="")){var u="The api call is missing the required parameter: "+s[i];throw u;}else{t++;}}if(t==s.length){if(w.legacy){v.legacy=w.legacy;}else{v.flow=w.flow;}v.params.action=w.action;return v;}else{return false;}};var c="Error in api method: ";var m=function(r){throw r;};var h={init:function(){if(!CNN_memberInit){}CNN_memberInit=false;CNN_IsMemInit=true;if(CNN_IsMemInit&&CNN_IsFBInit){if(typeof(cnn_memfbini)==="function"){cnn_memfbini();}}window.fbAsyncInit=function(){FB.init({appId:"80401312489",status:true,cookie:true,xfbml:false,oauth:true});var y=true;if(($("cnnStryRcmndBtn")||$("cnnStryRcmndBtnBtm"))&&y){var v="";var t=$("cnnStryRcmndBtn");var w=$("cnnStryRcmndBtnBtm");var z=document.getElementsByTagName("link");for(var u=0;u<z.length;u++){if(z[u].rel=="canonical"){v=z[u].href;}}if(v==""){v="http://www.cnn.com"+location.pathname;}if(t&&t.innerHTML==""){if(Member.hasDisconnected()){$("cnnStryRcmndBtn").update('<fb:like action="recommend" show_faces="false" layout="button_count" href="'+v+'" width="336"></fb:like>');$("cnnStryRcmndBtn").style.width="260px";}else{$("cnnStryRcmndBtn").update('<fb:like action="recommend" show_faces="true" layout="standard" href="'+v+'" width="336"></fb:like>');}FB.XFBML.parse(t);}if(w&&w.innerHTML==""){if(Member.hasDisconnected()){$("cnnStryRcmndBtnBtm").update('<fb:like action="recommend" width="420" show_faces="false" layout="button_count" href="'+v+'"></fb:like>');}else{$("cnnStryRcmndBtnBtm").update('<fb:like action="recommend" width="420" show_faces="true" layout="standard" href="'+v+'"></fb:like>');}FB.XFBML.parse(w);}FB.Event.subscribe("edge.create",function(A,B){});y=false;}var s=null;FB.getLoginStatus(function(A){s=1;Member.setFBStatus(A);CNN_IsFBInit=true;if(Member.isLoggedIn("cnn")&&allCookies["CNN_memberID"]){CNN_FB_user=allCookies["CNN_memberID"].evalJSON(true);}else{if(allCookies["CNN_memberID"]&&!Member.isLoggedIn("cnn")){Member.removeIDCookie();}}if(Member.isConnected()&&!(Member.isLoggedIn("cnn"))){FB.api({method:"fql.query",query:"SELECT name, pic_square FROM user WHERE uid="+FB.getAuthResponse().userID},function(C){var B=C[0];Member.setUserDataFB(B,FB.getAuthResponse().userID);});}if(CNN_IsMemInit&&CNN_IsFBInit){if(typeof(cnn_memfbini)==="function"){cnn_memfbini();}}},true);FB.Event.subscribe("auth.login",Member.setFBStatus);FB.Event.subscribe("auth.logout",Member.setFBStatus);};if(typeof FB!=="undefined"){try{fbAsyncInit();}catch(r){}}(function(){var v=document.getElementsByTagName("body")[0];var t=document.createElement("div");t.setAttribute("id","fb-root");var u=document.createElement("div");u.setAttribute("id","cnn_mOvrlycntr");v.insertBefore(t,v.firstChild);v.insertBefore(u,v.firstChild);var s=document.createElement("script");s.setAttribute("type","text/javascript");s.setAttribute("src","http://connect.facebook.net/en_US/all.js");s.setAttribute("async","true");document.getElementsByTagName("head")[0].appendChild(s);$j(document).ready(function(){if(typeof FB!=="undefined"){try{window.fbAsyncInit();}catch(w){}}});}());},setRememberMe:function(r){a=r;},getRememberMe:function(){return a;},setFBStatus:function(r){switch(r.status){case"connected":CNN_FB_data.fb.loginStatus=true;CNN_FB_data.fb.connectedStatus=true;break;case"notConnected":CNN_FB_data.fb.loginStatus=true;CNN_FB_data.fb.connectedStatus=false;break;default:CNN_FB_data.fb.loginStatus=false;CNN_FB_data.fb.connectedStatus=false;}if(ms_isLoggedIn()===true){CNN_FB_data.cnn.loginStatus=true;}if(typeof MainLocalObj!=="undefined"&&typeof MainLocalObj.showIdentity==="function"){MainLocalObj.showIdentity();}else{CNN_updateHeaderOptions();}},clearStoredDataAll:function(){Member.removeIDCookie();},clearStoredDataIdentities:function(){Member.removeIDCookie();},clearStoredPrefs:function(){Member.removeIDCookie();},removeIDCookie:function(){CNN_removeCookie("CNN_memberID","/",document.domain);},getReturnURL:function(){return g;},setReturnURL:function(r){g=r;},setUserDataFB:function(s,t,r){CNN_FB_user.accounts.fb.displayName=s.name;CNN_updateHeaderOptions();CNN_setCookie("CNN_memberID",Object.toJSON(CNN_FB_user),854400,"/",document.domain);if(r){if(!CNN_FB_user.prefs){CNN_handleOverlay("fb_choose_identity_overlay");}else{location.reload();}}},setUserDataCNN:function(s,r){CNN_setCookie("displayname",s.profile.screenName,854400,"/",document.domain);CNN_FB_user.accounts.cnn.displayName=s.profile.screenName;CNN_FB_user.accounts.fb.displayName=s.profile.fb_userName;CNN_FB_user.prefs=s.profile.prefChosen;CNN_FB_user.namePref=s.profile.id_pref;CNN_FB_user.avatar=s.profile.avatar_pref;CNN_setCookie("CNN_memberID",Object.toJSON(CNN_FB_user),854400,"/",document.domain);if(r||(Member.isConnected()&&Member.isLoggedIn("cnn")&&CNN_FB_user.prefs=="false")){CNN_handleOverlay("fb_choose_identity_overlay");}else{Member.executeCookieCopy();}},setUserAvatarPref:function(r){CNN_FB_user.avatar=r;CNN_setCookie("CNN_memberID",Object.toJSON(CNN_FB_user),854400,"/",document.domain);
},setUserNamePref:function(r){CNN_FB_user.prefs=true;CNN_FB_user.namePref=r;CNN_setCookie("CNN_memberID",Object.toJSON(CNN_FB_user),854400,"/",document.domain);},setDisconnectPrefs:function(){CNN_FB_user.prefs=false;CNN_FB_user.namePref="cnn";for(var r in CNN_FB_user.accounts.fb){CNN_FB_user.accounts.fb[r]="";}CNN_setCookie("profile.lastNewsID","fbfriends",24*30*12,"/",document.domain);CNN_setCookie("CNN_memberID",Object.toJSON(CNN_FB_user),854400,"/",document.domain);if(Member.isLoggedIn("cnn")){Member.cnnDisconnectFB();}else{CNN_setCookie("cnnfb.hasDisconnected",1,24*30*12,"/",document.domain);window.location.reload();}},setActivityFlag:function(){if(Member.hasDisconnected()){CNN_setCookie("cnnfb.hasDisconnected",0,24*30*12,"/",document.domain);window.location.reload();}else{CNN_handleOverlay("fb_turn_off_overlay");CNN_setCookie("cnnfb.hasDisconnected",1,24*30*12,"/",document.domain);}},getProfile:function(t){var s=(t)?true:false;var r={params:{"format":"jsonp"},onSuccess:function(u){var v=u.responseJSON;if(v&&v.errors){}else{if(v&&v.status=="success"){Member.setUserDataCNN(u.responseJSON,s);}}}};Member.getID(r);},getProfileJSON:function(s){var t={flow:"cnn-user-api",action:"getProfileJSON",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in getProfileJSON method");},updateProfile:function(s){var t={flow:"cnn-user-api",action:"updateProfile",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in updateProfile method");},getID:function(s){var t={flow:"cnn-user-api",action:"getID",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in updateProfile method");},getData:function(s){var t={flow:"cnn-user-api",action:"getData",requiredParams:["name"]};var r=e(s,t);(r)?f(r):m(c+arguments.callee);return r;},setData:function(s){var t={flow:"cnn-user-api",action:"setData",requiredParams:["name","data"]};var r=e(s,t);(r)?f(r):m("error in setData method");},appendData:function(s){var t={flow:"cnn-user-api",action:"appendData",requiredParams:["name","data"]};var r=e(s,t);(r)?f(r):m("error in appendData method");},prependData:function(s){var t={flow:"cnn-user-api",action:"prependData",requiredParams:["name","data"]};var r=e(s,t);(r)?f(r):m("error in prependData method");},getEmails:function(s){var t={flow:"cnn-user-api",action:"getEmails",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in getEmails method");},deleteEmail:function(s){var t={flow:"cnn-user-api",action:"setData",requiredParams:["email"]};var r=e(s,t);(r)?f(r):m("error in deleteEmail method");},changePrimaryEmail:function(s){var t={flow:"cnn-user-api",action:"changePrimaryEmail",requiredParams:["email"]};var r=e(s,t);(r)?f(r):m("error in changePrimaryEmail method");},addEmail:function(s){var t={flow:"cnn-user-api",action:"addEmail",requiredParams:["email"]};var r=e(s,t);(r)?f(r):m("error in api method");},sendResetPasswordCode:function(s){var t={flow:"cnn-passwordRecovery-api",action:"sendResetPasswordCode",requiredParams:["email"]};var r=e(s,t);(r)?f(r):m("error in api method");},changePassword:function(s){var t={flow:"cnn-passwordRecovery-api",action:"changePassword",requiredParams:["email","resetCode","password"]};var r=e(s,t);(r)?f(r):m("error in api method");},getNewsletter:function(s){var t={flow:"cnn-newsletter-api",action:"getNewsletter",requiredParams:["name"]};var r=e(s,t);(r)?f(r):m("error in api method");},getNewsletters:function(s){var t={flow:"cnn-newsletter-api",action:"getNewsletters",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in api method");},removeNewsletter:function(s){var t={flow:"cnn-newsletter-api",action:"removeNewsletter",requiredParams:["email","newsletter"]};var r=e(s,t);(r)?f(r):m("error in api method");},addNewsletter:function(s){var t={flow:"cnn-newsletter-api",action:"addNewsletter",requiredParams:["email","newsletter"]};var r=e(s,t);(r)?f(r):m("error in api method");},getActiveAndPendingNewsletters:function(s){var t={flow:"cnn-newsletter-api",action:"getActiveAndPendingNewsletters",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in api method");},getAlerts:function(s){var t={flow:"cnn-alert-api",action:"getAlerts",requiredParams:[]};var r=e(s,t);(r)?f(r):m("error in method");},removeAlerts:function(s){var t={flow:"cnn-alert-api",action:"removeAlerts",requiredParams:["alertId"]};var r=e(s,t);(r)?f(r):m("error in method");},getAlert:function(s){var t={flow:"cnn-alert-api",action:"getAlert",requiredParams:["alertId"]};var r=e(s,t);(r)?f(r):m("error in method");},addAlert:function(s){var t={flow:"cnn-alert-api",action:"addAlert",requiredParams:["email","name","include","exclude","format","frequency"]};var r=e(s,t);(r)?f(r):m("error in method");},suspendAlerts:function(s){var t={flow:"cnn-alert-api",action:"suspendAlerts",requiredParams:["alertId"]};var r=e(s,t);(r)?f(r):m("error in method");},updateAlert:function(s){var t={flow:"cnn-alert-api",action:"updateAlert",requiredParams:["email","name","include","exclude","format","frequency"]};var r=e(s,t);(r)?f(r):m("error in method");},activateAlerts:function(s){var t={flow:"cnn-alert-api",action:"activateAlerts",requiredParams:["alertId"]};var r=e(s,t);(r)?f(r):m("error in method");},fb_login:function(u){var s=CSIManager.getInstance();var r=Object.toQueryString(u)+"&callback=Member.loginCallbackFB";var t={url:d+"facebook-link-external-account-on-login",args:r,domId:false,breakCache:true};s.callObject(t);},register:function(t){var r=CSIManager.getInstance();var s={url:p+"register.api",args:t,domId:false,breakCache:true};r.callObject(s);},fb_register:function(t){var r=CSIManager.getInstance();var s={url:d+"fb-register-api",args:t,domId:false,breakCache:true};r.callObject(s);},fullLogout:function(){if(Member.isLoggedIn("facebook")&&Member.isConnected()){CNN_handleOverlay("fb_signedout_overlay");}else{Member.executeFullLogout();}},executeFullLogout:function(){if(Member.isLoggedIn("facebook")&&Member.isConnected()){FB.logout(function(r){Member.clearStoredDataIdentities("all");if(Member.isLoggedIn("cnn")){Member.logout();}});}else{if(Member.isLoggedIn("cnn")){Member.logout();}}},isConnected:function(){return CNN_FB_data.fb.connectedStatus;},logout:function(){var r=CSIManager.getInstance();var s={url:d+"cnn-logout-api",args:"callback=Member.logoutCallback&doSso=false",domId:false,breakCache:true};r.callObject(s);},logoutCallback:function(r){var v=r||false;if(v){Member.clearStoredDataIdentities("all");var t=CSIManager.getInstance();var u="assertionConsumerUrl=http://www.disqus.com/saml/cnn/logout/";u+="&target=http://audience.cnn.com/services/cnn/blank.api?callback=Member.logoutCallback";var s={url:"http://audience.cnn.com/services/cnn/flow/cnn-sso",args:u,domId:false,breakCache:true};t.callObject(s);}else{Member.executeCookieCopy(true);}},facebookLinkExternalAccountOnLogin:function(s){var t={flow:"facebook-link-external-account-on-login",action:"",requiredParams:["facebookUserId","principalType"]};var r=e(s,t);(r)?f(r):m("error in method");},facebookLinkExternalAccountLoggedIn:function(s){var t={flow:"facebook-link-external-account-loggedin",action:"",requiredParams:["facebookUserId","principalType"]};var r=e(s,t);(r)?f(r):m("error in method");},facebookLinkExternalAccount:function(s){var t={flow:"facebook-link-external-account",action:"",requiredParams:["facebookUserId","principalType"]};var r=e(s,t);(r)?f(r):m("error in method");},fbConnect:function(s){var t={flow:"fb-connect",action:"",requiredParams:["facebookUserId"]};var r=e(s,t);(r)?f(r):m("error in method");},connectAppOnly:function(r){location.reload();},facebookDiscAccount:function(r){FB.api({method:"auth.revokeAuthorization",uid:FB.getAuthResponse().userID},function(s){Member.setDisconnectPrefs("cnn");});},cnnDisconnectFB:function(){var t=CSIManager.getInstance();if(CNN_FB_user.avatar==="fb"){function s(v){var w=v;if(w.contentWindow){w=w.contentWindow;}if(w.contentDocument){w=w.contentDocument;}if(w.document){w=w.document;}return w;}var u=s($("avatarRemoveFrame")).getElementById("uploadForm");u.submit();}var r={params:{"avatarPref":"cnn","idPref":"cnn","fbName":"","prefChosen":false},onSuccess:function(v){var w=v.responseJSON;
if(w&&w.errors){}else{if(w&&w.status=="success"){var y={url:d+"ma-remove",args:"authorityTypeToRemove=3",domId:false,breakCache:false};t.callObject(y);CNN_setCookie("cnnfb.hasDisconnected",1,24*30*12,"/",document.domain);window.location.reload();}}}};Member.updateProfile(r);},reloadPage:function(){if(window.location.href.indexOf("?")>-1){window.location.href=window.location.href.substr(0,window.location.href.indexOf("?"));}else{window.location.href=window.location.href;}},executeCookieCopy:function(r){allCookies=CNN_getCookies();var w=allCookies["authid"]||null;var y=allCookies["CNNid"]||null;var v=allCookies["authpass"]||null;var t=allCookies["firstName"]||null;var s=allCookies["displayname"]||null;var u=(r)?"http://audience.ireport.com/services/cnn/cookiecopy.api?drop=true&url="+escape(CNN.Page.getRefURL({"is_LR":"1"})):"http://audience.ireport.com/services/cnn/cookiecopy.api?cnnid="+y+"&authid="+w+"&authpass="+v+"&displayname="+s+"&firstName="+t+"&url="+escape(CNN.Page.getRefURL({"is_LR":"1"}))+"&keepMeLoggedIn="+Member.getRememberMe();window.location.href=u;},login:function(t){var s=CSIManager.getInstance();var r=Object.toQueryString(t)+"&callback=Member.loginCallback";var u={url:d+"cnn-login-api",args:r,domId:false,breakCache:true};s.callObject(u);},loginCallbackFB:function(r){CNN_setCookie("profile.lastNewsID","fbfriends",24*30*12,"/",document.domain);CNN_setCookie("cnnfb.hasDisconnected",0,24*30*12,"/",document.domain);Member.loginCallback(r,true);},loginCallback:function(s,t){var y=s||false;var r=(t)?true:false;if(s&&s.status){if(s.status=="error"){for(i in s.errors){switch(s.errors[i]){case"invalid password":cnnConnectOverlayLoginValidationError("clear");cnnConnectOverlayLoginValidationError("add","Your email address or password doesn't match our records. Please try again.");cnnConnectOverlayLoginValidationError("show");break;}}return;}}y=false;if(y){var w=CSIManager.getInstance();var v="assertionConsumerUrl=http://www.disqus.com/saml/cnn/postback/";if(r){v+="&target="+d+"cnn-blank-api?callback=Member.loginCallbackFB";}else{v+="&target="+d+"cnn-blank-api?callback=Member.loginCallback";}var u={url:"http://audience.cnn.com/services/cnn/flow/cnn-sso",args:v,domId:false,breakCache:true};w.callObject(u);}else{Member.getProfile(r);}},loginCallbackFbCnctRec:function(){Member.getProfile(true);},loginCallbackFBCnct:function(s,r){CNN_setCookie("cnnfb.hasDisconnected",0,24*30*12,"/",document.domain);Member.setRememberMe(true);Member.loginCallback(s,r);},hasDisconnected:function(){allCookies=CNN_getCookies();return(allCookies["cnnfb.hasDisconnected"]==1)?true:false;},isLoggedIn:function(r){allCookies=CNN_getCookies();switch(r){case"facebook":return CNN_FB_data.fb.loginStatus;break;case"cnn":var s=allCookies["authid"]||null;if(s==null){return false;}else{return true;}break;}}};return h;}();function fbSessionHandler(a){if(!a.authResponse.accessToken){return;}if(a.status=="connected"){if(typeof Dsq!=="undefined"){if(Dsq.CNN!==undefined&&Dsq.CNN.authenticateFacebookUser!==undefined){Dsq.CNN.authenticateFacebookUser(FB.getAuthResponse().userID);}}}var b={params:{facebookUserId:FB.getAuthResponse().userID,principalType:"FACEBOOK"},onSuccess:function(f){var e=f.responseJSON.status;if(e=="need register"){if(allCookies["CNN_member"]){var h=new Overlay("fb_profile_signin_overlay");h.load();}else{var g=new Overlay("fb_profile_signup_overlay");g.load();}}else{if(e=="existing user"){Member.loginCallbackFBCnct(f.responseJSON,true);}else{if(e=="unavailable"){var d=new Overlay("fb_merge_error1_overlay");d.load();}else{if(e=="external authorization failed"){var c=new Overlay("fb_error_external");c.load();}else{var c=new Overlay("fb_error_general");c.load();}}}}}};if(Member.isLoggedIn("cnn")){Member.facebookLinkExternalAccountLoggedIn(b);}else{Member.fbConnect(b);}}function CNN_handleOverlay(b,e){if(Member.isLoggedIn("facebook")){switch(b){case"profile_signin_overlay":var d=new Overlay("fb_profile_signin_init_overlay");d.load();break;case"profile_signup_overlay":var a=new Overlay("fb_profile_signup_init_overlay");a.load();break;default:var c=new Overlay(b);c.load();}}else{switch(b){case"profile_signin_overlay":var d=new Overlay("profile_signin_overlay_videxp");d.load();break;case"profile_signup_overlay":var a=new Overlay("profile_signup_overlay");a.load();break;default:var c=new Overlay(b);c.load();}}}function Overlay(s){var p=s,r=[],t=false;var f="/.element/js/3.0/overlay/data/2.0-migration/";f=(f!==undefined&&f.length>0&&f.replace(/@/g,"")!="msib_overlay_ssi_root_dir")?f:"http://www.cnn.com/.element/js/3.0/overlay/data/2.0/";var k=f+p+".html";var o;var b="cnnDimmer";var q=$(b);if(!q){var l=new Element("div",{"id":"cnnDimmer"});l.setStyle({"backgroundColor":"#000000","position":"absolute","z-index":2146483646,"top":"0px","left":"0px","opacity":"0.5","display":"none","z-index":"11"});document.body.appendChild(l);}var e=function(){return Math.max(document.documentElement["clientHeight"],document.body["scrollHeight"],document.documentElement["scrollHeight"],document.body["offsetHeight"],document.documentElement["offsetHeight"]);};var a=function(){return Math.max(document.documentElement["clientWidth"],document.body["scrollWidth"],document.documentElement["scrollWidth"],document.body["offsetWidth"],document.documentElement["offsetWidth"]);};var m=function(){return Math.max(document.viewport.getHeight(),e());};var u=function(){return Math.max(document.viewport.getWidth(),a());};var h=function(){var w=0,v=0;if(typeof(window.pageYOffset)=="number"){v=window.pageYOffset;w=window.pageXOffset;}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){v=document.body.scrollTop;w=document.body.scrollLeft;}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){v=document.documentElement.scrollTop;w=document.documentElement.scrollLeft;}}}return[w,v];};var g=function(){var v=m()+"px";var w=u()+"px";$(b).setStyle({"width":w,"height":v});};var n=function(){if($(p)){var z=h();var w=$(p).getWidth();var y=$(p).getHeight();var D=document.viewport.getHeight();var B=document.viewport.getWidth();var A=z[1];var v=Math.floor((B/2)-(w/2));var C=Math.floor((A+(D/2))-(y/2));if((C+y)>e()){C=((e()-y)-100);}C=(C<=110)?110:C;v=(C<=9)?10:v;$(p).style.top=C+"px";$(p).style.left=v+"px";}};var d=function(w,v){var y="";cnn_mOverlayObj=w;cnn_mOverlayObj.init_overlay(o);y=cnn_mOverlayObj.overlay_html;$("cnn_mOvrlycntr").update(y);n();$(p).show();cnn_mOverlayObj.init_events(o);};var c=function(){g();$(b).show();var v="";v+='<div style="top: 312px; left: 356px;" class="overlay_content" id="'+p+'"><div class="cnnConnBox"><div onclick="closeOverlay(\''+p+'\');return false;" class="overlay_close"></div><div class="signup_cont"><div class="profileoverlay_bdy p_signup"><h1>Loading...</h1><div id="facebookInfo"><p class="psigninp2" id=""></p></div></div></div></div><div class="clear"></div></div>';$("cnn_mOvrlycntr").update(v);CSIManager.getInstance().call(k,"",false,d);};return{load:function(v){$("cnn_mOvrlycntr").update("");Event.observe(window,"resize",function(){g();n();});o=v||{"msibServer":"http://audience.cnn.com/services/cnn/"};c();},close:function(){$("cnn_mOvrlycntr").update("");$(b).hide();},loadHLDR:function(v){$("cnn_mOvrlycntr").update("");Event.observe(window,"resize",function(){g();n();});g();$(b).show();var w="";w+='<div class="overlay_content cnn_fbcntorly cnn_fbcntstryorly" id="'+p+'"><div class="cnnConnBox"><div onclick="closeOverlay(\''+p+'\');return false;" class="overlay_close"></div><div class="signup_cont"><div id="'+v+'"><div class="profileoverlay_bdy p_signup"><h1>Loading...</h1><div id="facebookInfo"><p class="psigninp2" id=""></p></div></div></div></div></div><div class="clear"></div></div>';$("cnn_mOvrlycntr").update(w);n();},addToQueue:function(){if(storage){storage.dataObjects.overlayQueue.unshift(p);storage.put("overlayQueue",storage.dataObjects.overlayQueue);storage.save();}else{}},removeFromQueue:function(v){}};}var cnn_OvrlyIEvents={};function CNN_FBpsnlzdOO(){allCookies=CNN_getCookies();
var a=Member.hasDisconnected();var b="";if(Member.isLoggedIn("facebook")&&!a){b+='Using Facebook, you can now see what your friends are recommending and sharing on CNN. To learn more, or to disable this feature, go to <a href="/profile/?setTab=mysettings">settings</a>.';}else{b+="Using Facebook, you can now see the most recommended CNN stories. Facebook user? If so, <a href=\"javascript:CNN_handleOverlay('profile_signin_overlay');\">log in</a> to see your friends' activity on CNN.";}$("cnn_FBawOLYM").update(b);$("cnn_FBawDIM").removeClassName("cnn_dynone");$("cnn_FBawOLY").removeClassName("cnn_dynone");}function CNN_FBpsnlzdOC(){$("cnn_FBawOLY").addClassName("cnn_dynone");$("cnn_FBawDIM").addClassName("cnn_dynone");}function closeOverlay(a){$("cnn_mOvrlycntr").update("");$("cnnDimmer").hide();}function showOverlay(b){$("cnn_mOvrlycntr").update("");var a=new Overlay(b);a.load();}function closeCSIOverlay(a){$("cnn_mOvrlycntr").update("");$("cnnDimmer").hide();}function showCSIOverlay(b){$("cnn_mOvrlycntr").update("");var a=new Overlay(b);a.load();}function validateEmail(b){var a=/^([a-zA-Z0-9_\.\'\-\+])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/;return a.test(b);}function validate_signin(){var c=$("cnnConnectFormLogin").serialize(true);var h="cnnConnectFormLogin";var e=$(h).email.value;var d=$(h).password.value;var g=$(h).cnnRememberMe.checked;var f=true;var a="Registration isn't complete without your ";var b=[];if(validateEmail(e)==false){f=false;b[b.length]="e-mail address";$("psigninp2_email").addClassName("redtexterror");$(h).email.className="redinput_error";}if(d==""){f=false;$("psigninp2_password").addClassName("redtexterror");b[b.length]="password";$(h).password.className="redinput_error";}if(f){if(c.cnnRememberMe==="on"){document.cnnConnectFormLogin.keepMeLoggedIn.value=true;Member.setRememberMe(true);}else{document.cnnConnectFormLogin.keepMeLoggedIn.value=false;Member.setRememberMe(false);}c.doSso=false;document.cnnConnectFormLogin.submit();}else{cnnConnectOverlayLoginValidationError("clear");if(b.length==2){cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" and "+b[1]+" to log in.");}else{if(b[0]=="e-mail address"&&validateEmail(e)==false&&e!=""){cnnConnectOverlayLoginValidationError("add","You entered an invalid e-mail address.");}else{if(b[0]=="e-mail address"&&e==""){cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" to log in.");}else{cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" to log in.");}}}cnnConnectOverlayLoginValidationError("show");}}function validate_signinFB(){var c=$("cnnConnectFormLogin").serialize(true);var h="cnnConnectFormLogin";var e=$(h).email.value;var d=$(h).password.value;var g=$(h).cnnRememberMe.checked;var f=true;var a="Registration isn't complete without your ";var b=[];if(validateEmail(e)==false){f=false;b[b.length]="e-mail address";$("psigninp2_email").addClassName("redtexterror");$(h).email.className="redinput_error";}if(d==""){f=false;$("psigninp2_password").addClassName("redtexterror");b[b.length]="password";$(h).password.className="redinput_error";}if(f){if(c.cnnRememberMe==="on"){document.cnnConnectFormLogin.keepMeLoggedIn.value=true;Member.setRememberMe(true);}else{document.cnnConnectFormLogin.keepMeLoggedIn.value=false;Member.setRememberMe(false);}c.doSso=false;document.cnnConnectFormLogin.submit();}else{cnnConnectOverlayLoginValidationError("clear");if(b.length==2){cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" and "+b[1]+" to log in.");}else{if(b[0]=="e-mail address"&&validateEmail(e)==false&&e!=""){cnnConnectOverlayLoginValidationError("add","You entered an invalid e-mail address.");}else{if(b[0]=="e-mail address"&&e==""){cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" to log in.");}else{cnnConnectOverlayLoginValidationError("add","We need your "+b[0]+" to log in.");}}}cnnConnectOverlayLoginValidationError("show");}}function registerHandler(b){if(b.status=="success"){if(Member.isConnected()){FB.api({method:"fql.query",query:"SELECT name, pic_square FROM profile WHERE id="+FB.getAuthResponse().userID},function(d){var c=d[0];var e={params:{facebookUserId:FB.getAuthResponse().userID,principalType:"FACEBOOK"},onSuccess:function(g){if(g.responseJSON.status=="existing user"){Member.loginCallbackFBCnct(g.responseJSON,true);}if(g.responseJSON.status=="unavailable"){var f=new Overlay("fb_merge_error1_overlay");f.load();}if(g.responseJSON.status=="need register"){if(allCookies["CNN_member"]){var k=new Overlay("fb_profile_signin_overlay");k.load();}else{var h=new Overlay("fb_profile_signup_overlay");h.load();}}}};Member.facebookLinkExternalAccountLoggedIn(e);});}else{Member.getProfile();}}else{if(b.errors){cnnConnectOverlayError("clearErrorText");if($("cnnConnectKaptchaImage")){generateKaptchaImage();}for(var a=0;a<b.errors.length;a++){switch(b.errors[a]){case"email address not available":cnnConnectOverlayRegisterError("email");cnnConnectOverlayError("addErrorText","That e-mail address is already taken.<br/>");break;case"missing email address":cnnConnectOverlayRegisterError("email");cnnConnectOverlayError("addErrorText","You forgot to enter your e-mail address.<br/>");break;case"bad email address":cnnConnectOverlayRegisterError("email");cnnConnectOverlayError("addErrorText","You entered an invalid e-mail address.<br/>");break;case"missing password":cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("addErrorText","You forgot to enter your password.<br/>");break;case"bad password":cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("addErrorText","You entered an invalid password.<br/>");break;case"missing screen name":cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("addErrorText","You forgot to enter your screen name.<br/>");break;case"screen name not available":cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("addErrorText","That screen name is already taken. Please choose another.<br/>");break;case"missing captcha":cnnConnectOverlayRegisterError("captcha");cnnConnectOverlayError("addErrorText","You forgot to type in the security word in the grey box.<br/>");break;case"bad captcha":cnnConnectOverlayRegisterError("captcha");cnnConnectOverlayError("addErrorText","You entered the security word in the grey box incorrectly.<br/>");break;case"missing privacy policy":cnnConnectOverlayError("addErrorText","You must agree to the privacy policy.<br/>");break;default:break;}}cnnConnectOverlayError("showErrorText");}}}function validate_register2(){newuser=true;var h="cnnConnectFormRegister";var e=$(h).email.value.trim();var l=$(h).password.value;var c=$(h).displayname.value.trim();$(h).displayname.value=c;var a="domestic_version";var n="";var k=true;var d="A required field is missing! Registration isn't complete without your ";var m=[];if(e==""||validateEmail(e)==false){k=false;m[m.length]="e-mail address";cnnConnectOverlayRegisterError("email");}else{$("cnnConnectFormRegister").email.className="cnnConnectFormbg1 cnn_connectoverlay_email2";$("signup_email").previous("p").removeClassName("redtexterror");}if(l==""){k=false;m[m.length]="password";cnnConnectOverlayRegisterError("password");}else{if(l.length<6||l.indexOf(" ")!=-1||l.length>10){k=false;cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("errorText","You entered an invalid password.");return;}else{$("cnnConnectFormRegister").password.className="cnnConnectFormbg2 cnn_connectoverlay_password2";$("signup_password").previous("p").removeClassName("redtexterror");}}var g=/^\w+$/;if(c==""){k=false;m[m.length]="screen name";cnnConnectOverlayRegisterError("screenName");}else{if(c.length<3){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","The screen name that you entered is too short.");return;}else{if(c.length>12){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","Your screen name must be 3-12 characters; numbers and letters only.");
return;}else{if(g.test(c)==false){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","Your screen name includes invalid characters.");return;}else{$("cnnConnectFormRegister").displayname.className="cnnConnectFormbg3 cnn_connectoverlay_displayname";$("signup_displayname").previous("p").removeClassName("redtexterror");}}}}if(k==true){var f=$("cnnConnectFormRegister").serialize();document.cnnConnectFormRegister.submit();}else{switch(m.length){case 1:if(m[0]=="e-mail address"&&validateEmail(e)==false&&e!=""){d="You entered an invalid e-mail address.";}else{if(m[0]=="e-mail address"&&e==""){d+=m[0];}else{d+=m[0];}}break;case 2:d+=m[0]+" and "+m[1];break;default:for(var b=0;b<m.length;b++){d+=(b==(m.length-1))?"and "+m[b]+".":m[b]+", ";}break;}cnnConnectOverlayError("errorText",d);}}function validate_register(){newuser=true;var h="cnnConnectFormRegister";var e=$(h).email.value.trim();var l=$(h).password.value;var c=$(h).displayname.value.trim();$(h).displayname.value=c;var m=$(h).kaptcha.value;var a="domestic_version";var o="";if($(h).specialOffers.checked==true){o="member_services";}var k=true;var d="A required field is missing! Registration isn't complete without your ";var n=[];if(e==""||validateEmail(e)==false){k=false;n[n.length]="e-mail address";cnnConnectOverlayRegisterError("email");}else{$("cnnConnectFormRegister").email.className="cnnConnectFormbg1 cnn_connectoverlay_email2";$("signup_email").previous("p").removeClassName("redtexterror");}if(l==""){k=false;n[n.length]="password";cnnConnectOverlayRegisterError("password");}else{if(l.length<6||l.indexOf(" ")!=-1||l.length>10){k=false;cnnConnectOverlayRegisterError("password");cnnConnectOverlayError("errorText","You entered an invalid password.");return;}else{$("cnnConnectFormRegister").password.className="cnnConnectFormbg2 cnn_connectoverlay_password2";$("signup_password").previous("p").removeClassName("redtexterror");}}var g=/^\w+$/;if(c==""){k=false;n[n.length]="screen name";cnnConnectOverlayRegisterError("screenName");}else{if(c.length<3){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","The screen name that you entered is too short.");return;}else{if(c.length>12){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","Your screen name must be 3-12 characters; numbers and letters only.");return;}else{if(g.test(c)==false){k=false;cnnConnectOverlayRegisterError("screenName");cnnConnectOverlayError("errorText","Your screen name includes invalid characters.");return;}else{$("cnnConnectFormRegister").displayname.className="cnnConnectFormbg3 cnn_connectoverlay_displayname";$("signup_displayname").previous("p").removeClassName("redtexterror");}}}}if(m==""){k=false;generateKaptchaImage();n[n.length]="security word";cnnConnectOverlayRegisterError("kaptcha");cnnConnectOverlayError("errorText","You must enter a security word.");}else{$("cnnConnectFormRegister").kaptcha.className="cnnConnectFormbg4 cnn_connectoverlay_enterit";$("signup_kaptcha_p1").removeClassName("redtexterror");}if(k==true){var f=$("cnnConnectFormRegister").serialize();document.cnnConnectFormRegister.submit();}else{switch(n.length){case 1:if(n[0]=="e-mail address"&&validateEmail(e)==false&&e!=""){d="You entered an invalid e-mail address.";}else{if(n[0]=="e-mail address"&&e==""){d+=n[0];}else{d+=n[0];}}break;case 2:d+=n[0]+" and "+n[1];break;default:for(var b=0;b<n.length;b++){d+=(b==(n.length-1))?"and "+n[b]+".":n[b]+", ";}break;}cnnConnectOverlayError("errorText",d);}}function validateResetEmail(){var c="cnnConnectFormForgot";var b=$(c).email.value;if(validateEmail(b)==false){cnnConnectOverlayForgotValidationError("clear");cnnConnectOverlayForgotValidationError("add","You must enter your e-mail address to reset your password.");cnnConnectOverlayForgotValidationError("show");}else{var a={params:{"email":b},onSuccess:function(d){var f=d.responseJSON;if(f&&f.errors){cnnConnectOverlayForgotValidationError("clear");for(var e=0;e<f.errors.length;e++){switch(f.errors[e]){case"User not found":cnnConnectOverlayForgotValidationError("add","Your e-mail address doesn't match our records. Please try again.");break;case"You have recently requested to reset your password.  You must wait before requesting another reset.":cnnConnectOverlayForgotValidationError("add","You have recently requested to reset your password.  You must wait before requesting another reset.");break;default:cnnConnectOverlayForgotValidationError("add",f.errors[e]);break;}}cnnConnectOverlayForgotValidationError("show");}else{if(f&&f.status=="success"){cnnConnectOverlayUpdate("forgot2reset");}}}};Member.sendResetPasswordCode(a);}}function validateSetUserPassword(){var g="cnnConnectFormReset";var e=$(g).email.value;var f=$(g).resetCode.value;var k=$(g).newPassword.value;var a=k;var h=true;var d="Reset Password isn't complete without your ";var l=[];if(validateEmail(e)==false||e=="Email Address"){h=false;l[l.length]="e-mail address";cnnConnectOverlayResetError("email");}else{$("new_password_email").previous("p").removeClassName("redtexterror");$("cnnConnectFormReset").email.className="cnn_connectoverlay_email3 cnnredtxt";}if(f==""||f=="Reset Code"){h=false;l[l.length]="reset code";cnnConnectOverlayResetError("resetCode");}else{$("reset_code").previous("p").removeClassName("redtexterror");$("cnnConnectFormReset").resetCode.className="cnn_connectoverlay_password3 cnnredtxt";}if(k==""||k=="New Password"){h=false;l[l.length]="new password";cnnConnectOverlayResetError("newPassword");}else{$("new_password").previous("p").removeClassName("redtexterror");$("cnnConnectFormReset").newPassword.className="cnn_connectoverlay_password4 cnnredtxt";}if(h==true){var c={params:{"email":e,"resetCode":f,"password":k,"confirmPassword":a},onSuccess:function(m){var o=m.responseJSON;if(o&&o.errors){cnnConnectOverlayResetValidationError("clear");for(var n=0;n<o.errors.length;n++){switch(o.errors[n]){case"missing email address":cnnConnectOverlayResetError("email");cnnConnectOverlayResetValidationError("add","You forgot to enter your e-mail address.<br/>");break;case"profile not found":cnnConnectOverlayResetError("email");cnnConnectOverlayResetValidationError("add","Your e-mail address or reset code doesn't match our records. Please try again.<br/>");break;case"missing new password":cnnConnectOverlayResetError("newPassword");cnnConnectOverlayResetValidationError("add","You forgot to enter your new password.<br/>");break;case"missing confirm new password":cnnConnectOverlayResetError("confirmNewPassword");cnnConnectOverlayResetValidationError("add","You forgot to confirm your new password.<br/>");break;case"confirm password did not match":cnnConnectOverlayResetError("newPassword");cnnConnectOverlayResetError("confirmNewPassword");cnnConnectOverlayResetValidationError("add","Your passwords do not match.<br/>");break;case"reset code has expired":cnnConnectOverlayResetError("resetCode");cnnConnectOverlayResetValidationError("add","Your reset code has expired. <a href=\"javascript: void(0);\" onclick=\"closeOverlay('profile_forgotpass2_overlay');showOverlay('profile_forgotpass_overlay');\">Send another e-mail</a> with an updated link and reset code to reset your password.<br/>");break;case"The reset code does not match our records":cnnConnectOverlayResetError("resetCode");cnnConnectOverlayResetValidationError("add","Your reset code does not match our records. <a href=\"javascript: void(0);\" onclick=\"closeOverlay('profile_forgotpass2_overlay');showOverlay('profile_forgotpass_overlay');\">Send another e-mail</a> with an updated link and reset code to reset your password.<br/>");break;default:cnnConnectOverlayResetError("default");cnnConnectOverlayResetValidationError("add","We're sorry! This service is temporarily unavailable. Please try again soon.");break;}}cnnConnectOverlayResetValidationError("show");}else{if(o&&o.status=="success"){cnnConnectOverlayUpdate("reset2loginsuccess");}}}};Member.changePassword(c);
}else{cnnConnectOverlayResetValidationError("clear");switch(l.length){case 1:d+=l[0]+".";break;case 2:d+=l[0]+" and "+l[1]+".";break;default:for(var b=0;b<l.length;b++){d+=(b==(l.length-1))?"and "+l[b]+".":l[b]+", ";}break;}cnnConnectOverlayResetValidationError("add",d);cnnConnectOverlayResetValidationError("show");}}function generateKaptchaImage(){var a=getRandomId();$("cnnConnectKaptchaImage").src=ms_baseStandard+"kaptcha?challenge_id="+a;$("cnnConnectKaptchaImage").width="200";$("cnnConnectKaptchaImage").height="50";$("cnnConnectFormRegister").kaptcha.value="";}if(Object.isUndefined(CNNO)){var CNNO=Class.create({"chars":"0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz","randomStr":function(a){var d="";for(var c=0;c<a;c++){var b=Math.floor(Math.random()*this.chars.length);d+=this.chars.substring(b,b+1);}return d;},"Page":{"cleanURL":(window.location.href.indexOf("?")>-1)?window.location.href.substr(0,window.location.href.indexOf("?")):window.location.href,"urlArgs":"","refresh":function(b,a){location.href=this.getRefURL(b,a);},"getRefURL":function(h,b){if(Object.isUndefined(h)){h={};}if(Object.isUndefined(b)){b={};}b.cnncb=1;b.cnnqueue=1;var a=this.urlNameVals();var g="";var e=[];for(var d in a){if(!b[d]&&!h[d]&&a[d]){e.push(d+"="+a[d]);}}for(var d in h){if(h[d]){e.push(d+"="+h[d]);}}g=e.join("&");var c=this.cleanURL+"?";if(g){c+=g;}var f=CNNO.prototype.Overlay.queue.join("_");if(f){if(g){c+="&";}c+="cnnqueue="+f;}return c;},"urlNameVals":function(){var b=new Object();var f=location.search.substring(1);var e=f.split("&");for(var c=0;c<e.length;c++){var g=e[c].indexOf("=");if(g==-1){continue;}var a=e[c].substring(0,g);var d=e[c].substring(g+1);b[a]=unescape(d);}this.urlArgs=b;return b;}}});}CNNO.addMethods({"Profile":{"is_loaded":0,"emails":null,"init":function(){},"loadFrames":function(b){if(b=="l"){var a;try{a=document.createElement('<iframe name="loginFrame">');}catch(c){a=document.createElement("iframe");}a.setAttribute("name","loginFrame");a.setAttribute("height","1");a.setAttribute("width","1");a.setAttribute("id","loginFrame");a.setAttribute("style","height:1px;width:1px;");$$("body")[0].appendChild(a);}else{var d;try{d=document.createElement('<iframe name="registerFrame">');}catch(c){d=document.createElement("iframe");}d.setAttribute("name","registerFrame");d.setAttribute("height","1");d.setAttribute("width","1");d.setAttribute("id","registerFrame");d.setAttribute("style","height:1px;width:1px;");$$("body")[0].appendChild(d);}}}});CNNO.addMethods({"Overlay":{"app_dim":0,"queue":[],"active":null,"t_q":null,"setDim":function(b){if(!this.app_dim){var a=document.createElement("div");a.id="cnn_overlaydim";a.className="cnn_overlaydim";$$("body")[0].appendChild(a);$("cnn_overlaydim").setStyle({"display":"none"});Event.observe(window,"resize",function(){CNNO.prototype.Overlay.sizeDim();});this.app_dim=1;}CNNO.prototype.Overlay.sizeDim();if(b){$("cnn_overlaydim").show();}else{$("cnn_overlaydim").hide();}},"sizeDim":function(){var b=document.viewport.getHeight();var d=document.viewport.getWidth();var f=Math.max(document.documentElement["clientHeight"],document.body["scrollHeight"],document.documentElement["scrollHeight"],document.body["offsetHeight"],document.documentElement["offsetHeight"]);var c=Math.max(document.documentElement["clientWidth"],document.body["scrollWidth"],document.documentElement["scrollWidth"],document.body["offsetWidth"],document.documentElement["offsetWidth"]);var e=(f>b)?f:b;var a=(c>d)?c:d;$("cnn_overlaydim").setStyle({"width":a+"px","height":e+"px"});},"center":function(h){var e=this.getsoffset();var a=$(h).getWidth();var c=$(h).getHeight();var l=document.viewport.getHeight();var b=document.viewport.getWidth();var m=Math.max(document.documentElement["clientHeight"],document.body["scrollHeight"],document.documentElement["scrollHeight"],document.body["offsetHeight"],document.documentElement["offsetHeight"]);var d=Math.max(document.documentElement["clientWidth"],document.body["scrollWidth"],document.documentElement["scrollWidth"],document.body["offsetWidth"],document.documentElement["offsetWidth"]);var g=e[1];var k=Math.floor((b/2)-(a/2));var f=Math.floor((g+(l/2))-(c/2));if((f+c)>m){f=((m-c)-100);}f=(f<=110)?110:f;k=(f<=9)?10:k;$(h).style.top=f+"px";$(h).style.left=k+"px";},"getsoffset":function(){var b=0,a=0;if(typeof(window.pageYOffset)=="number"){a=window.pageYOffset;b=window.pageXOffset;}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){a=document.body.scrollTop;b=document.body.scrollLeft;}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){a=document.documentElement.scrollTop;b=document.documentElement.scrollLeft;}}}return[b,a];},"close":function(a){$("cnn_overlaycntnt").update();this.setDim(0);},"checkQ":function(){var a=CNNO.prototype.Page.urlNameVals();if(a.cnnqueue){var b=a.cnnqueue.split("_");var c=b.shift();this.load(c,"auto");}},"data":{"newsletters":{"j_loaded":0,"h_loaded":0,"js":null,"html":null}},"keys":{"news-am":{"ref_name":"American Morning","j_file":"newsletters","h_file":"newsletters"},"news-prime":{"ref_name":"Prime News","j_file":"newsletters","h_file":"newsletters"},"news-pol":{"ref_name":"Politics Alerts","j_file":"newsletters","h_file":"newsletters"},"news-breaking":{"ref_name":"Breaking News Alert","j_file":"newsletters","h_file":"newsletters"},"news-intl-amanpour":{"ref_name:":"Amanpour","j_file":"newsletters","h_file":"newsletters"},"news-member_services":{"ref_name":"Marketing","j_file":"newsletters","h_file":"newsletters"},"news-cnn-bia":{"ref_name":"Black in America","j_file":"newsletters","h_file":"newsletters"},"news-intl-htmlasiaheadlines":{"ref_name":"CNN Asia editorial note","j_file":"newsletters","h_file":"newsletters"},"news-intl-htmleuheadlines":{"ref_name":"CNN Europe editorial note","j_file":"newsletters","h_file":"newsletters"},"news-cnn-heroes":{"ref_name":"CNN Heroes","j_file":"newsletters","h_file":"newsletters"},"news-intl-htmltravel":{"ref_name":"CNN Partner Hotel specials","j_file":"newsletters","h_file":"newsletters"},"news-cnn-health":{"ref_name":"Health News","j_file":"newsletters","h_file":"newsletters"},"news-intl-insideafrica":{"ref_name":"Inside Africa","j_file":"newsletters","h_file":"newsletters"},"news-cnn-larryking":{"ref_name":"Larry King Live","j_file":"newsletters","h_file":"newsletters"},"news-cnn-loudobbs":{"ref_name":"Lou Dobbs Tonight","j_file":"newsletters","h_file":"newsletters"},"news-cnn-rcshow":{"ref_name":"Morning Express","j_file":"newsletters","h_file":"newsletters"},"news-cnn-morninggrind":{"ref_name":"Political Ticker - weekday edition","j_file":"newsletters","h_file":"newsletters"},"news-cnn-sundaysotu":{"ref_name":"Political Ticker - Sunday, State of the Union edition","j_file":"newsletters","h_file":"newsletters"},"news-cnn-showbiz":{"ref_name":"Showbiz Tonight","j_file":"newsletters","h_file":"newsletters"},"news-cnn-situationroom":{"ref_name":"Situation Room","j_file":"newsletters","h_file":"newsletters"},"news-cnn-computing":{"ref_name":"Tech News","j_file":"newsletters","h_file":"newsletters"},"news-cnn-dailytop10":{"ref_name":"Todays Top Video","j_file":"newsletters","h_file":"newsletters"},"news-cnn-primetime":{"ref_name":"Tonight on CNN","j_file":"newsletters","h_file":"newsletters"},"news-intl-vitalsigns":{"ref_name":"Vital Signs","j_file":"newsletters","h_file":"newsletters"}},"qOverlay":function(a){this.queue.push(a);},"clearQ":function(){this.queue=[];},"qRefresh":function(){var a=this.queue.join("_");CNNO.prototype.Page.refresh({"cnnqueue":a});},"callback":function(a,b){if(a=="json"){this.data[this.keys[b].j_file].j_loaded=1;}if(a=="html"){this.data[this.keys[b].h_file].h_loaded=1;}if(this.data[this.keys[b].j_file].j_loaded&&this.data[this.keys[b].h_file].h_loaded){this.data[this.keys[b].j_file].js.init();}},"callbackCSI":function(a){CNNO.prototype.Overlay.data[a.key].html=a;CNNO.prototype.Overlay.callback("html",CNNO.prototype.Overlay.active);
},"callbackJSON":function(a){this.data[a.key].js=a;this.callback("json",CNNO.prototype.Overlay.active);},"init":function(){Event.observe(document,"dom:loaded",function(){var a=document.createElement("div");a.id="cnn_overlaycntnt";$$("body")[0].appendChild(a);});CNNO.prototype.Overlay.checkQ();},"load":function(a,b){if(typeof(b)=="undefined"){b="manual";}this.active=a;if(b=="auto"){this.t_q=a;}else{this.setDim(1);$("cnn_overlaycntnt").update('<div id="cnn_overlay_load" class="cnn_overlaybox cnn_overlayloading"><p align="center"><img src="http://i.cdn.turner.com/cnn/.e/img/3.0/global/misc/loading.gif">loading</p></div>');CNNO.prototype.Overlay.center("cnn_overlay_load");CNNO.prototype.Overlay.loadJSONP(a);CNNO.prototype.Overlay.loadHCSI(a);}},"triggerQ":function(){if(CNNO.prototype.Overlay.t_q){CNNO.prototype.Overlay.setDim(1);$("cnn_overlaycntnt").update('<div id="cnn_overlay_load" class="cnn_overlaybox cnn_overlayloading"><p align="center"><img src="http://i.cdn.turner.com/cnn/.e/img/3.0/global/misc/loading.gif">loading</p></div>');CNNO.prototype.Overlay.center("cnn_overlay_load");CNNO.prototype.Overlay.loadJSONP(CNNO.prototype.Overlay.t_q);CNNO.prototype.Overlay.loadHCSI(CNNO.prototype.Overlay.t_q);}},"loadJSONP":function(c){if(!this.data[this.keys[c].j_file].j_loaded){var a=$$("head")[0];var b=document.createElement("script");b.setAttribute("src","http://www.cnn.com/.element/js/3.0/overlay/data/js/"+this.keys[c].j_file+".js");b.setAttribute("type","text/javascript");a.appendChild(b);}else{this.callback("json",c);}},"loadHCSI":function(a){if(!this.data[this.keys[a].h_file].h_loaded){CSIManager.getInstance().call("http://www.cnn.com/.element/js/3.0/overlay/data/html/"+this.keys[a].j_file+".html","","",CNNO.prototype.Overlay.callbackCSI);}else{this.callback("html",a);}},"update":function(a,b){$("cnn_overlaycntnt").update(CNNO.prototype.Overlay.data[CNNO.prototype.Overlay.keys[a].j_file].html.data[b]);CNNO.prototype.Overlay.center("cnn_overlay_"+CNNO.prototype.Overlay.keys[a].j_file);CNNO.prototype.Overlay.data[CNNO.prototype.Overlay.keys[a].j_file].js.html_prep(b);}}});if("undefined"===typeof(window.CNN)){var CNN={};}function init_CNNO(){var a=new CNNO();window["CNN"]=Object.extend(a,window["CNN"]||{});}init_CNNO();function cnn_memfbini(){if(!CNN.Profile.is_loaded){if(typeof(cnn_onMemFBinit)==="function"){cnn_onMemFBinit();}CNN.Profile.is_loaded=1;CNN.Overlay.triggerQ();}}CNN.Overlay.init();function CNN_extractHost(a){var b=/^(?:[^:\/?#]+):\/\/([^\/?#]+)(?::\d+)?(?:[^?#]*)\//i.exec(a);if(b&&typeof b==="object"){return b[1];}else{return"";}}function CNN_bustFrame(){var a=["digg.com"];if(top.location!=window.location){var c=CNN_extractHost(document.referrer);if(c){for(var b=0;b<a.length;b++){if(c.indexOf(a[b])!=-1){top.location.replace(window.location);return;}}}}}CNN_bustFrame();var adHeadOffset,adHeadClass,allCookies,adHeadCookie,isClassAndOffsetValid,alreadySwappedTargetImage,alreadySwappedCookieCrumb,adHeadHash,validClassesAndOffsets,i,alreadySwappedDETargetImage,cnnDEadDEonCookie,cnnU_Country,cnnAdDE_UVal;function CNN_getCookies(){var d,c,b,a;d=[];if(document.cookie){c=document.cookie.split("; ");for(b=0;b<c.length;b+=1){a=c[b].split("=");d[a[0]]=unescape(a[1])||null;}}return d;}function CNN_parseCookieData(a){var d,e,b,c;d={};e=a.split("&");for(b=0;b<e.length;b+=1){c=e[b].split(":");d[c[0]]=c[1]||null;}return d;}adHeadOffset=0;adHeadClass="us.low";allCookies=new CNN_getCookies();adHeadCookie=allCookies.hasOwnProperty("Target")?allCookies.Target:null;isClassAndOffsetValid=false;alreadySwappedTargetImage=false;alreadySwappedCookieCrumb=false;if(adHeadCookie){adHeadHash=new CNN_parseCookieData(adHeadCookie);if(adHeadHash.o&&adHeadHash["class"]){validClassesAndOffsets=["us.low",0,"us.high",1,"intl",2,"intl",3,"us.edu",0,"us.gov",0,"us.mil",0,"us.org",0];for(i=0;i<validClassesAndOffsets.length;i+=2){if(validClassesAndOffsets[i]===adHeadHash["class"]&&validClassesAndOffsets[i+1]===adHeadHash.o){isClassAndOffsetValid=true;break;}}}if(isClassAndOffsetValid){adHeadOffset=adHeadHash.o;adHeadClass=adHeadHash["class"];}}function getCookieCrumb(b){var a;a=allCookies.CNNid;if(!alreadySwappedCookieCrumb&&!("G"===a&&a.charAt(0))){b.src="http://cnn.dyn.cnn.com/cookie.crumb";alreadySwappedCookieCrumb=true;}}document.adoffset=adHeadOffset;function getAdHeadCookie(b){var a;a="http://cnn.dyn.cnn.com/1.gif?"+new Date().getTime();if(!alreadySwappedTargetImage&&!isClassAndOffsetValid&&("undefined"!==typeof WM_browserAcceptsCookies)&&(new WM_browserAcceptsCookies())){b.src=a;alreadySwappedTargetImage=true;}}alreadySwappedDETargetImage=false;cnnDEadDEonCookie=false;cnnU_Country="";cnnAdDE_UVal="R00";function WM_readCookie(b){var d,c,a,e;if(""===document.cookie){return false;}else{a=document.cookie;d=a.indexOf(b);e=d+b.length;if((-1!==d)&&"="===(a.charAt(e))){d+=b.length+1;c=a.indexOf(";",d);if(-1===c){c=a.length;}return unescape(a.substring(d,c));}else{return false;}}}function getDEAdHeadCookie(b){var a;cnnDEadDEonCookie=allCookies.adDEon;a="http://gdyn.cnn.com/1.1/1.gif?"+new Date().getTime();if(!alreadySwappedDETargetImage&&!cnnDEadDEonCookie){b.src=a;alreadySwappedDETargetImage=true;}}var AIS_VERSION="ais.cnn.2";var cnnad_transactionID=null;function cnnad_getTransactionID(){if(cnnad_transactionID==null){cnnad_transactionID="";cnnad_transactionID=Math.round((new Date()).getTime()/1000)+""+Math.floor(Math.random()*9007199254740992);}return cnnad_transactionID;}function cnnad_readCookie(b){if(document.cookie==""){return null;}else{var a=document.cookie.split(";");var e=b+"=";for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length);}if(f.indexOf(e)==0){return f.substring(e.length,f.length);}}return null;}}function cnnad_haveCookie(b){return document.cookie&&(-1<document.cookie.indexOf("; "+b+"=")||document.cookie.indexOf(b+"=")==0);}function cnnad_ugsync(){if(!cnnad_haveCookie("ugs")){document.write("<scr"+'ipt src="http://www.ugdt'+'urner.com/xd.sjs"></scr'+"ipt>");}}cnnad_getTransactionID();cnnad_ugsync();window.Krux||((Krux=function(){Krux.q.push(arguments);}).q=[]);(function(){var b=document.createElement("script");b.type="text/javascript";b.async=true;var a,d=(a=location.href.match(/\bkxsrc=([^&]+)/))&&decodeURIComponent(a[1]);b.src=/^https?:\/\/([^\/]+\.)?krxd\.net(:\d{1,5})?\//i.test(d)?d:d==="disable"?"":(location.protocol==="https:"?"https:":"http:")+"//cdn.krxd.net/controltag?confid=ITb_4eqO";var c=document.getElementsByTagName("script")[0];c.parentNode.insertBefore(b,c);}());window.Krux||((Krux=function(){Krux.q.push(arguments);}).q=[]);window.kvs=[];(function getKruxData(){function b(e){var c,d="kx"+e;if(window.localStorage){return window.localStorage[d]||"";}else{if(navigator.cookieEnabled){c=document.cookie.match(d+"=([^;]*)");return(c&&unescape(c[1]))||"";}else{return"";}}}Krux.user=b("user");Krux.segments=b("segs")&&b("segs").split(",")||[];for(var a=0;a<Krux.segments.length;a++){if(kvs.length<20){kvs.push(Krux.segments[a]);}}})();function krux_getDESegments(){var a="&kxid=";if(Krux.user){a+=Krux.user;}a+="&kxseg="+kvs.join(",");return a;}function krux_getFWSegments(){return"kxseg="+kvs.join(",kxseg=");}var cnnad_tileID=cnnad_getID();var cnnad_enabled=true;var cnnad_adIframes=new Array();var cnnad_adVault=new Array();var cnnad_adCache=new Array();var cnnad_interstitialPID=null;var cnnad_interstitialPlaying=false;var alreadySwappedDETargetImage=false;var cnnDEadDEonCookie=false;var cnnDocDomain=cnnad_getTld(location.hostname);if(cnnDocDomain){document.domain=cnnDocDomain;}var cnnad_pageMode=1;var cnnad_calledURLs=new Array();var cnnad_successfulSend=0;var cnnad_resultArray=new Array();var cnnad_ADMSizes=new Array();cnnad_ADMSizes=["728x90","300x250","336x280","160x600","336x850","300x600"];function cnnad_setADMSizes(a){cnnad_ADMSizes=a;}function cnnad_parseReferrer(b){if(!b){return null;}var c=b.substring(0,b.indexOf("/",7));if(c.indexOf(":",5)>0){c=c.substring(0,b.indexOf(":",5));}c=c.substring(c.lastIndexOf("/")+1);var a=c.split(".");
return(a[a.length-2]+"."+a[a.length-1]);}function cnnad_sendADMData(){var g="";for(as=0;as<cnnad_ADMSizes.length;as++){var c=cnnad_calledURLs[cnnad_ADMSizes[as]];if(c&&cnnad_successfulSend==0){if(cnnad_pageMode!=3){g+="<scr"+"ipt> \n ";if(cnnad_pageMode==1){g+='	A09801.DM_cat("';var b=cnnad_getParamValue(c,"site=","&");var d=cnnad_getParamValue(c,"_rollup=","&");var f=cnnad_getParamValue(c,"_section=","&");var e=cnnad_getParamValue(c,"_subsection=","&");var a=cnnad_parseReferrer(document.referrer);g+=b;if((b!="")&&((d!="")||(f!="")||(e!=""))){g+=" > ";}g+=d;if((d!="")&&((f!="")||(e!=""))){g+=" > ";}g+=f;if((f!="")&&(e!="")){g+=" > ";}g+=e;g+='"); \n ';if(a){g+=' A09801.DM_addEncToLoc("refer", "'+a+'"); \n ';}else{g+=" A09801.DM_addEncToLoc(); \n ";}}g+="	A09801.DM_tag(); \n ";g+="</scr"+"ipt> \n ";document.write(g);}cnnad_successfulSend=1;break;}}}function cnnad_getParamValue(e,f,c){if(e.match(f)){var a=e.indexOf(f)+f.length;var b=e.indexOf(c,a);var d=e.substring(a,b);return d;}else{return"";}}var cnnad_adTileIDGroup=new Array();var cnnad_newTileIDIteration=0;var cnnad_tileExemptions=new Array();function cnnad_addExemptCriteria(){var a=cnnad_tileExemptions.length;if(arguments.length%2!=0){return;}cnnad_tileExemptions[a]=new Array();for(var b=0;b<arguments.length;b+=2){cnnad_tileExemptions[a][arguments[b]]=arguments[b+1];}}function cnnad_checkTileExempt(c){var a;for(var b=0;b<cnnad_tileExemptions.length;b++){a=true;for(adKey in cnnad_tileExemptions[b]){adValue=cnnad_getParamValue(c,adKey+"=","&");if(cnnad_tileExemptions[b][adKey]!=adValue){a=false;break;}}if(a){return true;}}return false;}function cnnad_newTileIDGroup(c){var b=(cnnad_tileID*1+4*(++cnnad_newTileIDIteration));for(var a=0;a<c.length;a++){cnnad_adTileIDGroup[cnnad_adTileIDGroup.length]={tileID:b,adName:c[a]};}}function cnnad_getDynamicTileID(c){var b=cnnad_tileID;if(cnnad_checkTileExempt(c)){return b;}if(cnnad_adTileIDGroup.length>0){var e;if(c.match("_position=")){e=cnnad_getParamValue(c,"_position=","&");}else{if(c.match("_pos=")){e=cnnad_getParamValue(c,"_pos=","&");}else{e="";}}for(var a=0;a<cnnad_adTileIDGroup.length;a++){var d=cnnad_adTileIDGroup[a].adName;if(e==d){b=cnnad_adTileIDGroup[a].tileID;break;}}}return b;}function cnnad_debug(a){if(typeof(console)!="undefined"&&typeof(console.debug)!="undefined"){console.debug(a);}}function cnnad_error(a){if(typeof(console)!="undefined"&&typeof(console.error)!="undefined"){console.error(a);}}function cnnad_reverseString(b){b=""+b;var a="";if(b.length){var c;for(c=b.length;c>0;c--){a+=b.charAt(c-1);}}return(a);}function cnnad_getID(){return(cnnad_reverseString(new Date().getTime()));}function cnnad_renderAd(b,c){b=cnnad_preview(b);b=cnnad_statusCodeQA(b);try{b+=krux_getDESegments();}catch(a){b+="&kxid=&kxseg=";}b=b+"&tile="+cnnad_getDynamicTileID(b)+"&transactionID="+cnnad_getTransactionID();if(typeof c!=="undefined"){b=b+"&domId="+c;}if(cnnad_enabled==true){document.write('<script type="text/javascript" src="'+b+'"></scr'+"ipt>");}}function cnnad_preview(b){if(location.host.indexOf("turner.com")>-1){b=b.replace(new RegExp("ads..*?.com","gi"),"ads.turner.com");b=b.replace(new RegExp("ads..*?.tv","gi"),"ads.turner.com");}var a=cnnad_readCookie("ug");if(a){b=b+"&Params.User.UserID="+a;}else{b=b+"&Params.User.UserID=";}return b;}function cnnad_getTransactionID(){if(typeof cnnad_transactionID==="undefined"||cnnad_transactionID==null){cnnad_transactionID=Math.round((new Date()).getTime()/1000)+""+Math.floor(Math.random()*9007199254740992);}return cnnad_transactionID;}function cnnad_isBlocking(b){var a=false;if(document.getElementById("ad-"+b)!=null&&document.getElementById("ad-"+b).style.display==="none"){a=true;}else{if(cnnad_interstitialPlaying===true){a=true;}}return a;}function cnnad_createIframe(c,b){var a=document.createElement("iframe");a.id=c;a.name=c;a.width=0;a.height=0;a.style.position="absolute";a.style.top="-20px";a.style.left="-20px";a.marginWidth=0;a.marginHeight=0;a.frameBorder=0;a.scrolling="no";a.allowTransparency="true";a.src=b;return a;}function cnnad_createAdHelper(a,e,c,b,f){if(cnnad_isBlocking(a)){window.setTimeout(function(){cnnad_createAdHelper(a,e,c,b,f);},1000);}else{var g=document.getElementById("ad-"+a);if(g){g.appendChild(cnnad_createIframe(a,e));}else{if(!f){document.write('<iframe ALLOWTRANSPARENCY="true" hspace="0" vspace="0" marginHeight="0" marginWidth="0" src="'+e+'" border="0" frameBorder="0" height="0" width="0" scrolling="no"  id="'+a+'" style="position: absolute; top: -20px; left: -20px;" ></iframe>');}else{document.getElementById(f).innerHTML='<iframe ALLOWTRANSPARENCY="true" hspace="0" vspace="0" marginHeight="0" marginWidth="0" src="'+e+'" border="0" frameBorder="0" height="0" width="0" scrolling="no"  id="'+a+'" style="position: absolute; top: -20px; left: -20px;" ></iframe>';}}}}function cnnad_createAdNoTileId(a,d,c,b,e){d=cnnad_preview(d);d=cnnad_statusCodeQA(d);d+="&transactionID="+cnnad_getTransactionID();d+="&domId="+a;cnnad_createAdHelper(a,d,c,b,e,false);}var ads_register=[];function cnnad_createAd(b,f,e,d,g){try{if(SKIP_AD_CREATION!=="undefined"&&SKIP_AD_CREATION==true){return;}}catch(c){}f=cnnad_preview(f);f=cnnad_statusCodeQA(f);f+="&transactionID="+cnnad_getTransactionID();f+="&tile="+cnnad_getDynamicTileID(f)+"&domId="+b;try{f+=krux_getDESegments();}catch(c){f+="&kxid=&kxseg=";}cnnad_createAdHelper(b,f,e,d,g,false);var a=new String();if(f.match("_position=")){a=cnnad_getParamValue(f,"_position=","_");}else{if(f.match("_pos=")){a=cnnad_getParamValue(f,"_pos=","_");}else{a="";}}cnnad_calledURLs[a]=f;var h="ad-"+b;ads_register.push(h);}function repaint_ads(){var a=navigator.userAgent.match(/Firefox\/(.*)$/);if(a&&a.length>1){var b=a[1]*1;if(b>=17){console.log("repainting...");for(ea in ads_register){el=document.getElementById(ads_register[ea]);if(el){console.log(ads_register[ea]);el.style.display="none";el.offsetHeight;el.style.display="block";}}}}}if(window.addEventListener){window.addEventListener("load",repaint_ads,false);}function cnnad_writeAd(b,a){if(cnnad_enabled==true){document.write('<script id="'+b+'" type="text/javascript" onload="cnnSendData();"');document.write(' src="'+a+"&tile="+cnnad_getDynamicTileID(a)+'"></scr');document.write("ipt>");}}function cnnad_showAd(a){var b=document.getElementById(a);if(b){b.style.position="relative";b.style.left="0px";b.style.top="0px";if(b.style.visibility==="hidden"){b.style.visibility="visible";}if(b.style.display==="none"){b.style.display="block";}}else{cnnad_error("Could not find element by id: "+a);}}function cnnad_setAdSize(c,a,d){var b=document.getElementById(c);if(b){b.height=a;b.width=d;b.className+=" adunit_"+d+"x"+a;}else{cnnad_error("Could not find element by id: "+cnnad_id);}}function cnnad_readCookie(b){if(document.cookie==""){return null;}else{var a=document.cookie.split(";");var e=b+"=";for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length);}if(f.indexOf(e)==0){return f.substring(e.length,f.length);}}return null;}}function cnnad_getTld(a){var b=a.split(".");if(b.length>=2){return(b[b.length-2]+"."+b[b.length-1]);}return(null);}function cnnad_refreshAds(){if(!cnnad_adIframes){return;}for(var b=0;b<cnnad_adIframes.length;b++){var a=cnnad_adIframes[b];if(document.getElementById(a)){var e=document.getElementById(a);var d="&pageload=ref";if(e.width>0&&e.height>0){var c=e.contentWindow.document.location.href;if(c.indexOf(d)>=0){e.contentWindow.location.reload();}else{e.contentWindow.location.href=c+d;}}}}setTimeout("cnnad_refreshAds();",60*1000*8);}function cnnad_swapAd(g,b){var d=document.getElementById(g);if(d){d.width=0;d.height=0;d.style.display="none";if(cnnad_adCache[b]){for(var c=0;c<window.frames.length;c++){try{if(window.frames[c].location.href.indexOf("domId="+g)>-1){window.frames[c].location.replace(cnnad_adCache[b]);}}catch(f){}}return;}if((typeof Ajax!="undefined")&&(typeof Ajax.Request!="undefined")){var a=new Ajax.Request(b,{method:"get",onSuccess:function(l){var k=cnnad_parseResponse(l.responseText,g);
k=cnnad_preview(k);k=cnnad_statusCodeQA(k);k+="&transactionID="+cnnad_getTransactionID();if(k){cnnad_adCache[b]=k;for(var h=0;h<window.frames.length;h++){try{if(window.frames[h].location.href.indexOf("domId="+g)>-1){window.frames[h].location.replace(k);}}catch(m){}}return;}}});}else{if(typeof dojo!="undefined"){if(typeof dojo.io=="undefined"){dojo.require("dojo.io.*");}dojo.io.bind({url:b,load:function(k,l,e){var h=cnnad_parseResponse(l,g);h=cnnad_preview(h);h=cnnad_statusCodeQA(h);h+="&transactionID="+cnnad_getTransactionID();if(h){cnnad_adCache[b]=h;d.src=h;}}});}else{}}}}function cnnad_parseResponse(e,g){var b="<!-- CALLOUT|";var c="|CALLOUT -->";var f=e.indexOf(b);var a=e.indexOf(c);var d=null;if(f>=0&&a>f){d=e.substring(f+b.length,a);}if(d){return(d+"&tile="+cnnad_getDynamicTileID(d)+"&domId="+g);}else{return null;}}function cnnad_findAd(f,e,a){var b=null;for(var c=0;c<cnnad_adVault.length;c++){var d=cnnad_adVault[c];if(d.getType()==f&&d.getHeight()==a&&d.getWidth()==e){b=d.getUrl();break;}}return b;}function cnnad_getDEAdHeadCookie(b){if(typeof(cnnad_readCookie)!="undefined"){cnnDEadDEonCookie=cnnad_readCookie("adDEon");}var a="http://gdyn."+cnnad_getTld(location.hostname)+"/1.1/1.gif?"+new Date().getTime();if(!alreadySwappedDETargetImage&&!cnnDEadDEonCookie){b.src=a;alreadySwappedDETargetImage=true;}}function cnnad_registerAd(e,d,a,b){var c=new cnnad_AdObject(null,d,a,e,b);cnnad_adVault[cnnad_adVault.length]=c;}function cnnad_registerSpace(d,c,a){var b=new cnnad_AdObject(d,c,a,null,null);cnnad_adIframes[cnnad_adIframes.length]=b;}function cnnad_endInterstitial(c){var b=document.getElementById("interstitial"+c);if(b&&b.parentNode){b.parentNode.removeChild(b);}var d=document.getElementById("interstitialcss"+c);if(d&&d.parentNode){d.parentNode.removeChild(d);}if(typeof(document.createStyleSheet)!="undefined"){var a=document.createStyleSheet();a.addRule("table","{display:inline}");}cnnad_interstitialPlaying=false;}function cnnad_startInterstitial(a,d,e){cnnad_interstitialPlaying=true;var c=d+"&tile="+cnnad_getDynamicTileID(d)+"&transactionId="+cnnad_getTransactionID();try{c+=krux_getDESegments();}catch(b){c+="&kxid=&kxseg=";}c+="&domId="+a;document.write('<div id="interstitial'+a+'" class="interstitial" align="center"><iframe ALLOWTRANSPARENCY="true" hspace="0" vspace="0" marginHeight="0" marginWidth="0" src="'+c+'" border="0" frameBorder="0" height="0" width="0" scrolling="no" id="'+a+'"></iframe></div>');if(!e){e=1500;}cnnad_interstitialPID=window.setTimeout('cnnad_endInterstitial("'+a+'");',e);}function cnnad_resetInterstitial(a,c){cnnad_interstitialPlaying=true;var b=document.getElementById(a);if(null!=b&&b.height>20&&b.width>20){if(cnnad_interstitialPID){window.clearTimeout(cnnad_interstitialPID);}if(!c){c=15000;}cnnad_interstitialPID=window.setTimeout('cnnad_endInterstitial("'+a+'");',c);}}function cnnad_getUrlParam(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+b+"=([^&#]*)";var d=new RegExp(a);var c=d.exec(window.location.href);if(c==null){return"";}else{return c[1];}}function cnnad_statusCodeQA(b){var a=cnnad_getUrlParam("adsqa");if(a){b=b+"&"+a.replace("%3D","=");}return b;}function cnnad_updateIframeSource(b,a){a=cnnad_preview(a);a=cnnad_statusCodeQA(a);a+="&transactionID="+cnnad_getTransactionID();document.getElementById(b).contentWindow.location.replace(a+"&tile="+cnnad_tileID+"&domId="+b);}function cnnad_showAdByKey(a,b){cnnad_swapAd(b,cnnad_adUrls[a]);}function cnnad_haveCookie(a){return document.cookie&&(-1<document.cookie.indexOf("; "+a+"=")||document.cookie.indexOf(a+"=")==0);}function cnnad_ugsync(){if(!cnnad_haveCookie("ug")){document.write("<scr"+'ipt src="http://www.ugdt'+'urner.com/xd.sjs"></scr'+"ipt>");}else{if(!cnnad_haveCookie("ugs")){document.write("<scr"+'ipt src="http://www.ugdt'+'urner.com/xd.sjs"></scr'+"ipt>");}}}function cnnad_AdObject(e,d,a,c,b){this.id=e;this.width=d;this.height=a;this.type=c;this.url=b;this.getId=function(){return this.id;};this.setId=function(f){this.id=f;};this.getWidth=function(){return this.width;};this.setWidth=function(f){this.width=f;};this.getHeight=function(){return this.height;};this.setHeight=function(f){this.height=f;};this.getType=function(){return this.type;};this.setType=function(f){this.type=f;};this.getUrl=function(){return this.url;};this.setUrl=function(f){this.url=f;};this.toString=function(){return"[AD|ID="+this.id+"|WIDTH="+this.width+"|HEIGHT="+this.height+"]";};}function refreshAdsByDivId(n,o){var a=document.getElementsByTagName("div");for(var e=0;e<a.length;e++){var b=a[e].id;if(b.indexOf(n)>=0){if(a[e].parentNode){var m=a[e].parentNode;var f=m.innerHTML;var h="&amp;tile=";var k=f.indexOf(h);if(k>0){var l=f.indexOf("&amp;",k+h.length);var g=parseInt(f.substring(k+h.length,l));var d=g+o;var h="tile="+g;var c="tile="+d;f=f.replace(h,c);}m.innerHTML=f;}}}}var fwLib={version:1,loadComplete:false,currentSwapIndex:0,fwJSLibsLoaded:function(){return true;},flIntegration:{testFn:function(){alert("FL Integration");},getElementsByClass:function(a,m,e){var b=(m=="*"&&a.all)?a.all:a.getElementsByTagName(m);var l=new Array();var n=new Array();if(typeof e=="object"){for(var f=0;f<e.length;f++){n.push(new RegExp("(^|\\s)"+e[f].replace(/\-/g,"\\-")+"(\\s|$)"));}}else{n.push(new RegExp("(^|\\s)"+e.replace(/\-/g,"\\-")+"(\\s|$)"));}var g;var h;for(var d=0;d<b.length;d++){g=b[d];h=true;for(var c=0;c<n.length;c++){if(!n[c].test(g.className)){h=false;break;}}if(h){l.push(g);}}return l;},findPageSlots:function(){var c=new Array();var e="";var a=this.getElementsByClass(document,"span","_fwph");for(var d=0;d<a.length;++d){e=a[d].getAttribute("id");c.push(e);var b=document.getElementById("_fw_input_"+e);c.push(b.getAttribute("value"));}return c;},savedSlots:[],replacePageSlotInnerHtml:function(innerHTML,safeId,saveOrigin){var parentContainer=document.getElementById(safeId);var originalContainer=document.getElementById("_fw_container_"+safeId);var adContainer=document.createElement("span");var isIE=navigator.appVersion.match(/\bMSIE\b/);if(document.getElementById("_fw_container_"+safeId+"_new_"+fwLib.currentSwapIndex)){this.restorePageSlot(safeId);}var newSpanId="_fw_container_"+safeId;if(saveOrigin){newSpanId+="_new_"+fwLib.currentSwapIndex;}var attrs=originalContainer.attributes;for(var i=0;i<attrs.length;i++){var name=attrs[i].name||attrs[i].nodeName;var value=attrs[i].value||attrs[i].nodeValue;if(isIE&&(!name||value==="null"||value==="false"||!value)){continue;}if(name=="id"){value=newSpanId;}adContainer.setAttribute(name,value);}if(isIE){for(var i in originalContainer.style){try{if(i=="content"){continue;}adContainer.style[i]=originalContainer.style[i];}catch(e){}}}if(saveOrigin){originalContainer.style.display="none";parentContainer.appendChild(adContainer);}else{originalContainer.parentNode.replaceChild(adContainer,originalContainer);}adContainer.innerHTML=innerHTML;var fw_js=document.getElementById("_fw_container_js_"+safeId);if(fw_js){eval(fw_js.innerHTML);}},restorePageSlot:function(a){if(!a||!document.getElementById("_fw_container_"+a+"_new_"+fwLib.currentSwapIndex)){return;}var c=document.getElementById("_fw_container_"+a+"_new_"+fwLib.currentSwapIndex++);document.getElementById(a).removeChild(c);var b=document.getElementById("_fw_container_"+a);b.style.display="inline";},clearSavedPageSlots:function(){for(var a in fwLib.flIntegration.savedSlots){fwLib.flIntegration.savedSlots[a]=null;}},isPageLoaded:function(){return fwLib.loadComplete;},onLoadComplete:function(){fwLib.loadComplete=true;},addLoadEvent:function(a){var b=window.onload;if(typeof window.onload!="function"){window.onload=a;}else{window.onload=function(){if(b){b();}a();};}}}};fwLib.flIntegration.addLoadEvent(fwLib.flIntegration.onLoadComplete);var MainLocalObj={data:{weatherLoc:{locCode:"",zip:"",name:"",city:"",state:""},sports:{},stockSymbols:[],prevStockSymbols:[],maxSymbols:3},init:function(e){this.internationalUser=(location.hostname.indexOf("edition.")>-1)?true:false;this.isProfilePage=false;this.isUSPage=false;
this.isPoliticsPage=false;this.useAccordions=false;this.allCookies=allCookies;if(typeof e!=="undefined"){this.disableSymbolLookup=e;}else{this.disableSymbolLookup=false;}if(this.allCookies["last5stocks"]!=null){var a={};var b=this.allCookies["last5stocks"].split("+");for(var f=0;f<b.length;f++){a[b[f]]=b[f];}var d=0;for(var c in a){this.data.stockSymbols.push(a[c]);if((++d)>=this.data.maxSymbols){break;}}this.data.stockSymbols.reverse();}MainLocalObj.expDate=new Date(1640926800000);this.msUrl="http://audience.cnn.com/services/cnn/user.api";this.StorageManagerInstance=StorageManager.getInstance();this.localDataKey=this.allCookies.CNNid+"localData2010";var g=[];var h=this.StorageManagerInstance.availableStores;h.each(function(k){if(k.name!=="IEStorage"){g.push(k);}});this.StorageManagerInstance.availableStores=g;this.StorageManager=this.StorageManagerInstance.getStorage();this.StorageManager.load();if(location.hostname.indexOf("cnn.com")>0){document.domain="cnn.com";}if(location.hostname.indexOf("turner.com")>0){document.domain="turner.com";}this.CSIManager=CSIManager.getInstance();this.loadDefaultData();},initMod:function(){MainLocalObj.Markets.init();MainLocalObj.Weather.init();},setUserSpecificData:function(a){this.data.userSpecificData=a;},setInternationalUser:function(a){this.internationalUser=a;},setLocationZip:function(b,a){this.data.weatherLoc.zip=a;},setLocationName:function(b,a){this.data.weatherLoc.name=a;},setLocationLocCode:function(a,b){if(a=="weather"){this.data.weatherLoc.locCode=b;}},setLocationCity:function(a,b){this.data.weatherLoc.city=b;},setLocationState:function(a,b){this.data.weatherLoc.state=b;},parseMSData:function(a){if(typeof a.status!=="undefined"&&a.status==="success"&&a.data!==""){this.data=a.data.evalJSON(true);this.data.lastMemberServicesFetch=new Date().getTime();this.StorageManager.put(this.localDataKey,this.data,MainLocalObj.expDate);this.StorageManager.save();}else{if(a.data==""){this.loadDefaultData(true);}else{this.data=this.storedData;}}this.saveWeatherCookie();this.initMod();},parseWeatherCookie:function(){var c=this.allCookies["lwp.weather"]||null;var d=false;var e=false;if(c){var b=unescape(c).split("|");var f=b[0];if(c.indexOf("~")==-1){f=c.replace("|","~");}var a=b[0].split("~");return a;}else{return[false,false];}},loadDefaultData:function(h){if(typeof h==="undefined"){h=false;}this.storedData=false;var a=this.parseWeatherCookie();var f=a[0];var e=a[1];if(ms_isLoggedIn()&&!h){if(this.StorageManager.contains(this.localDataKey)){this.storedData=this.StorageManager.get(this.localDataKey);}function g(l){if(l===null||typeof l==="undefined"||(new Date().getTime()-l)>1800000){return true;}else{return false;}}if(g(this.storedData.lastMemberServicesFetch)){var b={params:{name:"teams"},onSuccess:function(l){MainLocalObj.parseMSData(l.responseJSON);}};Member.getData(b);}else{if(this.storedData){this.data=this.storedData;this.initMod();this.saveWeatherCookie();}}this.data.userSpecificData=true;}else{if(e){if(this.checkZip(e)){this.data.userSpecificData=true;this.setLocationZip("all",e);this.setLocationLocCode("all",f);}else{this.Weather.requestInternationalCityLookup(e,f,"all");}this.initMod();}else{if(!this.internationalUser){var k=[{name:"Atlanta, GA",zip:"30303"}];var c=Math.floor(Math.random()*k.length);var d=k[c];this.setLocationZip("all",d.zip);this.setLocationName("all",d.name);this.initMod();}else{if(this.internationalUser){this.setLocationZip("all","336736767676");this.setLocationName("all","London, England");this.initMod();}else{this.initMod();}}}}},saveWeatherCookie:function(){var c=this.allCookies["lwp.weather"]||null;var d="";if(this.data){d=this.data.weatherLoc.locCode+"~"+this.data.weatherLoc.zip;}var f;var b="";if(c){var a=unescape(c).split("|");a.unshift(d);for(var e=0;e<a.length;e++){if(a[e]!==d&&(b.indexOf(a[e])===-1)||e===0){b+=a[e];if(e<(a.length-1)){b+="|";}}}}else{b=d;}CNN_setCookie("lwp.weather",b,24*30*12,"/",document.domain);},saveData:function(a){var d;var b;if(typeof a==="undefined"){a=false;}this.saveWeatherCookie();if(typeof cnnWeather==="object"&&a!==true){cnnWeather.init();}if(ms_isLoggedIn()){this.StorageManager.put(this.localDataKey,this.data,MainLocalObj.expDate);this.StorageManager.save();var c={params:{"action":"setData","name":"teams","data":Object.toJSON(this.data)},onSuccess:function(e){}};Member.setData(c);}},monitorMSSave:function(a){if(typeof a.status!=="undefined"&&a.status==="success"){msQueueManager.requestReceived();}},trimWS:function(a){a=a.replace(/,/g," ");a=a.replace(/^\s*(\S+)*\s*$/,"$1");a=a.replace(/(\s{1})\s*/g,"$1");return a;},urlEncode:function(a){a=this.trimWS(a);a=a.replace(/st\./i,"saint");a=a.replace(/mt\./i,"mount");a=escape(a);return a;},ucwords:function(a){return(a+"").replace(/^(.)|\s(.)/g,function(b){return b.toUpperCase();});},truncateString:function(b,a){if(b.length>=a){b=b.substring(0,a);b=b.replace(/\s+$/,"");b=b+"&hellip;";}return b;},daysInMonth:function(c,b){var a=new Date(b,c,0);return a.getDate();},urlDecode:function(a){return unescape(a);},checkZip:function(b){b=this.trimWS(b.toString());var a=((b.match(/^\d{5}$/)!==null||b.match(/^\d{12}$/)!==null)&&b!="00000"?true:false);return a;}};MainLocalObj.Weather={omnitureStr:"jsmd.trackMetrics('dynamic-impressions',cnn_outsideindata,'cnn-impressions');",weatherURL:(location.hostname.indexOf("ref")>0)?"http://teg8fref1.cnn.com/weather/getForecast":"http://svcs.cnn.com/weather/getForecast",init:function(){this.defaultMsg="Enter a U.S. Zip or Intl city";if(typeof MainLocalObj.Weather.isInitialized==="undefined"){MainLocalObj.Weather.requestLocalAll();}MainLocalObj.Weather.isInitialized=true;},inputFocus:function(a){if(a.value===MainLocalObj.Weather.defaultMsg){a.value="";}a.removeClassName("pmWeatherHollow");},inputBlur:function(a){if(a.value===""){a.value=MainLocalObj.Weather.defaultMsg;a.addClassName("pmWeatherHollow");}},requestLocalAll:function(){var a=MainLocalObj.data;MainLocalObj.Weather.displayElements();MainLocalObj.Weather.requestLocalWeather(a);if(!MainLocalObj.internationalUser){MainLocalObj.Weather.requestLocalNews(a);}},localUpdateData:function(a,c,d,b){MainLocalObj.setLocationZip(b,c);MainLocalObj.setLocationName(b,a);MainLocalObj.setLocationLocCode(b,d);MainLocalObj.setUserSpecificData(true);MainLocalObj.saveData();MainLocalObj.Weather.requestLocalAll();},requestLocalWeather:function(c){var a="mode=json_html&zipCode="+c.weatherLoc.zip;if(c.weatherLoc.locCode){a+="&locCode="+c.weatherLoc.locCode;}if(MainLocalObj.internationalUser&&MainLocalObj.allCookies["default.temp.units"]==="true"){a+="&celcius=true";}var b={url:MainLocalObj.Weather.weatherURL,args:a,domId:false,funcObj:MainLocalObj.Weather.updateLocalWeather,breakCache:true};MainLocalObj.CSIManager.callObject(b,"requestLocalWeather_");},requestLocalNews:function(e){if(MainLocalObj.checkZip(e.weatherLoc.zip)){var d;var f;if(MainLocalObj.isProfilePage||MainLocalObj.isUSPage){d=4;f=2;}else{d=3;f=1;}var c=(!MainLocalObj.isPoliticsPage)?"http://local.cnn.com/oi/v1.0/publications/1094/zipcodes/"+e.weatherLoc.zip+"/stories.cnnhtml":"http://local.cnn.com/oi/v1.1/zipcodes/"+e.weatherLoc.zip+"/publications/1094/stories.cnnhtml";var a=(!MainLocalObj.isPoliticsPage)?"limit="+d+"&min="+d+"&min_pref="+f+"&max_age=3d&max_pref_age=3d&dev_key=wxctrr8nme2pjzpt2dpf89p5":"limit="+d+"&min="+d+"&max_age=2d&dev_key=wxctrr8nme2pjzpt2dpf89p5&keyword=Democrat&keyword=Republican&keyword=Governor&keyword=Senate&keyword=Congress&keyword=Rep&keyword=Dem&keyword=politics";var b={url:c,args:a,domId:false,funcObj:MainLocalObj.Weather.updateLocalNews,breakCache:true};MainLocalObj.CSIManager.callObject(b,"requestLocalNews");}},displayElements:function(a){if(typeof a==="undefined"){a=false;}switch(a){case"changeLoc":if($("cnnGetLocalBox")){$("cnnGetLocalBox").show();}if($("changeLocLink")){$("changeLocLink").hide();}if($("pmLocResultsContainer")){$("pmLocResultsContainer").hide();}if(!MainLocalObj.internationalUser){}if($("weatherLoc")){MainLocalObj.Weather.inputBlur($("weatherLoc"));}break;
case"intlChangeLoc":if($("cnnGetLocalBox")){$("cnnGetLocalBox").show();}if($("changeLocLink")){$("changeLocLink").hide();}if($("pmLocResultsContainer")){$("pmLocResultsContainer").hide();}if($("pmWeatherTom")){$("pmWeatherTom").hide();}if($("weatherLoc")){MainLocalObj.Weather.inputBlur($("weatherLoc"));}break;case"displayResults":if($("cnnGetLocalBox")){$("cnnGetLocalBox").show();}if($("changeLocLink")){$("changeLocLink").hide();}if($("pmLocResultsContainer")){$("pmLocResultsContainer").show();}break;default:if(!MainLocalObj.data.userSpecificData){MainLocalObj.Weather.displayElements("changeLoc");}else{if(MainLocalObj.data.userSpecificData){if($("cnnGetLocalBox")){$("cnnGetLocalBox").hide();}if($("pmLocResultsContainer")){$("pmLocResultsContainer").hide();}if($("changeLocLink")){$("changeLocLink").show();}if($("pmWeatherTom")){$("pmWeatherTom").show();}if(!MainLocalObj.internationalUser){}else{if($("curConditionsWeatherDay")){$("curConditionsWeatherDay").show();}}}}break;}},updateLocalWeather:function(l){if(!l[0].invalid){var e="http://weather.cnn.com/weather/";if(MainLocalObj.internationalUser){e="http://weather.edition.cnn.com/weather/intl/";}e+="forecast.jsp?zipCode="+MainLocalObj.data.weatherLoc.zip;if(MainLocalObj.data.weatherLoc.locCode){e+="&locCode="+MainLocalObj.data.weatherLoc.locCode;}var h=MainLocalObj.data.weatherLoc.name;var f="";var o="";var c="";if(MainLocalObj.internationalUser){var b="intlChangeLoc";}else{var b="changeLoc";}var n=(MainLocalObj.internationalUser||MainLocalObj.allCookies["default.temp.units"]=="true"?"C":"F");if(l.length>-1){h=l[0].location.city;if(l[0].location.stateOrCountry){h+=", "+l[0].location.stateOrCountry;}}for(var a=0;a<l.length;a++){if(l[a]&&l[a].forecast&&l[a].forecast.days){if(l[a].forecast.days.length>-1){var p=l[a].forecast.days[0];var d=l[a].currentConditions;if(d.valid==false){d.temperature="--";}var h=l[0].location.city;if(l[0].location.stateOrCountry){h+=", "+l[0].location.stateOrCountry;}f+='<p id="pmSelectedWeather">'+"	<span>"+h+'</span><span id="changeLocLink">';if(MainLocalObj.data.userSpecificData){f+=' <span style="color: #999;">&nbsp;(</span><a id="pmEditWeatherLoc" href="javascript:MainLocalObj.Weather.displayElements(\''+b+'\')">Edit location</a><span style="color: #999;">)</span>';}f+="</span></p>";var m="";if(d.temperature.length>2){m=' style="font-size: 24px;"';}var g="";if(d.feelsLikeTemperature.length>2){g=' style="font-size: 9px;"';}var s='			<span id="pmCurrTempNum">'+d.temperature+"</span>&deg;";if(d.temperature_S=="N/A"){s='			<span id="pmCurrTempNum"><span style="font-size: 50%;">N/A</span></span>';}var r='			Feels like&nbsp;<span id="pmFeelTemp">'+d.feelsLikeTemperature+"</span>&deg;";if(d.feelsLikeTemperature_S=="N/A"||d.feelsLikeTemperature_S==""){r="";}if(!MainLocalObj.isProfilePage||MainLocalObj.internationalUser){var q=(typeof(d.shortDescription)=="undefined")?d.description:d.shortDescription;f+='<div class="pmWrapper">'+'	<p id="curConditionsWeatherDay" class="weatherDay">Current conditions</p>'+'	<div id="pmWeatherIcon">'+'		<a href="'+e+'"><img class="cnn_ie6png" src="http://i.cdn.turner.com/cnn/.e/img/3.0/weather/03/'+d.icon+".png"+'" alt="your weather"></a>'+"	</div>"+'	<div id="pmCurrentWeather">'+'		<div id="pmCurrTemp"'+m+">"+s+"		</div>"+"	</div>"+'	<div id="pmWeatherDetails">'+'		<p id="pmWeatherDesc">'+q+"		</p>"+'		<p id="pmWeatherHiLo">'+'			Hi&nbsp;<span id="pmHiTemp">'+p.high+'</span>&deg;&nbsp;&nbsp;<span style="color: #999; font-size: 10px;">|</span>&nbsp;&nbsp;Lo&nbsp;<span id="pmLoTemp">'+p.low+"</span>&deg;"+"		</p>"+"	</div>"+'	<div id="pmMoreWeather">'+'		<a id="pm10DayBtn" href="'+e+'">&nbsp;</a>'+"		<p"+g+">";if(d.valid!=false){f+=r;}f+="		</p>"+"	</div>"+"</div>";c+='<div class="cnn_ftrwthr1"><a href="'+e+'">'+'<img class="cnn_ie6png" src="http://i.cdn.turner.com/cnn/.e/img/3.0/weather/03/'+d.icon+'.png" alt="your weather" width="54" height="47" border="0"></a></div>';c+='<div class="cnn_ftrwthr2"><div class="cnn_ftrwthr3">'+s+'</div><div class="cnn_ftrwthr4">'+"<div>HI "+p.high+'&deg;<span style="padding-left:7px">LO '+p.low+"&deg;</span></div>"+'<div style="clear:left; line-height: 13px"><span style="padding-right:6px"><strong>'+h+'</strong></span><a href="'+e+'">Weather forecast</a></div></div></div></div>';}}if(l[a].forecast.days.length>0&&MainLocalObj.internationalUser&&MainLocalObj.data.userSpecificData){var k=l[a].forecast.days[1];o+='<p class="weatherDay">Tomorrow</p>'+'<div class="pmWrapper">'+'	<div id="pmWeatherIcon">'+'		<img class="cnn_ie6png" src="http://i.cdn.turner.com/cnn/.e/img/3.0/weather/03/'+k.icon.replace(/gif/,"png")+'" alt="your weather">'+"	</div>"+'	<div id="pmCurrentWeather">'+"	</div>"+'	<div id="pmWeatherDetails">'+'		<p id="pmWeatherDesc">'+k.description+"</p>"+'		<p id="pmWeatherHiLo">'+'			Hi&nbsp;<span id="pmHiTemp">'+k.high+'</span>&deg;&nbsp;&nbsp;<span style="color: #999; font-size: 10px;">|</span>&nbsp;&nbsp;Lo&nbsp;<span id="pmLoTemp">'+k.low+"</span>&deg;"+"		</p>"+"	</div>"+"</div>";$("pmWeatherTom").update(o);$("pmWeatherTom").show();}}}if($("cnn_hppsnlhdrwthr")!==null){$("cnn_hppsnlhdrwthr").show();}if($("pmWeatherTab")!==null){$("pmWeatherTab").update(f);$("pmWeatherTab").show();}if($("pmWeatherFooter")!==null){$("pmWeatherFooter").update(c);$("pmWeatherFooter").show();}}else{MainLocalObj.Weather.displayElements("changeLoc");}return f;},updateLocalNews:function(a){MainLocalObj.Weather.displayElements();return"";},requestInternationalCityLookup:function(c,e,b){var a="mode=json_html&zipCode="+c;if(e){a+="&locCode="+e;}if(MainLocalObj.internationalUser){a+="&celcius=true";}var d={url:MainLocalObj.Weather.weatherURL,args:a,domId:false,funcObj:MainLocalObj.Weather.updateInternationalCityData,breakCache:true};MainLocalObj.CSIManager.callObject(d,"requestInternationalCityLookup");},updateInternationalCityData:function(e,d){var a="";var c="";var b="";if(e&&(e.length>-1)&&e[0].location&&e[0].location.city){a=e[0].location.locCode;b=e[0].location.city;if(e[0].location.stateOrCountry){b+=", "+e[0].location.stateOrCountry;}c=e[0].location.zip;}if(c&&b){MainLocalObj.setLocationZip(d,c);MainLocalObj.setLocationName(d,b);MainLocalObj.setLocationLocCode(d,a);MainLocalObj.setUserSpecificData(true);MainLocalObj.Weather.requestLocalAll();}},checkInput:function(f,d){d=d.replace(/<[^>]*?>/g,"");var e=d.toUpperCase();var b="http://weather.cnn.com/weather/citySearch";var a="search_term="+MainLocalObj.urlEncode(e)+"&mode=json_html&filter=true";var c={url:b,args:a,domId:MainLocalObj.urlEncode(f+"|"+d),funcObj:MainLocalObj.Weather.updateValidationData,breakCache:true};MainLocalObj.CSIManager.callObject(c,"checkInput");},updateValidationData:function(m,c){var b=MainLocalObj.urlDecode(c).split("|");var g=MainLocalObj.trimWS(b[1]);var q=" "+g.toUpperCase()+" ";var d="";if(m.length>1){var k=m.length;var n=false;var s=true;var p=[];if(k>50){k=50;}for(var l=0;l<k;l++){var o=m[l].city+", "+m[l].stateOrCountry;var a=m[l].zip.toString();var e=m[l].locCode;var r={};var f=" "+MainLocalObj.trimWS(o.toUpperCase())+" ";if((MainLocalObj.checkZip(g)&&g==a)||(q==f)){r.zip=a;r.locCode=e;r.name=o;p.push(r);s=false;n=r;l=k;}else{if(f.indexOf(q)!=-1){r.zip=a;r.locCode=e;r.name=o;p.push(r);s=false;}}}if(s){MainLocalObj.Weather.displayNoMatch(b[0],g);}else{if(p.length==1||n){if(!n){n=p[0];}d={};d.name=n.city+", "+n.stateOrCountry;d.zip=n.zip.toString();d.locCode=n.locCode;MainLocalObj.Weather.localUpdateData(d.name,d.zip,d.locCode,b[0]);MainLocalObj.Weather.displayElements(b[0]);}else{MainLocalObj.Weather.displayMultipleMatches(p,MainLocalObj.urlDecode(b[1]),b[0]);}}}else{if((m.length==1)&&(m[0]&&m[0].locCode&&m[0].locCode!="")){var h=m[0];d={};d.name=h.city+", "+h.stateOrCountry;d.zip=h.zip.toString();d.locCode=h.locCode;MainLocalObj.Weather.localUpdateData(d.name,d.zip,d.locCode,b[0]);MainLocalObj.Weather.displayElements(b[0]);}else{MainLocalObj.Weather.displayNoMatch(b[0],g);}}return"";},displayMultipleMatches:function(e,g,l){var f=[];var k=[];var h=[];
e.each(function(m){if(m.zip.length>5){h.push(m);}else{k.push(m);}});f=h.concat(k);var c=$F("weatherLoc");var b="pmLocResultsContainer";var a='<p id="pmWeatherResultMeta">We Found '+f.length+' Results for &quot;<span id="resultLoc">'+g+"</span>&quot;</p>";a+='<ul id="pmWeatherResult">';for(var d=0;d<f.length;d++){a+='<li><a href="javascript:void(0)" onclick="MainLocalObj.Weather.resetSearch(\''+l+"');"+"MainLocalObj.Weather.localUpdateData('"+f[d].name+"','"+f[d].zip+"','"+f[d].locCode+"','"+l+'\');"><span class="pmHLBullet">&bull;</span>'+f[d].name+"</a></li>";}a+="</ul>";MainLocalObj.Weather.displayElements("displayResults");Element.update(b,a);},displayNoMatch:function(b,d){var a="pmLocResultsContainer";var c='<p id="pmWeatherResultMeta">We didn\'t find results  for &quot;<span id="resultLoc">'+d+"</span>&quot;</p>"+'<ul id="pmWeatherResult">'+'	<li><span class="pmHLBullet">&bull;</span><span>Check the spelling of your city name</span></li>'+'	<li><span class="pmHLBullet">&bull;</span><span>Make sure the U.S. ZIP code is accurate</span></li>'+'	<li><span class="pmHLBullet">&bull;</span><span>Use USPS for U.S. ZIP codes / city name</span></li>'+"</ul>";MainLocalObj.Weather.displayElements("displayResults");Element.update(a,c);},resetSearch:function(b){var c="weatherLoc";var a="pmLocResultsContainer";Element.update(a,"");$(c).value=MainLocalObj.Weather.defaultMsg;}};MainLocalObj.Markets={redirectSymbol:false,init:function(){var b;this.defaultMsg="Enter Symbol";this.errorMsg="No match. Please enter a new symbol.";if(MainLocalObj.internationalUser){b="/cnnintl_adspaces/3.0/homepage/spon.88x31_worldbiz.ad";}if(b){new Ajax.Updater("moneySponsor",b,{method:"get",evalScripts:true});}var c=null;if($("pmMarkets")!==null){MainLocalObj.Markets.togBtns=$("pmMarkets").select("a.toggle");c=MainLocalObj.allCookies["pm.markets.lastIndex"]||null;if(c!==null&&$(c)){if(c==="myQuotesBtn"&&!ms_isLoggedIn()){var c="defIndexBtn";}MainLocalObj.Markets.setActiveIndex($(c),MainLocalObj.Markets.togBtns);}MainLocalObj.Markets.togBtns.each(function(d){d.observe("click",function(){MainLocalObj.Markets.setActiveIndex(d,MainLocalObj.Markets.togBtns);});});}if(!MainLocalObj.internationalUser&&$("searchQuote")!==null){var a=$("searchQuote");a.addClassName("pmWeatherHollow");a.value="Enter Symbol";if(!MainLocalObj.disableSymbolLookup){MainLocalObj.Markets.symbLookup=new AutoComplete("searchQuote","http://markets.money.cnn.com/services/cnndotcom/lookup.asp");}}if($("pmMarkets")!==null){$("pmMarkets").show();}if($("cnn_personalloading")!==null){$("cnn_personalloading").hide();}MainLocalObj.Markets.isInitialized=true;},setActiveIndex:function(b,a){if(b.id=="myQuotesBtn"){MainLocalObj.Markets.fetchStockQuotes();}a.each(function(c){var d;if(c.id==="myQuotesBtn"){d="pmMyQuotes";}else{if(c.id==="defIndexBtn"){d="pmDefaultIndecies";}else{d=c.id.replace("Btn","");}}if(c.id===b.id){c.removeClassName("togOff").addClassName("togOn");$(d).removeClassName("pmOff").addClassName("pmOn");CNN_setCookie("pm.markets.lastIndex",b.id,24*30*12,"/",document.domain);}else{c.removeClassName("togOn").addClassName("togOff");$(d).removeClassName("pmOn").addClassName("pmOff");}});MainLocalObj.data.prevStockSymbols=MainLocalObj.data.stockSymbols.slice();if($("searchQuote")){if($("searchQuote").hasClassName("errorColor")){$("searchQuote").removeClassName("errorColor");}$("searchQuote").value="";}if(!MainLocalObj.internationalUser){MainLocalObj.Markets.inputBlur($("searchQuote"));}},lookupStockSymbol:function(){var b=$F("searchQuote");if(b===MainLocalObj.Markets.defaultMsg){MainLocalObj.Markets.inputBlur($("searchQuote"));}else{if(b!==""){this.redirectSymbol=true;var a=[];MainLocalObj.Markets.setActiveIndex($("myQuotesBtn"),MainLocalObj.Markets.togBtns);b=b.replace(/[^a-zA-Z 0-9]+/g,"");b=b.toUpperCase();if(MainLocalObj.data.stockSymbols.indexOf(b)!="-1"){a=MainLocalObj.data.stockSymbols.without(b);}else{a=MainLocalObj.data.stockSymbols.slice();}a.push(b);a.reverse();a=a.slice(0,3);a.reverse();MainLocalObj.Markets.fetchStockQuotes(a);}}},fetchStockQuotes:function(a){var c;if(typeof a==="undefined"){a=false;}if(!MainLocalObj.Markets.redirectSymbol&&$("pmMyQuotes")!==null){$("pmMyQuotes").update("");}if($("searchQuote")){$("searchQuote").blur();}if(a){c=a.join();}else{if(typeof MainLocalObj.data.stockSymbols==="object"&&MainLocalObj.data.stockSymbols.length>0){c=MainLocalObj.data.stockSymbols.join();}else{MainLocalObj.data.stockSymbols=[];c="";}}if(c.length>0){var b={url:"http://markets.money.cnn.com/services/cnndotcom/quote.asp",args:"symbols="+c.replace(/,/g,"|")+"&domains=cnn.com|turner.com",domId:false,funcObj:MainLocalObj.Markets.parseQuotes,breakCache:true};MainLocalObj.CSIManager.callObject(b,"requestMyQuotes");}else{MainLocalObj.Markets.inputBlur($("searchQuote"));}},parseQuotes:function(e){var l,g;var d=[];var a=false;var m=$("searchQuote");var h=e.quotes.quote;if(!MainLocalObj.Markets.redirectSymbol){$("pmMyQuotes").update("<ul></ul>");}var o=$("pmMyQuotes").select("ul")[0];var f=new Template(' 			<li class="market-#{index}"> 			    <div class="marketInfo-left"> <!-- left side --> 			        <span class="marketName"><a href="http://money.cnn.com/quote/quote.html?symb=#{symbol}">#{symbol}</a></span>&nbsp;&nbsp; 			        <span class="marketIndex">#{last}</span> 			        <a class="removeSymbLookup" href="javascript:MainLocalObj.Markets.removeQuote(#{index})" title="Remove">Remove</a> 			    </div> 			    <div class="marketNums-right #{plusMinClass}"> 			        <div class="percentDiff"> 			            <span>(<span class="plusMinus">#{plusMin}</span>#{changePct} &#37;)</span> 			        </div> 			        <div class="numDiff"> 			            <span><span class="plusMinus">#{plusMin}</span>#{change}</span> 			        </div> 			    </div> 			</li> 		');function c(t,s){var q=t.toString();var u=q.indexOf(".");if(u==-1){decimalPartLength=0;q+=s>0?".":"";}else{decimalPartLength=q.length-u-1;}var p=s-decimalPartLength;if(p>0){for(var r=1;r<=p;r++){q+="0";}}return q;}function k(p){var q=Math.round(p*100)/100;q=c(q,2);q=q.replace("-","");return q;}function b(p){var q={};if(p.change.indexOf("-")>-1){q.plusMin="-";q.plusMinClass="down";}else{if(parseInt(p.last)===0){q.plusMin="";q.plusMinClass="";}else{q.plusMin="+";q.plusMinClass="up";}}return q;}if(MainLocalObj.Markets.redirectSymbol){if(h[h.length-1].status!=="-1"){location.href="http://money.cnn.com/quote/quote.html?symb="+h[h.length-1].cnnSymbol;return;}}for(var n in h){if(typeof(h[n].change)=="undefined"){continue;}if(h[n].status==="-1"||h[n].cnnSymbol==="undefined"){a=true;}else{if(!MainLocalObj.Markets.redirectSymbol){g=b(h[n]);l=f.evaluate({index:(parseInt(n)+1),symbol:h[n].cnnSymbol,last:k(h[n].last),changePct:k(h[n].changePct),change:k(h[n].change),plusMin:g.plusMin,plusMinClass:g.plusMinClass});o.insert({top:l});d.push(h[n].cnnSymbol);}}}if(a){m.addClassName("errorColor");m.value=MainLocalObj.Markets.errorMsg;MainLocalObj.Markets.redirectSymbol=false;MainLocalObj.Markets.fetchStockQuotes(MainLocalObj.data.prevStockSymbols);}else{MainLocalObj.data.stockSymbols=d;MainLocalObj.saveData(true);}MainLocalObj.Markets.symbLookup.hide();MainLocalObj.Markets.symbLookup.stopLookup=true;MainLocalObj.Markets.fixBorders();},inputFocus:function(a){if(a.value===MainLocalObj.Markets.defaultMsg||a.value===MainLocalObj.Markets.errorMsg){if(a.hasClassName("errorColor")){a.removeClassName("errorColor");}a.value="";}a.removeClassName("pmWeatherHollow");},inputBlur:function(a){if(a!==null&&a.value===""){a.value=MainLocalObj.Markets.defaultMsg;a.addClassName("pmWeatherHollow");}},fixBorders:function(){var a=$("pmMyQuotes").select("li");if(a.length){a[a.length-1].addClassName("last");}},removeQuote:function(a){var b=$("pmMyQuotes").select("li.market-"+a)[0];b.remove();MainLocalObj.Markets.fixBorders();MainLocalObj.data.stockSymbols=MainLocalObj.data.stockSymbols.without(MainLocalObj.data.stockSymbols[a-1]);MainLocalObj.saveData();}};var AutoComplete=Class.create({selector:null,input:null,_timeout:null,visible:false,drawn:false,_hideTimeout:null,options:null,stopLookup:false,initialize:function(a,c,b){this.action=c;
this.input=$(a);this.input.autocomplete="off";this.options=new AutoComplete.Options(b||{});this.selector=document.createElement("select");Event.observe(this.input,"focus",this._onInputFocus.bindAsEventListener(this));Event.observe(this.input,"keydown",this._onInputKeyDown.bindAsEventListener(this));Event.observe(this.input,"blur",this._onInputBlur.bindAsEventListener(this));Event.observe(this.selector,"blur",this._onSelectorBlur.bindAsEventListener(this));Event.observe(this.selector,"focus",this._onSelectorFocus.bindAsEventListener(this));Event.observe(this.selector,"change",this._onSelectorChange.bindAsEventListener(this));Event.observe(window,"resize",this._reposition.bind(this));Event.observe(window,"scroll",this._reposition.bind(this));},_onInputFocus:function(a){this._onSelectorFocus(a);MainLocalObj.Markets.inputFocus(this.input);},_onSelectorBlur:function(a){this._onInputBlur(a);},_onInputBlur:function(a){this._hideTimeout=setTimeout(this._checkOnBlur.bind(this),100);},_checkOnBlur:function(){this._hideTimeout=null;this.hide();},_onInputKeyUp:function(a){this._suggest(a)&&Event.stop(a);},_onInputKeyDown:function(a){this._suggest(a)&&Event.stop(a);},_onSelectorFocus:function(a){if(this._hideTimeout){clearTimeout(this._hideTimeout);this._hideTimeout=null;}},_onSelectorChange:function(a){this.select();},draw:function(){if(this.drawn){return;}if(this.options.cssClass){this.selector.className=this.options.cssClass;}Element.setStyle(this.selector,{display:"none",position:"absolute"});this.selector.size=this.options.size;document.body.appendChild(this.selector);this.input.autocomplete="off";this.drawn=true;},hide:function(){if(!this.drawn||!this.visible){return;}this.visible=false;if(window.Scriptaculous){new Effect.BlindUp(this.selector,{duration:this.options.delay,queue:"end",afterFinish:function(a){Element.setStyle(this.selector,{display:"none"});this.selector.options.length=0;setTimeout(this._restoreFocus.bind(this),50);}.bind(this)});}else{Element.setStyle(this.selector,{display:"none"});this.selector.options.length=0;setTimeout(this._restoreFocus.bind(this),50);}},_restoreFocus:function(){this.input.focus();},show:function(){if(!this.drawn){this.draw();}var a=null;if(this.selector.options.length){if(window.Scriptaculous){new Effect.BlindDown(this.selector,{duration:this.options.delay,queue:"end"});}else{Element.setStyle(this.selector,{display:"inline"});}this._reposition();this.visible=true;}},_cancelTimeout:function(){if(this._timeout){clearTimeout(this._timeout);this._timeout=null;}},_suggest:function(c){this._cancelTimeout();var b=Event.keyPressed(c);var a=[20,16,17,91,121,122,123,124,125,126,127,128,129,130,131,132,45,36,35,33,34,144,145,44,19,93,];if(a.indexOf(b)>-1){return false;}switch(b){case Event.KEY_LEFT:case Event.KEY_RIGHT:return false;break;case Event.KEY_TAB:case Event.KEY_BACKSPACE:case 46:this.cancel();return false;break;case Event.KEY_RETURN:if(this.visible&&this.selector.selectedIndex!="-1"){this.select();return true;}else{return false;}break;case Event.KEY_ESC:this.cancel();return true;break;case Event.KEY_UP:case Event.KEY_DOWN:this._interact(c);return true;break;default:break;}if(this.input.value.length>=this.options.threshold-1){this._timeout=setTimeout(this._sendRequest.bind(this),1000*this.options.delay);}return false;},_sendRequest:function(){var a={url:this.action,args:"symbol="+this.input.value+"&domains=cnn.com|turner.com",domId:false,funcObj:this._process.bind(this),breakCache:true};MainLocalObj.CSIManager.callObject(a);},_reposition:function(){if(!this.drawn){return;}var a=Position.cumulativeOffset(this.input);a.push(a[0]+this.input.offsetWidth);a.push(a[1]+this.input.offsetHeight);Element.setStyle(this.selector,{left:a[0]+"px",top:a[3]+"px"});},_getPadding:function(a){var c="";var d=8-a;for(var b=0;b<d;b++){c+="\xa0";}return c;},_process:function(d){if(this.stopLookup){this.hide();this.cancel();this.stopLookup=false;return;}this.selector.options.length=0;var c;var b;for(var a in d.data){for(var e in d.data[a]){if(typeof(d.data[a][e].s)!="undefined"){c=d.data[a][e].s;b=c+this._getPadding(c.length)+d.data[a][e].n;this._addOption(b,c);}}}if(this.selector.options.length>(this.options.size)){this.selector.size=this.options.size;}else{this.selector.size=this.selector.options.length>1?this.selector.options.length:2;}if(this.selector.options.length){this.selector.selectedIndex=-1;this.show();}else{this.cancel();}},_addOption:function(a,c){var b=new Option(a,c);Prototype.Browser.IE?this.selector.add(b):this.selector.add(b,null);},cancel:function(){this.hide();},select:function(){if(this.selector.options.length){this.input.value=this.selector.options[this.selector.selectedIndex].value;MainLocalObj.Markets.lookupStockSymbol();}this.cancel();if(typeof this.options.onSelect=="function"){this.options["onSelect"](this.input);}},_interact:function(b){if(!this.visible){return;}var a=Event.keyPressed(b);if(a!=Event.KEY_UP&&a!=Event.KEY_DOWN){return;}var c=this.selector.options.length;if(a==Event.KEY_UP){if(this.selector.selectedIndex==0){this.selector.selectedIndex=this.selector.options.length-1;}else{this.selector.selectedIndex--;}}else{if(this.selector.selectedIndex==this.selector.options.length-1){this.selector.selectedIndex=0;}else{this.selector.selectedIndex++;}}}});AutoComplete.Options=Class.create({size:3,cssClass:"symbolLookup",onSelect:null,threshold:1,delay:0.15,requestMethod:"GET",initialize:function(a){Object.extend(this,a||{});}});Object.extend(Event,{KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,KEY_SHIFT:16,KEY_CONTROL:17,KEY_CAPSLOCK:20,KEY_SPACE:32,keyPressed:function(a){return Prototype.Browser.IE?window.event.keyCode:a.which;}});var CNNHMPAGE={"pmod":{"cnntv":{"tmo":null,"tmintvl":5000,"ready":0,"h_pos":0,"slidecnt":0,"slideintvl":214,"prev":function(){if(CNNHMPAGE.pmod.cnntv.tmo){clearTimeout(CNNHMPAGE.pmod.cnntv.tmo);}CNNHMPAGE.pmod.cnntv.slide((CNNHMPAGE.pmod.cnntv.h_pos+CNNHMPAGE.pmod.cnntv.slideintvl));},"next":function(){if(CNNHMPAGE.pmod.cnntv.tmo){clearTimeout(CNNHMPAGE.pmod.cnntv.tmo);}CNNHMPAGE.pmod.cnntv.slide((CNNHMPAGE.pmod.cnntv.h_pos-CNNHMPAGE.pmod.cnntv.slideintvl));},"auto":function(){if(CNNHMPAGE.pmod.cnntv.h_pos<=(-1*(CNNHMPAGE.pmod.cnntv.slidecnt-1)*CNNHMPAGE.pmod.cnntv.slideintvl)){clearTimeout(CNNHMPAGE.pmod.cnntv.tmo);}else{CNNHMPAGE.pmod.cnntv.slide((CNNHMPAGE.pmod.cnntv.h_pos-CNNHMPAGE.pmod.cnntv.slideintvl));CNNHMPAGE.pmod.cnntv.tmo=setTimeout(CNNHMPAGE.pmod.cnntv.auto,CNNHMPAGE.pmod.cnntv.tmintvl);}},"slide":function(a){$j("#cnn_pmtvmodslidecntnt").animate({"left":a+"px"});CNNHMPAGE.pmod.cnntv.h_pos=a;CNNHMPAGE.pmod.cnntv.enblbtns();},"enblbtns":function(){if(CNNHMPAGE.pmod.cnntv.slidecnt>=1){if(CNNHMPAGE.pmod.cnntv.h_pos===0){$j("#cnn_pmtvmodnlft").unbind("click").addClass("cnn_pmtvmodnavoff");}else{$j("#cnn_pmtvmodnlft").unbind("click");$j("#cnn_pmtvmodnlft").click(function(){CNNHMPAGE.pmod.cnntv.prev();});$j("#cnn_pmtvmodnlft").removeClass("cnn_pmtvmodnavoff");}if(CNNHMPAGE.pmod.cnntv.h_pos<=(-1*(CNNHMPAGE.pmod.cnntv.slidecnt-1)*CNNHMPAGE.pmod.cnntv.slideintvl)){$j("#cnn_pmtvmodnrgt").unbind("click").addClass("cnn_pmtvmodnavoff");}else{$j("#cnn_pmtvmodnrgt").unbind("click");$j("#cnn_pmtvmodnrgt").click(function(){CNNHMPAGE.pmod.cnntv.next();});$j("#cnn_pmtvmodnrgt").removeClass("cnn_pmtvmodnavoff");}}},"init":function(a){CNNHMPAGE.pmod.cnntv.tmintvl=a;$j(".cnn_pmtvmodslide").each(function(b){CNNHMPAGE.pmod.cnntv.slidecnt+=1;});$j("#cnn_pmtvmodslidecntnt").css({"width":(CNNHMPAGE.pmod.cnntv.slidecnt*CNNHMPAGE.pmod.cnntv.slideintvl)+"px"});CNNHMPAGE.pmod.cnntv.enblbtns();CNNHMPAGE.pmod.cnntv.ready=1;if(CNNHMPAGE.pmod.cnntv.slidecnt>1){CNNHMPAGE.pmod.cnntv.tmo=setTimeout(CNNHMPAGE.pmod.cnntv.auto,CNNHMPAGE.pmod.cnntv.tmintvl);}$j("#cnn_pmtvmodcntr").removeClass("cnn_pmtvmoddisabled");}}}};window.Modernizr=function(ab,aa,Z){function F(b){T.cssText=b;}function E(d,c){return F(Q.join(d+";")+(c||""));}function D(d,c){return typeof d===c;
}function C(d,c){return !!~(""+d).indexOf(c);}function B(g,c,l){for(var k in g){var h=c[g[k]];if(h!==Z){return l===!1?g[k]:D(h,"function")?h.bind(l||c):h;}}return !1;}var Y="2.6.2",X={},W=aa.documentElement,V="modernizr",U=aa.createElement(V),T=U.style,S,R={}.toString,Q=" -webkit- -moz- -o- -ms- ".split(" "),P={},O={},N={},M=[],K=M.slice,J,I=function(v,u,t,s){var r,q,p,o,g=aa.createElement("div"),f=aa.body,b=f||aa.createElement("body");if(parseInt(t,10)){while(t--){p=aa.createElement("div"),p.id=s?s[t]:V+(t+1),g.appendChild(p);}}return r=["&#173;",'<style id="s',V,'">',v,"</style>"].join(""),g.id=V,(f?g:b).innerHTML+=r,b.appendChild(g),f||(b.style.background="",b.style.overflow="hidden",o=W.style.overflow,W.style.overflow="hidden",W.appendChild(b)),q=u(g,v),f?g.parentNode.removeChild(g):(b.parentNode.removeChild(b),W.style.overflow=o),!!q;},H={}.hasOwnProperty,G;!D(H,"undefined")&&!D(H.call,"undefined")?G=function(d,c){return H.call(d,c);}:G=function(d,c){return c in d&&D(d.constructor.prototype[c],"undefined");},Function.prototype.bind||(Function.prototype.bind=function(a){var h=this;if(typeof h!="function"){throw new TypeError;}var g=K.call(arguments,1),f=function(){if(this instanceof f){var b=function(){};b.prototype=h.prototype;var d=new b,c=h.apply(d,g.concat(K.call(arguments)));return Object(c)===c?c:d;}return h.apply(a,g.concat(K.call(arguments)));};return f;}),P.touch=function(){var a;return"ontouchstart" in ab||ab.DocumentTouch&&aa instanceof DocumentTouch?a=!0:I(["@media (",Q.join("touch-enabled),("),V,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(b){a=b.offsetTop===9;}),a;};for(var L in P){G(P,L)&&(J=L.toLowerCase(),X[J]=P[L](),M.push((X[J]?"":"no-")+J));}return X.addTest=function(e,c){if(typeof e=="object"){for(var f in e){G(e,f)&&X.addTest(f,e[f]);}}else{e=e.toLowerCase();if(X[e]!==Z){return X;}c=typeof c=="function"?c():c,typeof enableClasses!="undefined"&&enableClasses&&(W.className+=" "+(c?"":"no-")+e),X[e]=c;}return X;},F(""),U=S=null,X._version=Y,X._prefixes=Q,X.testStyles=I,X;}(this,this.document);var cnn_awsmbrtriggeranimation=function(a){var c={"position":"end","scope":a.id},d,b=$(a.id+"_content");if(a.hasClassName("cnn_animation_lock")){return;}a.addClassName("cnn_animation_lock");if(a.hasClassName("cnn_awsmbr_expanded")){a.removeClassName("cnn_awsmbr_expanded");Effect.multiple(a.select(".cnn_column").reverse(),Effect.Move,{"duration":0.4,"y":115,"mode":"relative","queue":c});d=new Effect.Parallel([new Effect.Morph(a.select(".cnn_short_headlines")[0],{"sync":true,"style":"left:0px;","queue":c}),new Effect.Morph(b,{"sync":true,"style":"height:1px;","queue":c})],{"delay":0.8,"afterFinish":function(){a.removeClassName("cnn_animation_lock");}});}else{d=new Effect.Parallel([new Effect.Morph(b,{"sync":true,"style":"height:105px;","queue":c}),new Effect.Morph(a.select(".cnn_short_headlines")[0],{"sync":true,"style":"left:-770px;","queue":c})],{});Effect.multiple(a.select(".cnn_column"),Effect.Move,{"duration":0.4,"delay":0.2,"y":-115,"mode":"relative","queue":c,"afterFinish":function(f){if(f.element.hasClassName("cnn_last_column")){a.removeClassName("cnn_animation_lock");}}});a.addClassName("cnn_awsmbr_expanded");}};var cnn_trunctextinelements=function(a,c){var d=$$(a),b;for(b in d){if(d.hasOwnProperty(b)){if(d[b].innerHTML.length>(c+1)){d[b].innerHTML=d[b].innerHTML.substring(0,c)+"&hellip;";}}}};var cnn_setupawesomebar=function(g,d){var b=$(g),c,f,e,a=$(g+"_content");if(null===b||!b.hasClassName("cnn_awsmbr")){return;}if(b.hasClassName("cnn_awsmbr_expanded")){b.removeClassName("cnn_awsmbr_expanded");}cnn_trunctextinelements(".cnn_short_headlines a",35);b.select(".cnn_controls",".cnn_more").each(function(h){h.observe("click",function(k){k.stop();c=h.up(".cnn_awsmbr");cnn_awsmbrtriggeranimation(c);});});Effect.Appear(b);if("expanded"===d){cnn_awsmbrtriggeranimation(b);}else{f=new Effect.Morph(b.select(".cnn_short_headlines")[0],{"style":"left:0px;","transition":Effect.Transitions.full});e=new Effect.Morph(a,{"style":"height:1px;"});}};Event.observe(window,"load",function(){var a=new Ajax.Request("/.element/ssi/www/breaking_news/3.0/banner.html",{"method":"get","onSuccess":function(b){var c=(b&&b.responseText&&b.responseText.indexOf('id="jsCode"')!==-1)?"collapsed":"expanded";cnn_setupawesomebar("cnn_awsmbr_1",c);}});});var cnn_imgflipper={"t_int":6000,"tmout":{},"data":{},"prev":function(a){clearTimeout(cnn_imgflipper.tmout["time_"+a]);if(cnn_imgflipper.data["flipper_"+a].curr>0){cnn_imgflipper.load(a,cnn_imgflipper.data["flipper_"+a].curr-1,"prev");}else{cnn_imgflipper.load(a,(cnn_imgflipper.data["flipper_"+a].n_imgs-1),"prev");}cnn_imgflipper.tmout["time_"+a]=setTimeout(function(){cnn_imgflipper.auto(a);},cnn_imgflipper.t_int);},"next":function(a){clearTimeout(cnn_imgflipper.tmout["time_"+a]);if((cnn_imgflipper.data["flipper_"+a].curr+1)<cnn_imgflipper.data["flipper_"+a].n_imgs){cnn_imgflipper.load(a,cnn_imgflipper.data["flipper_"+a].curr+1,"next");}else{cnn_imgflipper.load(a,0,"next");}cnn_imgflipper.tmout["time_"+a]=setTimeout(function(){cnn_imgflipper.auto(a);},cnn_imgflipper.t_int);},"auto":function(a){if(cnn_imgflipper.data["flipper_"+a].auto){if((cnn_imgflipper.data["flipper_"+a].curr+1)<cnn_imgflipper.data["flipper_"+a].n_imgs){cnn_imgflipper.load(a,cnn_imgflipper.data["flipper_"+a].curr+1,"next");}else{cnn_imgflipper.load(a,0,"next");}}cnn_imgflipper.tmout["time_"+a]=setTimeout(function(){cnn_imgflipper.auto(a);},cnn_imgflipper.t_int);},"load":function(d,c,b){var a=cnn_imgflipper.data["flipper_"+d];jQuery("#cnn_imgflipper-"+d).addClass("c_imgflipper-thinking");if(a.img_data[c].loaded){jQuery("#cnn_imgflipper-"+d).removeClass("c_imgflipper-thinking");cnn_imgflipper.show(d,c,b);}else{cnn_imgflipper.data["flipper_"+d].auto=0;jQuery("#c_imgflipper-img-"+c).html('<img src="'+a.img_data[c].url+'" border="0" id="c_imgflipper-img-file-'+c+'">');jQuery("#c_imgflipper-img-file-"+c).one("load",function(){a.img_data[c].loaded=1;cnn_imgflipper.data["flipper_"+d]=a;cnn_imgflipper.data["flipper_"+d].auto=1;jQuery("#cnn_imgflipper-"+d).removeClass("c_imgflipper-thinking");cnn_imgflipper.show(d,c,b);});}},"show":function(e,c,b){var a=cnn_imgflipper.data["flipper_"+e],d=a.img_data[c],f=a.width;if(b==="prev"){f=-1*f;}jQuery("#c_imgflipper-img-"+c).hide();jQuery("#c_imgflipper-img-"+c).css({"left":(f+"px")});jQuery("#cnn_imgflipper-"+e+" .c_imgflipper-img").css({"z-index":"1"});jQuery("#c_imgflipper-img-"+a.curr).css({"z-index":"2"});jQuery("#c_imgflipper-img-"+c).css({"z-index":"3"});jQuery("#c_imgflipper-img-"+c).show();jQuery("#c_imgflipper-img-"+c).animate({"left":"0px"},{"duration":590,"queue":true,"compelete":function(){jQuery("#c_imgflipper-img-"+a.curr).hide();}});if(a.img_data[c].text){jQuery("#c_imgflipper-caption-"+e).html("<p><b>Photo "+(c+1)+" of "+a.n_imgs+":</b> "+a.img_data[c].text+"</p>");}else{jQuery("#c_imgflipper-caption-"+e).html("<p><b>Photo "+(c+1)+" of "+a.n_imgs+"</b>");}a.curr=c;cnn_imgflipper.data["flipper_"+e]=a;},"init":function(e,d,g,b){cnn_imgflipper.data["flipper_"+e]={};cnn_imgflipper.t_int=d;if(typeof b==="undefined"){var c=[],f=0,a={};jQuery("#cnn_imgflipper-"+e+" .c_imgflipper-img img").each(function(h){c.push({"url":jQuery(this).attr("src"),"text":jQuery(this).attr("alt"),"loaded":1});f=f+1;});jQuery("#cnn_imgflipper-"+e+" .c_imgflipper-img a").each(function(h){c.push({"url":jQuery(this).attr("href"),"text":jQuery(this).attr("title"),"loaded":0});f=f+1;});a.width=jQuery("#cnn_imgflipper-"+e).width();a.img_data=c;a.n_imgs=f;a.curr=0;a.auto=1;b=a;}cnn_imgflipper.data["flipper_"+e]=b;jQuery("#cnn_imgflipper-"+e).mouseover(function(){cnn_imgflipper.data["flipper_"+e].auto=0;});jQuery("#cnn_imgflipper-"+e).mouseout(function(){cnn_imgflipper.data["flipper_"+e].auto=1;});jQuery("#cnn_imgflipper-"+e).removeClass("c_imgflipper-loading");cnn_imgflipper.tmout["time_"+e]=setTimeout(function(){cnn_imgflipper.auto(e);},cnn_imgflipper.t_int);}};function cvpSearchTheClient(theObj,thePath){var index=thePath.indexOf("."),objName="",subPath="",childObj;
if(theObj===null){theObj=window;}if(index===-1){if(thePath.indexOf("(")!==-1&&thePath.indexOf(")")!==-1){return eval("theObj."+thePath);}else{return theObj[thePath];}}objName=thePath.substring(0,index);subPath=thePath.substring(index+1);childObj=theObj[objName];if(objName.indexOf("(")!==-1&&objName.indexOf(")")!==-1){childObj=eval("theObj."+objName);}if(childObj===null){return"";}if(subPath.length<1){return childObj.toString();}return cvpSearchTheClient(childObj,subPath);}window.cvpSearchTheClient=cvpSearchTheClient;(function(window,document,undefined){var CVP={};var CVPconstructor=function(options){return CVP.createPlayer(options);};if("CVP" in window){if(typeof window.console!=="undefined"&&typeof window.console.log==="function"){console.log("WARNING - window.CVP was already defined, adding/overriding functionality");}}var VERSION="2.7.8.8";var FLASH_VERSION="10.1.0.0";var HTML5="html5";var FLASH="flash";var SECURE=location.protocol==="https:";var CDN_PREFIX=SECURE?"https://s.cdn.turner.com":"http://z.cdn.turner.com";var MAPPING_PATH=CDN_PREFIX+"/xslo/cvp/config/{site}/";var MAPPING_FILE="mapping.xml";var OMNITURE_JS_URL="";var AD_MANAGER_URL=CDN_PREFIX+"/xslo/cvp/ads/freewheel/js/AdManager.js";var AD_DFP_URL="//www.google.com/uds/api/ima/1.7/9fd415db3bb953707e811e4827fe957b/default.IN.js";var EXPRESS_INSTALL_URL=CDN_PREFIX+"/xslo/cvp/assets/flash/expressInstall.swf";var LOG4JAVASCRIPT_URL=CDN_PREFIX+"/xslo/cvp/js/logging/log4javascript.js";var debugMatch=/\bdmtdebug=(\w+)/.exec([window.location.search,window.location.hash].join());var debugFlag=!!debugMatch;var _cvpInstallingLog4JS=false;var _cvpInstalledLog4JS=false;var _cvpsetup={site:"cvp",property:"cvp"};function createCallbackHandler(id){var funcName=id+"_callback_handler";if(typeof window[funcName]!=="undefined"){return false;}window[funcName]=function(){if(arguments.length&&arguments[0]=="_pluginRequest"){return CVP.PluginManager.onPluginHostRequest(id,slice(arguments,1));}return CVP.onCallback(id,arguments);};return true;}function validateFlashVersion(embedVersion){if(embedVersion===FLASH_VERSION){return embedVersion;}try{var configVersion=new Version(embedVersion);if(configVersion.gt(FLASH_VERSION)){return configVersion.toString();}}catch(e){log.warn("Failure to compare Flash versions",FLASH_VERSION,embedVersion);}return FLASH_VERSION;}function addBeforeUnLoadEvent(func){var oldfunc=window.onbeforeunload;if(typeof window.onbeforeunload!=="function"){window.onbeforeunload=func;}else{window.onbeforeunload=function(){if(oldfunc){oldfunc();}func();};}}var CVPObject=function(options){this.options=extend({id:"cvp_player",width:"320",height:"240",flashVars:{},playerType:FLASH,freewheelJsUrl:AD_MANAGER_URL,initialize:function(){}},options);var log=CVP.Log.getLogger(this.options.id);this.options.embed=extend({containerSwf:"",expressInstallSwf:EXPRESS_INSTALL_URL,flashVersion:FLASH_VERSION},this.options.embed);this.options.embed.options=extend({quality:"high",bgcolor:"#000000",allowFullScreen:"true",allowScriptAccess:"always"},this.options.embed.options);if(!this.options.embed.containerSwf){log.error("Invalid containerSwf...exiting");throw new Error("Invalid containerSwf");}this.options.initialize();var id=this.options.id;var width=this.options.width;var height=this.options.height;var flashVars=this.options.flashVars;var embed=this.options.embed;this._playerType=this.options.playerType;var player=null;if(this._playerType===HTML5||Browser.allowedHtmlPlayer){if(flashVars.site&&flashVars.profile){log.info("instantiating the HTML5 player");this._playerType=HTML5;player=new CVP.Players.HTML5(this.options);}else{log.info("invalid HTML5 params...instantiating null player");this._playerType=false;player=new CVP.Players.NullPlayer(this.options);}this.getDOMPlayer=function(){return player;};}else{log.info("instantiating the Flash player");this._playerType=FLASH;if(debugFlag&&!_cvpInstalledLog4JS&&!_cvpInstallingLog4JS&&empty(window.log4javascript)){log.info("installing log4javascript");_cvpInstallingLog4JS=true;(function(doc,tag,prop){var el=doc.createElement(tag),s1=doc.getElementsByTagName(tag)[0],readyRE=/^(complete|loaded)$/,done=false;el.onload=el.onreadystatechange=function(){if(!done&&!((prop in el)&&readyRE.test(el[prop]))){el.onload=el.onreadystatechange=null;done=true;log.info("installed log4javascript");_cvpInstalledLog4JS=true;}};el.src=LOG4JAVASCRIPT_URL;s1.parentNode.insertBefore(el,s1);}(document,"script","readyState"));}}if(CVP.findInstance(id)||byId(id)){log.error(id+" is already in use...exiting");throw new Error(id+" is already in use");}this.getId=function(){return id;};this.getWidth=function(){return width;};this.getHeight=function(){return height;};this.getFlashVars=function(){return flashVars;};this.getEmbed=function(){return embed;};this.getPlayerType=function(){return this._playerType;};if(!createCallbackHandler(id)){log.error('callback handler for id "'+id+'" could not be created...exiting');throw new Error('callback handler for id "'+id+'" could not be created...exiting');}this.callbacks={};delete this.options.initialize;var p,pfn;for(p in this.options){if(hasOwn(this.options,p)){pfn=this.options[p];if(isFunc(pfn)){this.callbacks[p]=pfn;}}}this.handleCallBack=function(){var ret=null;if(arguments.length){var funcName=arguments[0],args=Array.prototype.slice.call(arguments,1),fn;fn=this[funcName];if(isFunc(fn)){try{ret=fn.apply(this,args);}catch(internalCBException){log.warn("exception on internal CB "+funcName,internalCBException.message);}}fn=this.callbacks[funcName];if(isFunc(fn)){try{ret=fn.apply(this,args);}catch(userCBException){log.error("exception on user CB "+funcName,userCBException.message);}}}return ret;};var contentId=this.options.flashVars.contentId||"";var contentUrl=this.options.flashVars.contentUrl||"";var playlistId=this.options.flashVars.playlistId||"";var context=this.options.flashVars.context||"";var playerInstance=context;var contentWidth=0;var contentHeight=0;var duration=0;var playhead=0;var absolutePlayhead=-1;var buffering=false;var paused=false;var fullscreen=false;this.getDOMPlayerInstance=function(){return playerInstance;};this.getContentId=function(){return contentId;};this.getContentUrl=function(){return contentUrl;};this.playlistId=function(){return playlistId;};this.getContext=function(){return context;};this.getContentWidth=function(){return contentWidth;};this.getContentHeight=function(){return contentHeight;};this.getDuration=function(){return duration;};this.getPlayhead=function(){return playhead;};this.getAbsolutePlayhead=function(){return absolutePlayhead;};this.isBuffering=function(){return buffering;};this.isPaused=function(){return paused;};this.isFullscreen=function(){return fullscreen;};this.onContentMetadata=function(pPlayerId,pContentId,pDuration,pWidth,pHeight){contentId=pContentId;playhead=0;duration=pDuration;contentWidth=pWidth;contentHeight=pHeight;};this.onContentBegin=function(pPlayerId,pContentId){contentId=pContentId;};this.onContentBuffering=function(pPlayerId,pContentId,pBuffering){buffering=pBuffering;};this.onContentPlayhead=function(pPlayerId,pContentId,pPlayhead,pTotalDuration,pCurrentTime){playhead=pPlayhead;absolutePlayhead=pCurrentTime||-1;};this.onContentPause=function(pPlayerId,pContentId,pPaused){paused=pPaused;};this.onContentResize=function(pPlayerId,pWidth,pHeight,pFullscreen){fullscreen=pFullscreen;};this.onPlayerReady=function(){playerInstance=this.getDOMPlayerInstance();};CVP.registerInstance(id,this);return this;};CVPObject.prototype={getDOMPlayer:(navigator.appName.indexOf("Microsoft")!==-1?function getDOMPlayer(){return window[this.getId()];}:function getDOMPlayer(){return document[this.getId()];}),getPlayer:function(id){if(this._playerType===HTML5||Browser.allowedHtmlPlayer){return this.getDOMPlayer();}else{this.getDOMPlayer().getPlayerJS(id);return this;}},setDefaultPlayer:function(id){this.getDOMPlayer().setDefaultPlayer(id);return this;},embedSWF:function(){return this.embed.apply(this,arguments);},embed:function(containerElementId){var self=this;
if(this._playerType===FLASH){var flashvars=this.getFlashVars();flashvars.domId=this.getId();flashvars.cvpSessionToken=CVP.getSessionToken();var embed=this.getEmbed();var container=embed.containerSwf;var params=embed.options;var express=embed.expressInstallSwf;var version=validateFlashVersion(embed.flashVersion);var attributes={id:this.getId(),name:this.getId()};if(!CVP.swfobject.hasFlashPlayerVersion("1.0.0")){this.handleCallBack("onNoFlashDetected");}CVP.swfobject.embedSWF(container,containerElementId,this.getWidth(),this.getHeight(),version,express,flashvars,params,attributes);}else{if(this.getPlayer().embed){Events.onReady(function(){self.getPlayer().embed(containerElementId);});}}return this;},removeSWF:function(){return this.remove.apply(this,arguments);},remove:function(){if(this._playerType===FLASH){CVP.swfobject.removeSWF(this.getId());}else{if(isFunc(this.getPlayer().remove)){this.getPlayer().remove();}}return this;},play:function(id,options){this.getDOMPlayer().playContent(id,options||{});return this;},playFromObject:function(object,options){this.getDOMPlayer().playFromObject(object,options||{});return this;},reportAnalytics:function(eventName,data){this.getDOMPlayer().reportAnalytics(eventName,data);return this;},replay:function(){this.getDOMPlayer().replayContent();return this;},playNextInQueue:function(){this.getDOMPlayer().playNextInQueue();return this;},pause:function(){this.getDOMPlayer().pause();return this;},resume:function(){this.getDOMPlayer().resume();return this;},stop:function(){this.getDOMPlayer().stopContent();return this;},queue:function(id,options,index){if(typeof index==="undefined"){index=-1;}this.getDOMPlayer().queue(id,options||{},index);return this;},queueFromObject:function(object,options,index){if(typeof index==="undefined"){index=-1;}this.getDOMPlayer().queueFromObject(object,options||{},index);return this;},dequeue:function(id){this.getDOMPlayer().dequeue(id);return this;},emptyQueue:function(){this.getDOMPlayer().emptyQueue();return this;},setQueueAutoplay:function(autoplay){this.getDOMPlayer().setQueueAutoplay(autoplay);return this;},getQueue:function(){return this.getDOMPlayer().getQueue();},seek:function(time){this.getDOMPlayer().seek(time);return this;},mute:function(){this.getDOMPlayer().mute();return this;},unmute:function(){this.getDOMPlayer().unmute();return this;},setVolume:function(volume){this.getDOMPlayer().setVolume(volume);return this;},getVolume:function(){return this.getDOMPlayer().getVolume();},isMuted:function(){return this.getDOMPlayer().isMuted();},getContentEntry:function(id){return this.getDOMPlayer().getContentEntry(id);},goFullscreen:function(){this.getDOMPlayer().goFullscreen();return this;},resize:function(width,height,duration){this.getDOMPlayer().resize(width,height,duration);return this;},setMaxBitrate:function(bitrate){this.getDOMPlayer().setMaxBitrate(bitrate);return this;},switchBitrateId:function(id){this.getDOMPlayer().switchBitrateId(id);return this;},setAutoBitrateSwitch:function(auto){this.getDOMPlayer().setAutoBitrateSwitch(auto);return this;},getAvailableBitrates:function(playMode){return this.getDOMPlayer().getAvailableBitrates(playMode);},getBitrateId:function(){return this.getDOMPlayer().getBitrateId();},setGroupOrder:function(order){this.getDOMPlayer().setGroupOrder(order);return this;},getShareOptions:function(){return this.getDOMPlayer().getShareOptions();},setClosedCaptions:function(on,trackId){this.getDOMPlayer().setClosedCaptions(on,trackId);return this;},setAdSection:function(section){this.getDOMPlayer().setAdSection(section);return this;},setAdKeyValue:function(key,value){this.getDOMPlayer().setAdKeyValue(key,value);return this;},setAdExchangeValue:function(key,value){this.getDOMPlayer().setAdExchangeValue(key,value);return this;},setAdVisibility:function(adsObject){this.getDOMPlayer().setAdVisibility(adsObject);return this;},switchAdContext:function(context){this.getDOMPlayer().switchAdContext(context);return this;},switchTrackingContext:function(context){this.getDOMPlayer().switchTrackingContext(context);return this;},setDataSrc:function(src){this.getDOMPlayer().setDataSrc(src);return this;},setFileKey:function(key){this.getDOMPlayer().setFileKey(key);return this;},sendUIMessage:function(message,data){this.getDOMPlayer().sendUIMessage(message,data);return this;},sendUserReportedIssue:function(data){this.getDOMPlayer().sendUserReportedIssue(data);return this;}};CVP.HTML5=HTML5;CVP.FLASH=FLASH;CVP.version=VERSION;CVP.VIDEO_NOT_FOUND_ERROR="video not found";CVP.VIDEO_XML_NOT_FOUND_ERROR="cms error";CVP.MEDIA_ERR_UNKNOWN="Unknown error.";CVP.MEDIA_ERR_ABORTED="The fetching process for the media resource was aborted by the user agent at the user's request.";CVP.MEDIA_ERR_NETWORK="A network error of some description caused the user agent to stop fetching the media resource, after the resource was established to be usable.";CVP.MEDIA_ERR_DECODE="An error of some description occurred while decoding the media resource, after the resource was established to be usable.";CVP.MEDIA_ERR_SRC_NOT_SUPPORTED="The media resource indicated by the src attribute was not suitable.";CVP.instances={};CVP.registerInstance=function(id,instance){CVP.instances[id]=instance;};CVP.unregisterInstance=function(id){CVP.instances[id]=null;};CVP.findInstance=function(id){return CVP.instances[id];};CVP.onCallback=function(id,args){var instance=CVP.findInstance(id);if(!instance){log.error("onCallback - unable to find instance "+id);throw new Error("onCallback - unable to find instance "+id);}return instance.handleCallBack.apply(instance,args);};CVP.cleanup=function(){var inst;for(inst in CVP.instances){if(hasOwn(CVP.instances,inst)){window[inst+"_callback_handler"]=null;CVP.instances[inst]=null;}}};CVP.Store=(function(){var store={};return{get:function(key,del){var val=store[key];if(del){delete store[key];}return val;},set:function(key,val){store[key]=val;}};})();CVP.init=function(setup){var key,val;if(typeof setup!=="object"){throw new Error("CVP.init() requires one param: a simple object");}for(key in setup){if(hasOwn(setup,key)){val=setup[key];if(Utils.isSimpleObject(val)){_cvpsetup[key]=extend(_cvpsetup[key],val);}else{_cvpsetup[key]=val;}}}};CVP.createPlayer=function(options){return new CVPObject(options);};var Version=(function(){var regex=/(\d+)(?:(\D)(\d+))?(?:(\D)(\d+))?/;var greekRE=/^[abd]$/;function Version(string){if(typeof string!=="string"){throw new TypeError("Version() only accepts a string");}this.raw=string;this.major=NaN;this.minor=NaN;this.revision=NaN;var matches=regex.exec(string);if(!matches){throw new SyntaxError('Version string "'+this.raw+'" failed to parse as a valid version number');}var major=matches[1];var minor=matches[3];var revision=matches[5];this.major=major;if(minor&&!greekRE.test(matches[2])){this.minor=minor;if(revision&&!greekRE.test(matches[4])){this.revision=revision;}}}Version.prototype.toString=function(){return this.toArray().join(".");};Version.prototype.toArray=function(full){var pieces=[this.major,this.minor,this.revision];var array=[];for(var num,i=0,endi=pieces.length;i<endi;++i){num=+(pieces[i]);if(!full&&isNaN(num)){break;}array.push(num);}return array;};Version.prototype.compare=function(version,shallow){if(!(version instanceof Version)){return this.compare(new Version(version),shallow);}var i=0,endi=0,cmpArray,thisArray=this.toArray(true),a,b;cmpArray=shallow?version.toArray():version.toArray(true);for(endi=cmpArray.length;i<endi;++i){a=+(thisArray[i])||0;b=+(cmpArray[i])||0;if(a>b){return 1;}else{if(a<b){return -1;}}}return 0;};Version.prototype.is=function(version){return this.compare(version,true)===0;};Version.prototype.eq=function(version){return this.compare(version)===0;};Version.prototype.gt=function(version){return this.compare(version)>0;};Version.prototype.lt=function(version){return this.compare(version)<0;};Version.prototype.isnt=function(version){return !this.is(version);};Version.prototype.ne=function(version){return !this.eq(version);
};Version.prototype.lte=function(version){return !this.gt(version);};Version.prototype.gte=function(version){return !this.lt(version);};return Version;})();var Browser=(function(){var ua=window.navigator.userAgent;var log=("object"===typeof console&&"function"===typeof console.log?function(){console.log.apply(console,arguments);}:function(){});var browser={IOS:"iOS",OSX:"OSX",ANDROID:"Android",SAFARI:"Safari",SILK:"Silk",CHROME:"Chrome",FIREFOX:"Firefox",OPERA:"Opera",IE:"Internet Explorer",IPAD:"iPad",IPOD:"iPod",IPHONE:"iPhone",KINDLE:"Kindle",DESKTOP:"desktop",MOBILE:"mobile",TABLET:"tablet"};var video=document.createElement("video");var successPattern=/^(maybe|probably)$/;var canPlayType=function(mediaType){try{return successPattern.test(video.canPlayType(mediaType));}catch(e){return false;}};browser.supports={};browser.supports.video="function"===typeof video.canPlayType;browser.supports.mp4=browser.supports.video&&canPlayType("video/mp4");browser.supports.m3u8=browser.supports.video&&(canPlayType("application/x-mpegURL")||canPlayType("application/vnd.apple.mpegURL"));var tells={Safari:/ Safari\/\d+(?:\.\d+){0,2}/,Version:/ Version\/(\d+(?:\.\d+){0,2})/,Opera:/^Opera\/\d+(?:\.\d+){0,2}/,Silk:/ Silk\/(\d+(?:\.\d+){0,2})/,InternetExplorer:/; MSIE (\d+(?:\D\d+){0,2})/,Firefox:/ Firefox\/(\d+(?:\D\d+){0,2})/,Chrome:/ Chrome\/(\d+(?:\D\d+){0,2})/,RenderingEngine:/ (AppleWebKit|Trident|Gecko|Presto)\/(\d+(?:\D\d+){0,2})/,AppleDevice:/ \((iP(?:[ao]d|hone));/,Android:/; Android(?: (\d+(?:\D\d+){0,2}))?[;)]/,iOS:/ OS (\d+(?:\D\d+){0,2}) like(?: Mac)? OS X/,OSX:/ OS X (\d+(?:\D\d+){0,2})/,MobileSafari:/ Mobile(?:\/\S+)? Safari\//,MobileFirefox:/; Mobile; .+ Firefox\/| Fennec\//,TabletFirefox:/; Tablet; .+ Firefox\//,IEMobile:/; IEMobile\/(\d+(?:\.\d+){0,2})/,OperaMobile:/; Opera (Mini|Mobi)\//,OperaTablet:/; Opera Tablet\//,SilkAccelerated:/ Silk-Accelerated=(true|false)/};function readTells(userAgent){var results={};for(var tell in tells){results[tell]=tells[tell].exec(userAgent);}return results;}(function(has){if(has.Firefox){browser.name=browser.FIREFOX;browser.version=new Version(has.Firefox[1]);}else{if(has.InternetExplorer){browser.name=browser.IE;browser.version=new Version(has.InternetExplorer[1]);}else{if(has.Opera&&has.Version){browser.name=browser.OPERA;browser.version=new Version(has.Version[1]);}else{if(has.Silk){browser.name=browser.SILK;browser.version=new Version(has.Silk[1]);}else{if(has.Chrome){browser.name=browser.CHROME;browser.version=new Version(has.Chrome[1]);}else{if(has.Safari&&has.Version){browser.name=browser.SAFARI;browser.version=new Version(has.Version[1]);}}}}}}browser.engine={};if(has.RenderingEngine){browser.engine.name=has.RenderingEngine[1];browser.engine.version=new Version(has.RenderingEngine[2]);}browser.os={};if(has.Android){browser.os.name=browser.ANDROID;if("undefined"!==typeof has.Android[1]){browser.os.version=new Version(has.Android[1]);}}else{if(has.iOS){browser.os.name=browser.IOS;browser.os.version=new Version(has.iOS[1]);}else{if(has.OSX){browser.os.name=browser.OSX;browser.os.version=new Version(has.OSX[1]);}}}browser.device={};if(has.AppleDevice){browser.device.name=has.AppleDevice[1];}else{if(has.Silk){browser.device.name=browser.KINDLE;}}browser.device.type=browser.DESKTOP;if(has.MobileSafari||has.MobileFirefox||has.IEMobile||has.OperaMobile){browser.device.type=browser.MOBILE;}if(has.TabletFirefox||has.OperaTablet||(has.Android&&browser.device.type!==browser.MOBILE)){browser.device.type=browser.TABLET;}var is=function(property,name,version){var result;var pattern=/^(!?~|[!=><]=?)?(\d.*)$/;var checkVersion=function(version,string){var match=pattern.exec(string);var fn=version.is;var response;if(!match){throw new Error("checkVersion: The pattern -- "+string+" -- was not considered valid.");}switch(match[1]){case"~":fn=version.is;break;case"!~":fn=version.isnt;break;case"=":case"==":fn=version.eq;break;case"!":case"!=":fn=version.ne;break;case">":fn=version.gt;break;case">=":fn=version.gte;break;case"<":fn=version.lt;break;case"<=":fn=version.lte;break;}response=fn.call(version,match[2]);return response;};switch(property){case"browser":result=name===browser.name;if(version){result=result&&checkVersion(browser.version,version);}break;case"engine":result=name===browser.engine.name;if(version){result=result&&checkVersion(browser.engine.version,version);}break;case"os":result=name===browser.os.name;if(version){result=result&&checkVersion(browser.os.version,version);}break;case"device":result=name===browser.device.name;break;case"platform":result=name===browser.device.type;break;default:log('Browser.is() did not understand property "'+property+'"');}return result;};function curry(fn,scope){var context=scope||window;var args=[].slice.call(arguments,2);return function(){return fn.apply(context,args.concat([].slice.call(arguments)));};}browser.isBrowser=curry(is,this,"browser");browser.isEngine=curry(is,this,"engine");browser.isOS=curry(is,this,"os");browser.isDevice=curry(is,this,"device");browser.isPlatform=curry(is,this,"platform");if(browser.isOS(browser.ANDROID,"<4")){browser.supports.m3u8=false;}if(browser.device.name===browser.KINDLE){browser.device.type=browser.MOBILE;}if(browser.device.name===browser.IPAD){browser.device.type=browser.TABLET;}browser.allowedHtmlPlayer=browser.isOS(browser.IOS)||browser.isBrowser(browser.SILK);browser.allowedAutoPlay=browser.isPlatform(browser.DESKTOP)||!(browser.isOS(browser.IOS));browser.forcesFullscreen=browser.isPlatform(browser.MOBILE);}(readTells(ua)));return browser;}());CVP.Version=Version;CVP.Browser=Browser;var JSON=window.JSON;var JSON3=function(){function t(t){if("bug-string-char-index"==t){return"a"!="a"[0];}var e,r='{"a":[1,true,false,null,"\\u0000\\b\\n\\f\\r\\t"]}',i="json"==t;if(i||"json-stringify"==t||"json-parse"==t){if("json-stringify"==t||i){var l=c.stringify,f="function"==typeof l&&a;if(f){(e=function(){return 1;}).toJSON=e;try{f="0"===l(0)&&"0"===l(new Number)&&'""'==l(new String)&&l(o)===n&&l(n)===n&&"1"===l(e)&&"[1]"==l([e])&&"[null]"==l([n])&&"null"==l(null)&&"[null,null,null]"==l([n,o,null])&&l({a:[e,!0,!1,null,"\0\b\n\f\r "]})==r&&"1"===l(null,e)&&"[\n 1,\n 2\n]"==l([1,2],null,1)&&'"-271821-04-20T00:00:00.000Z"'==l(new Date(-8640000000000000))&&'"+275760-09-13T00:00:00.000Z"'==l(new Date(8640000000000000))&&'"-000001-01-01T00:00:00.000Z"'==l(new Date(-62198755200000))&&'"1969-12-31T23:59:59.999Z"'==l(new Date(-1));}catch(u){f=!1;}}if(!i){return f;}}if("json-parse"==t||i){var s=c.parse;if("function"==typeof s){try{if(0===s("0")&&!s(!1)){e=s(r);var h=5==e.a.length&&1===e.a[0];if(h){try{h=!s('" "');}catch(u){}if(h){try{h=1!==s("01");}catch(u){}}}}}catch(u){h=!1;}}if(!i){return h;}}return f&&h;}}var e,r,n,o={}.toString,c={};"object"==typeof JSON&&JSON&&(c.stringify=JSON.stringify,c.parse=JSON.parse);var a=new Date(-3509827334573292);try{a=-109252==a.getUTCFullYear()&&0===a.getUTCMonth()&&1===a.getUTCDate()&&10==a.getUTCHours()&&37==a.getUTCMinutes()&&6==a.getUTCSeconds()&&708==a.getUTCMilliseconds();}catch(i){}if(!t("json")){var l="[object Function]",f="[object Date]",u="[object Number]",s="[object String]",h="[object Array]",p="[object Boolean]",g=t("bug-string-char-index");if(!a){var y=Math.floor,v=[0,31,59,90,120,151,181,212,243,273,304,334],C=function(t,e){return v[e]+365*(t-1970)+y((t-1969+(e=+(e>1)))/4)-y((t-1901+e)/100)+y((t-1601+e)/400);};}(e={}.hasOwnProperty)||(e=function(t){var r,n={};return(n.__proto__=null,n.__proto__={toString:1},n).toString!=o?e=function(t){var e=this.__proto__,r=(this.__proto__=null,t in this);return this.__proto__=e,r;}:(r=n.constructor,e=function(t){var e=(this.constructor||r).prototype;return t in this&&!(t in e&&this[t]===e[t]);}),n=null,e.call(this,t);});var b={"boolean":1,number:1,string:1,undefined:1},d=function(t,e){var r=typeof t[e];return"object"==r?!!t[e]:!b[r];};if(r=function(t,r){var n,c,a,i,f=0;(n=function(){this.valueOf=0;}).prototype.valueOf=0,c=new n;for(a in c){e.call(c,a)&&f++;}return n=c=null,f?i=2==f?function(t,r){var n,c={},a=o.call(t)==l;
for(n in t){a&&"prototype"==n||e.call(c,n)||!(c[n]=1)||!e.call(t,n)||r(n);}}:function(t,r){var n,c,a=o.call(t)==l;for(n in t){a&&"prototype"==n||!e.call(t,n)||(c="constructor"===n)||r(n);}(c||e.call(t,n="constructor"))&&r(n);}:(c=["valueOf","toString","toLocaleString","propertyIsEnumerable","isPrototypeOf","hasOwnProperty","constructor"],i=function(t,r){var n,a,i=o.call(t)==l,f=!i&&"function"!=typeof t.constructor&&d(t,"hasOwnProperty")?t.hasOwnProperty:e;for(n in t){i&&"prototype"==n||!f.call(t,n)||r(n);}for(a=c.length;n=c[--a];f.call(t,n)&&r(n)){}}),i(t,r);},!t("json-stringify")){var j={92:"\\\\",34:'\\"',8:"\\b",12:"\\f",10:"\\n",13:"\\r",9:"\\t"},S="000000",A=function(t,e){return(S+(e||0)).slice(-t);},T="\\u00",_=function(t){var e,r='"',n=0,o=t.length,c=o>10&&g;for(c&&(e=t.split(""));o>n;n++){var a=t.charCodeAt(n);switch(a){case 8:case 9:case 10:case 12:case 13:case 34:case 92:r+=j[a];break;default:if(32>a){r+=T+A(2,a.toString(16));break;}r+=c?e[n]:g?t.charAt(n):t[n];}}return r+'"';},O=function(t,c,a,i,l,g,v){var b,d,j,S,T,w,U,N,J,D,M,k,m,x,P,Z,E=c[t];try{E=c[t];}catch(F){}if("object"==typeof E&&E){if(b=o.call(E),b!=f||e.call(E,"toJSON")){"function"==typeof E.toJSON&&(b!=u&&b!=s&&b!=h||e.call(E,"toJSON"))&&(E=E.toJSON(t));}else{if(E>-1/0&&1/0>E){if(C){for(S=y(E/86400000),d=y(S/365.2425)+1970-1;C(d+1,0)<=S;d++){}for(j=y((S-C(d,0))/30.42);C(d,j+1)<=S;j++){}S=1+S-C(d,j),T=(E%86400000+86400000)%86400000,w=y(T/3600000)%24,U=y(T/60000)%60,N=y(T/1000)%60,J=T%1000;}else{d=E.getUTCFullYear(),j=E.getUTCMonth(),S=E.getUTCDate(),w=E.getUTCHours(),U=E.getUTCMinutes(),N=E.getUTCSeconds(),J=E.getUTCMilliseconds();}E=(0>=d||d>=10000?(0>d?"-":"+")+A(6,0>d?-d:d):A(4,d))+"-"+A(2,j+1)+"-"+A(2,S)+"T"+A(2,w)+":"+A(2,U)+":"+A(2,N)+"."+A(3,J)+"Z";}else{E=null;}}}if(a&&(E=a.call(c,t,E)),null===E){return"null";}if(b=o.call(E),b==p){return""+E;}if(b==u){return E>-1/0&&1/0>E?""+E:"null";}if(b==s){return _(""+E);}if("object"==typeof E){for(m=v.length;m--;){if(v[m]===E){throw TypeError();}}if(v.push(E),D=[],x=g,g+=l,b==h){for(k=0,m=E.length;m>k;P||(P=!0),k++){M=O(k,E,a,i,l,g,v),D.push(M===n?"null":M);}Z=P?l?"[\n"+g+D.join(",\n"+g)+"\n"+x+"]":"["+D.join(",")+"]":"[]";}else{r(i||E,function(t){var e=O(t,E,a,i,l,g,v);e!==n&&D.push(_(t)+":"+(l?" ":"")+e),P||(P=!0);}),Z=P?l?"{\n"+g+D.join(",\n"+g)+"\n"+x+"}":"{"+D.join(",")+"}":"{}";}return v.pop(),Z;}};c.stringify=function(t,e,r){var n,c,a;if("function"==typeof e||"object"==typeof e&&e){if(o.call(e)==l){c=e;}else{if(o.call(e)==h){a={};for(var i,f=0,p=e.length;p>f;i=e[f++],(o.call(i)==s||o.call(i)==u)&&(a[i]=1)){}}}}if(r){if(o.call(r)==u){if((r-=r%1)>0){for(n="",r>10&&(r=10);n.length<r;n+=" "){}}}else{o.call(r)==s&&(n=r.length<=10?r:r.slice(0,10));}}return O("",(i={},i[""]=t,i),c,a,n,"",[]);};}if(!t("json-parse")){var w,U,N=String.fromCharCode,J={92:"\\",34:'"',47:"/",98:"\b",116:" ",110:"\n",102:"\f",114:"\r"},D=function(){throw w=U=null,SyntaxError();},M=function(){for(var t,e,r,n,o,c=U,a=c.length;a>w;){switch(o=c.charCodeAt(w)){case 9:case 10:case 13:case 32:w++;break;case 123:case 125:case 91:case 93:case 58:case 44:return t=g?c.charAt(w):c[w],w++,t;case 34:for(t="@",w++;a>w;){if(o=c.charCodeAt(w),32>o){D();}else{if(92==o){switch(o=c.charCodeAt(++w)){case 92:case 34:case 47:case 98:case 116:case 110:case 102:case 114:t+=J[o],w++;break;case 117:for(e=++w,r=w+4;r>w;w++){o=c.charCodeAt(w),o>=48&&57>=o||o>=97&&102>=o||o>=65&&70>=o||D();}t+=N("0x"+c.slice(e,w));break;default:D();}}else{if(34==o){break;}for(o=c.charCodeAt(w),e=w;o>=32&&92!=o&&34!=o;){o=c.charCodeAt(++w);}t+=c.slice(e,w);}}}if(34==c.charCodeAt(w)){return w++,t;}D();default:if(e=w,45==o&&(n=!0,o=c.charCodeAt(++w)),o>=48&&57>=o){for(48==o&&(o=c.charCodeAt(w+1),o>=48&&57>=o)&&D(),n=!1;a>w&&(o=c.charCodeAt(w),o>=48&&57>=o);w++){}if(46==c.charCodeAt(w)){for(r=++w;a>r&&(o=c.charCodeAt(r),o>=48&&57>=o);r++){}r==w&&D(),w=r;}if(o=c.charCodeAt(w),101==o||69==o){for(o=c.charCodeAt(++w),(43==o||45==o)&&w++,r=w;a>r&&(o=c.charCodeAt(r),o>=48&&57>=o);r++){}r==w&&D(),w=r;}return +c.slice(e,w);}if(n&&D(),"true"==c.slice(w,w+4)){return w+=4,!0;}if("false"==c.slice(w,w+5)){return w+=5,!1;}if("null"==c.slice(w,w+4)){return w+=4,null;}D();}}return"$";},k=function(t){var e,r;if("$"==t&&D(),"string"==typeof t){if("@"==(g?t.charAt(0):t[0])){return t.slice(1);}if("["==t){for(e=[];t=M(),"]"!=t;r||(r=!0)){r&&(","==t?(t=M(),"]"==t&&D()):D()),","==t&&D(),e.push(k(t));}return e;}if("{"==t){for(e={};t=M(),"}"!=t;r||(r=!0)){r&&(","==t?(t=M(),"}"==t&&D()):D()),(","==t||"string"!=typeof t||"@"!=(g?t.charAt(0):t[0])||":"!=M())&&D(),e[t.slice(1)]=k(M());}return e;}D();}return t;},m=function(t,e,r){var o=x(t,e,r);o===n?delete t[e]:t[e]=o;},x=function(t,e,n){var c,a=t[e];if("object"==typeof a&&a){if(o.call(a)==h){for(c=a.length;c--;){m(a,c,n);}}else{r(a,function(t){m(a,t,n);});}}return n.call(t,e,a);};c.parse=function(t,e){var r,n;return w=0,U=""+t,r=k(M()),"$"!=M()&&D(),w=U=null,e&&o.call(e)==l?x((n={},n[""]=r,n),"",e):r;};}}return c;}(this);JSON=CVP.JSON=JSON3;CVP.Log=(function(){var __hasProp={}.hasOwnProperty;var slice=Array.prototype.slice;var now=(typeof Date.now==="function"?Date.now:function(){return(new Date()).getTime();});var getType=(function(){var simpleTypes=["undefined","boolean","function","number","string"];var toStartCase=function(string){return string.charAt(0).toUpperCase()+string.substr(1);};var types={};for(var type=null,i=0,len=simpleTypes.length;i<len;++i){type=simpleTypes[i];types[type]=toStartCase(type);}return function(obj){var key;var type=typeof obj;if(null===obj){return"Null";}if(obj!==obj){return"NaN";}if(window===obj){return"Global";}if(type==="object"&&(window.Element!==undefined&&obj instanceof Element||obj.nodeType!==undefined)){return"Element";}return types[type]||types[key=types.toString.call(obj)]||(types[key]=key.slice(8,-1));};})();var getJSON=typeof JSON==="object"&&typeof JSON.stringify==="function"?function(obj){var string;try{string=JSON.stringify(obj);}catch(error){string="";}return string;}:function(){return"";};var dump=function(obj,maxdepth,depth){var key,nest,output,pair,string,type,value;if(maxdepth==null){maxdepth=0;}if(depth==null){depth=0;}output=[];string=getJSON(obj);if(string!==""&&string!=="{}"){return string;}nest=function(object){if(depth>=maxdepth){return"\u2026";}return dump(object,maxdepth,++depth);};for(key in obj){if(!__hasProp.call(obj,key)){continue;}try{value=obj[key];}catch(e){continue;}pair=[key];type=getType(value);switch(type){case"Null":pair.push("null");break;case"Element":pair.push(value.nodeName?"<"+value.nodeName+(value.id?"#"+value.id:"")+(value.className?"."+value.className.replace(/\s+/,"."):"")+"/>":"[Element]");break;case"Number":pair.push(String(value));break;case"Boolean":pair.push(String(value));break;case"String":pair.push('"'+value+'"');break;case"Undefined":pair.push("undefined");break;case"Function":pair.push("function {\u2026}");break;case"RegExp":pair.push(String(value));break;case"Date":pair.push(value.toLocaleString());break;case"Array":pair.push("["+nest(value)+"]");break;case"Arguments":pair.push("["+nest(slice.call(value))+"]");break;case"Object":pair.push("{"+nest(value)+"}");break;default:pair.push("["+type+"]{"+nest(value)+"}");}output.push(pair.join(": "));}return"["+(getType(obj))+"]{"+(output.length!==0?" "+(output.join(", "))+" ":"")+"}";};var start=now();var logAcceptsSingleArgumentOnly=Browser.isOS(Browser.ANDROID)||Browser.isOS(Browser.IOS,"<6")||Browser.isBrowser(Browser.IE,"<10");var appId="CVP";var windowId=window.self===window.top?"_top":window.name?window.name:"";var consoleMethods=["error","warn","info","debug","log"];var log4jsMethods=[].concat("fatal",consoleMethods,"trace");var levelNames=[].concat("none",log4jsMethods,"all");var levels={};for(var method=null,i=0,endi=levelNames.length;i<endi;++i){method=levelNames[i];levels[method.toUpperCase()]=i;}var defaultLevel=levels.WARN;var silent=/NO|NONE|OFF|SILENT|QUIET/;var passthru={};var functionProto=Function.prototype;var logFallback=(typeof console==="object"?typeof console.log==="function"?function(){console.log.apply(console,arguments);
}:typeof console.log==="object"?function(one){var numOfArgs=arguments.length;if(numOfArgs>1){console.log([].slice(arguments).join(" \u2022 "));}else{if(numOfArgs===1){console.log(one);}}}:functionProto:functionProto);var getLevelNum=function(level){level=level.toUpperCase();return levels[level]||(silent.test(level)?levels.NONE:levels.ALL);};var determineLevel=function(level){switch(typeof level){case"string":return getLevelNum(level);case"number":return level;default:return defaultLevel;}};if(debugMatch){defaultLevel=determineLevel(debugMatch[1]);}var api={};for(var j=0,endj=log4jsMethods.length;j<endj;++j){(function(fn){passthru[fn]=function(){if(typeof console==="object"){switch(typeof console[fn]){case"object":passthru[fn]=(typeof Function.prototype.bind==="function"?functionProto.call.bind(console[fn],console):logFallback);return passthru[fn].apply(null,arguments);case"function":return console[fn].apply(console,arguments);default:return logFallback.apply(null,arguments);}}};api[fn]=function(){var args=slice.call(arguments);if(logAcceptsSingleArgumentOnly){for(var arg,k=0,endk=args.length;k<endk;++k){arg=args[k];if(typeof arg==="object"){args[k]=dump(arg);}}args=[args.join(" \u2022 ")];}passthru[fn].apply(this,args);};})(log4jsMethods[j]);}var Logger=(function(){function Logger(id){var _this=this;this.id=id||"";this.setLevel(defaultLevel);this._logger={};for(var name in api){(function(name,fn){_this._logger[name]=function(){var args,level;level=name.toUpperCase();if(_this.getLevel()>=levels[level]){args=slice.call(arguments);args.unshift("["+appId+"|"+windowId+"|"+_this.id+"|"+(now()-start)+"]",level);return fn.apply(_this,args);}};_this[name]=function(){return _this._logger[name].apply(_this._logger,arguments);};})(name,api[name]);}}Logger.prototype.useLog4JS=function(loggerName){var _this=this;var attempts=0;(function(delay,maxAttempts){var poller;return setTimeout(poller=function(){if(maxAttempts&&++attempts>maxAttempts){return;}if(typeof window.log4javascript==="object"&&typeof window.log4javascript.getDefaultLogger==="function"){_this.warn("switching '"+appId+"|"+windowId+"|"+_this.id+"' logger to send future messages to log4javascript");var log4js=loggerName?window.log4javascript.getLogger(loggerName):window.log4javascript.getDefaultLogger();for(var name in api){(function(name){_this._logger[name]=function(){var args=slice.call(arguments);args.unshift("["+appId+"|"+windowId+"|"+_this.id+"]");return log4js[name].apply(log4js,args);};})(name);}}else{setTimeout(poller,delay);}},delay);})(2000,10);};Logger.prototype.setLevel=function(level){this.loggerLevel=determineLevel(level);return this.loggerLevel;};Logger.prototype.getLevel=function(){return this.loggerLevel;};return Logger;})();var registeredLoggers=[];var getLogger=function(instanceId){if(instanceId==null){instanceId="";}return registeredLoggers[instanceId]=registeredLoggers[instanceId]||new Logger(instanceId);};return{Level:levels,getDefaultLevel:function(){return defaultLevel;},setDefaultLevel:function(level){defaultLevel=determineLevel(level);return defaultLevel;},getLogger:getLogger};})();var Class=(function(){var initializing=false,fnTest=/xyz/.test(function(){xyz;})?/\b_super\b/:/.*/;var Class=function(){};Class.extend=function(prop){var _super=this.prototype;initializing=true;var prototype=new this();initializing=false;for(var name in prop){prototype[name]=typeof prop[name]=="function"&&typeof _super[name]=="function"&&fnTest.test(prop[name])?(function(name,fn){return function(){var tmp=this._super;this._super=_super[name];var ret=fn.apply(this,arguments);this._super=tmp;return ret;};})(name,prop[name]):prop[name];}function Class(){if(!initializing&&this.init){this.init.apply(this,arguments);}}Class.prototype=prototype;Class.constructor=Class;Class.extend=arguments.callee;return Class;};return Class;})();CVP.Class=Class;var Utils=CVP.Utils={getCookie:function(){return document.cookie;},setCookie:function(key,value,timeExpire){if(!key){return;}document.cookie=key+"="+value+"; expires="+timeExpire;},undef:function(obj){return typeof obj==="undefined";},isNull:function(obj){return Utils.undef(obj)||obj===null;},empty:function(obj){if(Utils.isNull(obj)){return true;}if(Utils.isString(obj)||Utils.isArray(obj)){return obj.length===0;}for(var key in obj){if(Utils.hasOwn(obj,key)){return false;}}return true;},isFunc:function(f){return typeof f==="function";},isObject:function(obj){return typeof obj==="object";},isSimpleObject:function(obj){return Object.prototype.toString.call(obj)==="[object Object]";},isString:function(obj){return typeof obj==="string";},isArray:(typeof Array.isArray==="function"?Array.isArray:function(object){return Object.prototype.toString.call(object)==="[object Array]";}),indexOf:(function(){var nativeArrayIndexOf=Array.prototype.indexOf;var arrayIndexOf="function"===typeof nativeArrayIndexOf?nativeArrayIndexOf:function(arr,val,i){if(arr){var len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;++i){if(i in arr&&arr[i]===val){return i;}}}return -1;};return function(obj,val,i){if(Utils.isString(obj)){return obj.indexOf(val,i);}if(Utils.isArray(obj)){return arrayIndexOf.call(obj,val,i);}};}()),isFlagActive:function(str,bDefault){if(Utils.empty(str)){return bDefault;}switch(str.toLowerCase()){case"yes":case"true":case"on":return true;default:return false;}},extend:function(target,source){var sources=arguments.length>2?Utils.slice(arguments,1):source?[source]:[];var i,endi,src,p;target=target||{};for(i=0,endi=sources.length;i<endi;++i){src=sources[i];if(!src||!Utils.isObject(src)){continue;}for(p in src){target[p]=src[p];}}return target;},byId:function(id){return document.getElementById(id);},slice:function(arr,index){return Array.prototype.slice.call(arr,index||0);},hasOwn:(typeof Object.prototype.hasOwnProperty==="function"?function(object,property){return Object.prototype.hasOwnProperty.call(object,property);}:function(object,property){return object[property]!==Object.prototype[property];}),bind:function(func,scope){var args=Utils.slice(arguments,2);return function(){var a=args.concat(Utils.slice(arguments));return func.apply(scope,a);};},template:function(template){var matches=template.match(/\{[^{}]*\}/g),i=0,len=0,args=Utils.slice(arguments,1),argc=args.length;if(!matches){log.info("No {placeholders} present in template: ",template);}else{for(i=0,len=matches.length;i<len&&i<argc;++i){template=template.replace(matches[i],args[i]);}}return template;},joinKeys:function(obj,delimiter){var arr=[],p;if(nil(delimiter)){delimiter=",";}for(p in obj){if(hasOwn(obj,p)){arr.push(p+"="+obj[p]);}}return arr.join(delimiter);},getQueryParams:function(str){var params={},source=str||location.href,data=[],i=0,endi=0,pair=[];try{data=(source.split("?",2)[1]||"").split("#")[0].split("&")||[];for(endi=data.length;i<endi;++i){pair=data[i].split("=");if(pair[0]){params[pair[0]]=unescape(pair[1]);}}}catch(e){log.warn("unable to get url params");}return params;},getQueryParam:function(key){return this.getQueryParams()[key];},isRelativePath:function(url){return url&&url.indexOf("://")===-1;},log:function(){if(window.console&&window.console.log&&debugFlag){window.console.log(Utils.slice(arguments).join(" | "));}},print:function(obj,str){var o;if(str!=="nested"){log.info("Print all values for ",str);}for(o in obj){if(hasOwn(obj,o)){if(!o){continue;}if(Utils.isObject(obj[o])){log.info("Printing nested object value",o);Utils.print(obj[o],"nested");}else{log.info(str==="nested"?"\t":"","key:",o,"value:",obj[o]);}}}if(str!=="nested"){log.info("End Print all values for ",str);}},trim:(function(){var reAllSpaceAtEnds=/^[\s\xA0]+|[\s\xA0]+$/g;var nativeTrim=String.prototype.trim;return(typeof nativeTrim==="function"?function(str){return Utils.isNull(str)?"":nativeTrim.call(str);}:function(str){return Utils.isNull(str)?"":String(str).replace(reAllSpaceAtEnds,"");});}()),now:(typeof Date.now==="function"?Date.now:function(){return(new Date()).getTime();}),getRandomInt:function(min,max){return(arguments.length===1?Math.floor(Math.random()*min):Math.floor(Math.random()*(max-min+1))+min);
},randomString:function(length){var str="";var i;var chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXTZabcdefghiklmnopqrstuvwxyz".split("");if(!length){length=Utils.getRandomInt(chars.length);}for(i=0;i<length;i++){str+=chars[Utils.getRandomInt(chars.length)];}return str;},replaceExtension:function(str,find,replace){if(empty(str)){return str;}return str.replace(new RegExp(find+"$","i"),replace);}};CVP.Utils.CommandQueue=Class.extend({init:function(){this._queue=[];},push:function(fn,scope,args){this._queue.push({fn:fn,scope:scope,args:args});},remove:function(index){index=typeof index!=="number"?this._queue.length-1:index;this._queue.splice(index,1);},execute:function(){var i=0,len=this._queue.length,cmd;for(;i<len;++i){cmd=this._queue[i];cmd.fn.apply(cmd.scope,cmd.args);}},executeAsync:function(delay){var i=0,len=this._queue.length,delay=CVP.Utils.undef(delay)?10:delay,cmd;if(len){cmd=this._queue.shift();cmd.fn.apply(cmd.scope,cmd.args);setTimeout(CVP.Utils.bind(this.executeAsync,this,delay),delay);}}});CVP.Utils.Asset=Class.extend({init:function(url,type){this._firedSuccess=false;this._url=url;this._type=CVP.Utils.empty(type)?this._determineType():type;this.id="cvp_asset_"+CVP.Utils.getRandomInt(1,1000);this.eSuccess=new CVP.Events.CustomEvent();this.eFailure=new CVP.Events.CustomEvent();},_determineType:function(){var ext=(CVP.Utils.empty(this._url))?"":this._url.substring(this._url.lastIndexOf(".")+1);return ext;},load:function(){switch(this._type){case"js":this._loadJs();break;case"css":this._loadCss();break;default:this._failure();}},_success:function(){this.eSuccess.dispatch();this._firedSuccess=true;},_failure:function(){this.eFailure.dispatch();},_loadJs:function(){var head=document.getElementsByTagName("head")[0];if(!head){this._failure();return;}var script=document.createElement("script");script.id=this.id;script.type="text/javascript";var successCB=CVP.Utils.bind(function(){if(this._firedSuccess){return;}this._success();script.onload=script.onreadystatechange=null;head.removeChild(script);},this);script.onload=successCB;script.onerror=CVP.Utils.bind(this._failure,this);script.onreadystatechange=function(){if(this.readyState==="loaded"||this.readyState==="complete"){successCB();}};script.src=this._url;head.appendChild(script);},_loadCss:function(){var node,head=document.getElementsByTagName("head")[0];if(!head){this._failure();return;}node=document.createElement("link");node.type="text/css";node.rel="stylesheet";node.href=this._url;node.media="screen";head.appendChild(node);this._success();}});CVP.Utils.Dependency=Class.extend({init:function(assetUrl,required){this._assetUrl=assetUrl;this.required=required;this._manager=null;this.eSuccess=new Event();this.eFailure=new Event();},load:function(){log.info("Dependency","loading asset",this._assetUrl);var assetLoader=new Asset(this._assetUrl);assetLoader.eSuccess.addListener(this._success,this);assetLoader.eFailure.addListener(this._failure,this);assetLoader.load();},_success:function(){log.info("Dependency","successfully loaded dependency",this._assetUrl);this.eSuccess.dispatch();},_failure:function(){log.error("Dependency","failed to load dependency",this._assetUrl);this.eFailure.dispatch();},setManager:function(manager){this._manager=manager;},getDesc:function(){return this._assetUrl;}});CVP.Utils.DependencyManager=Class.extend({init:function(){this._dependencies=[];this._currentDependency=null;this.eSuccess=new Event();this.eFailure=new Event();this.eDependencySuccess=new Event();this.eDependencyFailure=new Event();},addDependency:function(dependency){dependency.setManager(this);this._dependencies.push(dependency);},load:function(){this._currentDependency=this._dependencies.shift();this._currentDependency.eSuccess.addListener(this._onDependencySuccess,this);this._currentDependency.eFailure.addListener(this._onDependencyFailure,this);var self=this;setTimeout(function(){self._currentDependency.load();},10);},_onDependencySuccess:function(){this.eDependencySuccess.dispatch(this._currentDependency.getDesc());this._next();},_onDependencyFailure:function(){this.eDependencyFailure.dispatch(this._currentDependency.getDesc());if(this._currentDependency.required){this._onFailure(this._currentDependency.getDesc());return;}this._next();},_next:function(){if(this._dependencies.length){this.load();}else{this._onSuccess();}},_onSuccess:function(desc){this.eSuccess.dispatch(desc);},_onFailure:function(desc){this.eFailure.dispatch(desc);}});CVP.Utils.JsonConverter={ESCAPE_MATCH:/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,ESCAPE_MAPPING:{'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t"},ESCAPE_REPLACER:function(a){var map=this.ESCAPE_MAPPING;return a in map?map[a]:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);},_validateEscape:(debugFlag&&typeof JSON==="object"&&typeof JSON.parse==="function"),escapeString:function(string){var escaped="",test=null,validate=this._validateEscape,match=this.ESCAPE_MATCH,replacer=bind(this.ESCAPE_REPLACER,this);match.lastIndex=0;escaped='"'+(match.test(string)?string.replace(match,replacer):string)+'"';if(validate){try{test=JSON.parse('{"test": '+escaped+"}");if(test.test!==string){throw new Error("JsonConverter::escapeString failed to return a value that could be reconstituted into the original string");}}catch(e){throw e;}}return escaped;},getChildElements:function(node){var elements=[];var children=Array.prototype.slice.call(node.childNodes);for(var child,i=0,endi=children.length;i<endi;++i){child=children[i];if(child.nodeType===1){elements.push(child);}}return elements;},hasSimpleContent:function(node){var empty=CVP.Utils.empty;return((empty(node.attributes)||node.attributes.length===0)&&(empty(node.childNodes)||this.getChildElements(node).length===0));},getTextValue:function(node){var text=node.textContent||node.innerText||"";return Utils.trim(text).replace(/[\t\n\r\xA0]+/g," ");},convertNode:function(xml,ident,nodeType){var json="",first=false,i=0,endi=0,undef=CVP.Utils.undef,empty=CVP.Utils.empty;if(empty(ident)){ident="";}if(empty(nodeType)){nodeType="";}json=ident;if(nodeType===""){json+="{";}ident=ident+"\t";first=true;if(!empty(xml.attributes)){var attribute;for(endi=xml.attributes.length;i<endi;++i){attribute=xml.attributes[i];if(attribute.nodeName.indexOf("xmlns")===-1){if(first){first=false;json+="\n";}else{json+=",\n";}if(nodeType==="array"){json+=ident+"{";}else{json+=ident;}json+='"'+attribute.nodeName+'":'+this.escapeString(attribute.nodeValue);if(nodeType==="array"){json+="}";}}}}var type;var name;var children=this.getChildElements(xml);var node;for(i=0,endi=children.length;i<endi;++i){node=children[i];if(first){first=false;json+="\n";}else{json+=",\n";}name=node.nodeName;if(empty(name)){name="text";}json+=ident;if(nodeType==="array"){json+="{";}if(this.hasSimpleContent(node)){json+='"'+name+'":'+this.escapeString(this.getTextValue(node));}else{var isArray=this.isNodeAnArray(node);json+='"'+name+'":'+(isArray?"[":"{")+"\n";if(node.childNodes.length&&!this.getChildElements(node).length){json+='"text":'+this.escapeString(this.getTextValue(node))+",";}type=isArray?"array":"object";json+=this.convertNode(node,ident,type);}if(nodeType==="array"){json+="}";}}ident=ident.substr(0,ident.length-1);json+="\n"+ident;json+=(nodeType==="array")?"]":"}";return json;},isNodeAnArray:function(node){var elements=this.getChildElements(node);var names={};for(var element,i=0,endi=elements.length;i<endi;++i){element=elements[i];if(element.nodeName in names){return true;}else{names[element.nodeName]="exists";}}return false;},encodeXmlObject:function(xmlObj){var json=this.convertNode(xmlObj);return json;}};CVP.Utils.XML={createDoc:(CVP.Utils.undef(window.DOMParser)?function(xmlString){if(empty(xmlString)){return null;}var xDoc=new ActiveXObject("MSXML2.DOMDocument");xDoc.async=false;xDoc.loadXML(xmlString);if(!xDoc||xDoc.parseError&&xDoc.parseError.errorCode!==0){return null;
}return xDoc;}:function(xmlString){if(empty(xmlString)){return null;}var parser=new DOMParser();var xDoc=parser.parseFromString(xmlString,"text/xml");if(!xDoc||xDoc.getElementsByTagName("parsererror").length){return null;}return xDoc;}),clean:(function(){var allWhitespaceRE=/>\s+</g;var allTabsRE=/\t+/g;var allNewlinesRE=/[\r\n]+/g;var allCommentsRE=/<!--(.*?)-->/g;var allNonEntityAmpersandsRE=/&(?!amp;)/g;var allNamespacedAttrsRE=/xmlns(?::[^\s=]+)?=['"][^'"]*['"]/g;return function cleanString(xmlString){xmlString=xmlString.replace(allWhitespaceRE,"><");xmlString=xmlString.replace(allTabsRE," ");xmlString=xmlString.replace(allNewlinesRE," ");xmlString=xmlString.replace(allCommentsRE,"");xmlString=xmlString.replace(allNonEntityAmpersandsRE,"&amp;");xmlString=xmlString.replace(allNamespacedAttrsRE,"");return xmlString;};}()),getNodeValue:function(doc,nodeName){if(doc){if(!nodeName){return(!CVP.Utils.isNull(doc.firstChild)?doc.firstChild.nodeValue:null);}var nodes=doc.getElementsByTagName(nodeName);if(nodes.length>0&&nodes[0].firstChild){return nodes[0].firstChild.nodeValue;}}return null;},getParamValue:function(doc,paramName){var nodes,i=0,endi=0;if(doc){if(!paramName){return null;}nodes=doc.getElementsByTagName("param");for(endi=nodes.length;i<endi;++i){if(this.getAttribute(nodes[i],"name")===paramName){return this.getAttribute(nodes[i],"value");}}}return null;},getAttribute:function(node,attrName){if(node&&node.attributes&&!empty(attrName)){var attr=node.attributes.getNamedItem(attrName);return attr?attr.nodeValue:null;}},assignAttributes:function(obj,attributes){var a=0,end=(attributes&&attributes.length)||0,attr;for(;a<end;++a){attr=attributes[a];obj[attr.nodeName]=attr.nodeValue;}},toString:function(xmlDoc){if(undef(window.XMLSerializer)){this.toString=function(xmlDoc){return xmlDoc.xml;};}else{this.toString=function(xmlDoc){return new XMLSerializer().serializeToString(xmlDoc);};}return this.toString(xmlDoc);}};CVP.Utils.Timing={periodically:function(cb,ms){var timeout,count=0,tick=function(){cb(++count,ms);},start=function(){if(timeout){stop();}timeout=setInterval(tick,ms||1000);},stop=function(){clearInterval(timeout);};return{start:start,stop:stop};}};var Events=CVP.Events={};Events.onReady=function(handler){CVP.swfobject.addDomLoadEvent(handler);};Events.addListener=function(element,type,handler){if(element.addEventListener){element.addEventListener(type,handler,false);}else{if(!handler.$$guid){handler.$$guid=Events.addListener.guid++;}if(!element.events){element.events={};}var handlers=element.events[type];if(!handlers){handlers=element.events[type]={};if(element["on"+type]){handlers[0]=element["on"+type];}element["on"+type]=Events._handleEvent;}handlers[handler.$$guid]=handler;}};Events.addListener.guid=1;Events.removeListener=function(element,type,handler){if(element.removeEventListener){element.removeEventListener(type,handler,false);}else{if(element.events&&element.events[type]&&handler.$$guid){delete element.events[type][handler.$$guid];}}};Events._handleEvent=function(event){event=event||Events._fixEvent(window.event);var returnValue=true;var handlers=this.events[event.type];var i;for(i in handlers){if(hasOwn(handlers,i)){this.$$handler=handlers[i];if(this.$$handler(event)===false){returnValue=false;}}}if(this.$$handler){this.$$handler=null;}return returnValue;};Events._fixEvent=function(event){event.preventDefault=Events._fixEvent._preventDefault;event.stopPropagation=Events._fixEvent._stopPropagation;return event;};Events._fixEvent._preventDefault=function(){this.returnValue=false;};Events._fixEvent._stopPropagation=function(){this.cancelBubble=true;};Events.CustomEvent=Class.extend({init:function(type){this._type=type;this._listeners=[];},addListener:function(fn,scope){this._listeners.push({fn:fn,scope:scope});},removeListener:function(fn,scope){var i=0,len=this._listeners.length,o;for(;i<len;++i){o=this._listeners[i];if(o.fn===fn&&o.scope===scope){this._listeners.splice(i,1);break;}}},dispatch:function(){var i=0,len=this._listeners.length,o;for(;i<len;++i){o=this._listeners[i];o.fn.apply(o.scope,arguments);}}});CVP.Players={};CVP.Players.NullPlayer=Class.extend({init:function(){var functions="play replay playNextInQueue pause resume stop queue dequeue emptyQueue setQueueAutoplay getQueue seek mute unmute setVolume getVolume isMuted getContentEntry goFullscreen resize setMaxBitrate switchBitrateId setAutoBitrateSwitch getAvailableBitrates getBitrateId setGroupOrder getShareOptions setAdSection setAdKeyValue setAdExchangeValue setAdVisibility switchAdContext switchTrackingContext setDataSrc setFileKey sendUIMessage".split(" "),f=0,endf=functions.length,noop=function(){},fn;for(;f<endf;++f){fn=functions[f];if(!this[fn]){this[fn]=noop;}}}});CVP.Players.HTML5=CVP.Players.NullPlayer.extend({init:function(options){this._super();this._options=options;this._loadQ=new CVP.Utils.CommandQueue();this._loaded=false;this._instance=new CVP.Players._HTML5Player(this._options);this._instance.ePlayerLoaded.addListener(this._onPlayerLoaded,this);this._instance.ePlayerLoadError.addListener(this._onPlayerLoadError,this);this._instance.ePlayerReady.addListener(this._onPlayerReady,this);this._instance.ePlayerReady.addListener(this._onCVPReady,this);this._instance.ePlayerReady.addListener(bind(this._onCallBack,this,"onPlayerReady"));this._instance.ePlayerReady.addListener(bind(this._onCallBack,this,"onCVPReady"));this._instance.eContentBegin.addListener(bind(this._onCallBack,this,"onContentBegin"));this._instance.eContentPlay.addListener(bind(this._onCallBack,this,"onContentPlay"));this._instance.eContentPause.addListener(bind(this._onCallBack,this,"onContentPause"));this._instance.eContentEnd.addListener(bind(this._onCallBack,this,"onContentEnd"));this._instance.eContentComplete.addListener(bind(this._onCallBack,this,"onContentComplete"));this._instance.eContentMetadata.addListener(bind(this._onCallBack,this,"onContentMetadata"));this._instance.eContentPlayhead.addListener(bind(this._onCallBack,this,"onContentPlayhead"));this._instance.eContentBuffering.addListener(bind(this._onCallBack,this,"onContentBuffering"));this._instance.eContentResize.addListener(bind(this._onCallBack,this,"onContentResize"));this._instance.eContentVolume.addListener(bind(this._onCallBack,this,"onContentVolume"));this._instance.eContentError.addListener(bind(this._onCallBack,this,"onContentError"));this._instance.eAdPlayhead.addListener(bind(this._onCallBack,this,"onAdPlayhead"));this._instance.eAdPlay.addListener(bind(this._onCallBack,this,"onAdPlay"));this._instance.eAdEnd.addListener(bind(this._onCallBack,this,"onAdEnd"));this._instance.eAdError.addListener(bind(this._onCallBack,this,"onAdError"));this._instance.eTrackingAdStart.addListener(bind(this._onCallBack,this,"onTrackingAdStart"));this._instance.eTrackingAdComplete.addListener(bind(this._onCallBack,this,"onTrackingAdComplete"));this._instance.eTrackingAdCountdown.addListener(bind(this._onCallBack,this,"onTrackingAdCountdown"));this._instance.eTrackingContentPlay.addListener(bind(this._onCallBack,this,"onTrackingContentPlay"));this._instance.eTrackingContentBegin.addListener(bind(this._onCallBack,this,"onTrackingContentBegin"));this._instance.eTrackingContentComplete.addListener(bind(this._onCallBack,this,"onTrackingContentComplete"));this._instance.eTrackingContentSeek.addListener(bind(this._onCallBack,this,"onTrackingContentSeek"));this._instance.eTrackingContentSeekEnd.addListener(bind(this._onCallBack,this,"onTrackingContentSeekEnd"));this._instance.eTrackingFullscreen.addListener(bind(this._onCallBack,this,"onTrackingFullscreen"));this._instance.eTrackingMuted.addListener(bind(this._onCallBack,this,"onTrackingMuted"));this._instance.eTrackingPaused.addListener(bind(this._onCallBack,this,"onTrackingPaused"));},_onPlayerLoaded:function(){log.debug("_onPlayerLoaded");this._loaded=true;this._loadQ.execute();},_onPlayerLoadError:function(){log.debug("_onPlayerLoadError");this._onCallBack("onPlayerLoadError");},_onPlayerReady:function(){log.debug("_onPlayerReady");
},_onCVPReady:function(){log.debug("_onCVPReady");},embed:function(containerElement){if(!this._loaded){log.info("queuing embed");this._loadQ.push(this.embed,this,arguments);return;}log.info("executing embed");this._instance.render(containerElement);},remove:function(){this._instance.remove();},playContent:function(contentId,options){this._instance.play(contentId,options);},queue:function(contentId,options){this._instance.queue(contentId,options);},pause:function(){this._instance.pause();},resume:function(){this._instance.resume();},seek:function(seconds){this._instance.seek(seconds);},resize:function(width,height){this._instance.resize(width,height);},goFullscreen:function(){this._instance.goFullscreen();},setVolume:function(v){this._instance.setVolume(v);},getVolume:function(){return this._instance.getVolume();},mute:function(){this._instance.mute();},unmute:function(){this._instance.unmute();},getContentEntry:function(id){return this._instance.getContentEntry(id);},setAdSection:function(ssid){this._instance.setAdSection(ssid);},setAdKeyValue:function(key,value){this._instance.setAdKeyValue(key,value);},_onCallBack:function(){CVP.onCallback(this._options.id,arguments);},instance:function(){return this._instance;},supported:function(){return !!document.createElement("video").canPlayType;}});var Ajax=CVP.Ajax={get:function(obj){obj.type="GET";this._request(obj);},getXml:function(obj){obj.dataType="xml";this.get(obj);},getJSON:function(obj){var success=obj.success;obj.dataType="json";if(success){obj.success=function(text){var json=JSON.parse(text);success(json);};}this.get(obj);},getJSONP:function(obj){this.JSONP._request(obj);},post:function(obj){obj.type="POST";this._request(obj);},_request:function(obj){var request=new XMLHttpRequest();request.onreadystatechange=function(){if(request.readyState===4){if((200<=request.status&&request.status<300)||request.status===304){if(obj.success){obj.success(request.responseText);}}else{if(obj.error){obj.error(request);}}request.onreadystatechange=Function.prototype;request.abort();request=null;}};request.open(obj.type,obj.url,true);request.send(obj.type==="POST"?obj.data:null);}};Ajax.JSONP={requestTimeout:5000,maxRetries:0,_externalRoutes:{},requestMap:{},_counter:0,_request:function(obj){obj=extend({timeout:this.requestTimeout,maxRetries:this.maxRetries},obj);obj.tries=0;log.debug("JSONP - creating request with timeout ",obj.timeout," and maxRetries ",obj.maxRetries);this._sendRequest(obj);},_sendRequest:function(obj){var self=this;var requestId=this._createCallback(obj);var script=this._createScript(requestId);if(!script){log.error("JSONP - unable to create script for request ",obj.url);throw new Error("JSONP - unable to create script for request "+obj.url);}script.src=obj.url;if(obj.timeout){setTimeout(function(){self._onError(requestId,obj);},obj.timeout);}},_onSuccess:function(id,obj,data){if(!this.requestMap[id]){return;}this._destroyRequest(id,obj);if(isString(data)){try{data=JSON.parse(data);}catch(e1){log.warn("JSON.parse failed - falling back to eval");try{data=eval("("+data+")");}catch(e2){log.error("eval data failed");}}}if(obj.success){log.info("JSONP","success",obj.url);obj.success(data);}},_onError:function(id,obj){if(!this.requestMap[id]){return;}this._destroyRequest(id,obj);++obj.tries;if(obj.maxRetries&&obj.tries<obj.maxRetries){log.warn("Request failed - resending");this._sendRequest(obj);return;}if(obj.error){log.error("JSONP","error",obj.url);obj.error(obj.url);}},_destroyRequest:function(id,obj){this._deregisterExternalCallback(obj.jsonpCallback,id);delete this.requestMap[id];this._counter--;var script=document.getElementById(this._getScriptName(id));if(script){script.parentNode.removeChild(script);script=null;}},_createScript:function(id){var head,script;head=document.getElementsByTagName("head")[0];if(!head){return false;}script=document.createElement("script");script.type="text/javascript";if(id){script.id=this._getScriptName(id);}head.appendChild(script);return script;},_getScriptName:function(id){return"cvp_jsonp_"+id;},_createCallback:function(obj){var self=this;if(empty(obj.jsonpCallback)){return null;}++this._counter;var id="request_"+this._counter+"_"+now();this.requestMap[id]=function(data){self._onSuccess(id,obj,data);};var cb=function(data){log.debug("JSONP","Internal CB received for request:",id);if(self.requestMap[id]){self.requestMap[id](data);}else{log.debug("Request response came in after allotted time: ",id);}};this._registerExternalCallback(obj.jsonpCallback,id,cb);return id;},_registerExternalCallback:function(name,id,cb){if(!window[name]){this._createExternalCallback(name,this._routeExternalCallback(name));}if(!this._externalRoutes[name]){this._externalRoutes[name]=[];}this._externalRoutes[name].push({id:id,cb:cb});},_routeExternalCallback:function(name){var self=this;return function(data){log.info("JSONP","routing:",name);if(!self._externalRoutes){log.error("JSONP","routes haven't been initialized");return;}if(!self._externalRoutes[name]){log.error("JSONP","routing hasn't been initialized for:",name);return;}if(!self._externalRoutes[name].length){log.error("JSONP","no waiting requests for route:",name);return;}var request=self._externalRoutes[name].shift();log.info("JSONP","request retrieved - id: ",request.id,"cb:",typeof request.cb);if(request.cb){request.cb(data);}};},_createExternalCallback:function(name,cb){window[name]=cb;},_deregisterExternalCallback:function(name,id){for(var i=0,len=this._externalRoutes[name].length;i<len;i++){var request=this._externalRoutes[name][i];if(request.id===id){log.info("JSONP","removing request from route:",name,"with id:",id);this._externalRoutes[name].splice(i,1);return;}}}};CVP.Plugins={};CVP.PluginManager=(function(){var extend=CVP.Utils.extend,hasOwn=CVP.Utils.hasOwn,slice=CVP.Utils.slice,isFunc=CVP.Utils.isFunc,now=CVP.Utils.now;var logger=CVP.Log.getLogger("PluginManager");var pluginTypes={LMDB:"lmdb"};var pluginRegistry={};var registerPlugin=function(type,constructFunc){type=(type||"").toUpperCase();if(!pluginTypes[type]){logger.warn("[registerPlugin] Invalid plugin type. Unable to register: "+type);return;}pluginRegistry[type]=constructFunc;};var PluginFactory={};PluginFactory.create=function(type,options){type=(type||"").toUpperCase();if(!pluginRegistry[type]){logger.warn("[create] Invalid plugin type. Unable to create: "+type);return null;}return new pluginRegistry[type](options);};PluginFactory.createLMDB=function(options){return PluginFactory.create(pluginTypes.LMDB,options);};var pluginHostInstances={};var registerPluginHost=function(id,pluginAdapter){pluginHostInstances[id]=pluginAdapter;};var PluginHostAdapter=function(id,getHost,plugin){var self=this;this.id=id;if(!getHost||!plugin){logger.error("[PluginHostAdapter] Invalid host or plugin. Aborting");return null;}var delegateToPlugin=function(method){return function(){return plugin[method].apply(plugin,arguments);};};for(var prop in plugin){if(isFunc(plugin[prop])){this[prop]=delegateToPlugin(prop);}}var forwardEventToHost=function(eventName){var host=getHost();return function(){host["_sendToPluginHost"](self.id,eventName,slice(arguments));};};for(var eventName in plugin.getEvents()){plugin.on(eventName,forwardEventToHost(eventName));}};PluginHostAdapter.create=function(domId,playerId,pluginType,pluginOptions){var id=[domId,playerId,pluginType,now()].join("_");var host=function(){var instance=CVP.findInstance(domId);return instance.getDOMPlayer();};var plugin=PluginFactory.create(pluginType,pluginOptions);return new PluginHostAdapter(id,host,plugin);};var onPluginHostRequest=function(cvpDomId,args){var pluginId=args.shift(),method=args.shift(),pluginAdapter=null;logger.debug("[onPluginHostAPIRequest] request received: "+pluginId+", "+method);if(!pluginId){if(method!="create"){logger.error("[onPluginHostAPIRequest] Invalid create method passed");return null;}pluginAdapter=PluginHostAdapter[method].apply(PluginHostAdapter,[cvpDomId].concat(args));registerPluginHost(pluginAdapter.id,pluginAdapter);
return pluginAdapter.id;}pluginAdapter=pluginHostInstances[pluginId];try{return pluginAdapter[method].apply(pluginAdapter,args);}catch(e){logger.warn("[onPluginHostAPIRequest] Unable to call method: "+method+" on plugin: "+pluginId);}};var exports={register:registerPlugin};exports=extend(exports,pluginTypes);exports=extend(exports,PluginFactory);exports.onPluginHostRequest=onPluginHostRequest;return exports;})();(function(){var logger=CVP.Log.getLogger("LMDB"),Class=CVP.Class,undef=CVP.Utils.undef;var Transport=Class.extend({init:function(lazy){logger.debug("[Transport.init]");var self=this;this.ready=false;this.queue=new CVP.Utils.CommandQueue();this.events={dataReceived:new CVP.Events.CustomEvent("dataReceived"),dataReceivedError:new CVP.Events.CustomEvent("dataReceivedError")};this.channelId=Transport.nextChannel();Transport.registerInstance(this);lazy=(undef(lazy))?false:lazy;if(!lazy){Transport.loadDependencies();}},onReady:function(){logger.debug("[Transport.onReady] channel: "+this.channelId);this.createListeners();this.ready=true;this.queue.executeAsync();},createListeners:function(){var self=this;CVP.Store.set(Transport.getResponseCallback(this.channelId),function(url,data){setTimeout(function(){self.fireDataReceived(url,data);},0);});CVP.Store.set(Transport.getResponseErrorCallback(this.channelId),function(url,error){setTimeout(function(){self.fireDataReceivedError(url,error);},0);});},request:function(url){if(!Transport.dependenciesLoaded){Transport.loadDependencies();}if(!this.ready){this.queue.push(this.request,this,arguments);return;}logger.debug("[Transport.request] channel: "+this.channelId);Transport.getSwf().request(this.channelId,url);},on:function(type,cb){if(!this.events.hasOwnProperty(type)){return;}this.events[type].addListener(cb);},fireDataReceived:function(url,data){this.events["dataReceived"].dispatch(url,data);},fireDataReceivedError:function(url,error){this.events["dataReceivedError"].dispatch(url,error);}});Transport.instances=[];Transport.registerInstance=function(instance){var instanceObj={instance:instance,ready:false};if(Transport.dependenciesLoaded){instance.onReady();instanceObj.ready=true;}Transport.instances.push(instanceObj);};Transport.callPrefix="cvp_flash_xhr_lmdb";Transport.readySuffix="ready";Transport.responseSuffix="response";Transport.responseErrorSuffix="response_error";Transport.getReadyCallback=function(){return[Transport.callPrefix,Transport.readySuffix].join("_");};Transport.getResponseCallback=function(channelId){return[Transport.callPrefix,channelId,Transport.responseSuffix].join("_");},Transport.getResponseErrorCallback=function(channelId){return[Transport.callPrefix,channelId,Transport.responseErrorSuffix].join("_");},Transport.channelIndex=0;Transport.nextChannel=function(){return"lmdb."+(++Transport.channelIndex);};Transport.dependenciesLoading=false;Transport.dependenciesLoaded=false;Transport.loadDependencies=function(){if(Transport.dependenciesLoading||Transport.dependenciesLoaded){return;}Transport.dependenciesLoading=true;Transport.embed(CVP.Utils.bind(Transport.onDependenciesLoaded,Transport));};Transport.onDependenciesLoaded=function(){Transport.dependenciesLoading=false;Transport.dependenciesLoaded=true;var instances=Transport.instances;for(var i=0;i<instances.length;i++){if(!instances[i].ready){instances[i].instance.onReady();instances[i].ready=true;}}};Transport.swfId="cvpXhrFlash";Transport.swfUrl="http://z.cdn.turner.com/xslo/cvp/plugins/cvp/xhr/1.0/cvp_flashXhr.swf";Transport.getSwf=function(){return document.getElementById(Transport.swfId);};Transport.embed=function(cb){logger.debug("[Transport.embed] Checking if xhr is required on the page");var self=this;var swfUrl=Transport.swfUrl;var swfId=Transport.swfId;if(Transport.getSwf()){logger.debug("[Transport.embed] cvpXhrFlash already present on the page. Proceeding.");cb&&cb();return;}if(!CVP.swfobject){logger.debug("[Transport.embed] swfobject not ready. Delaying.");setTimeout(function(){Transport.embed(cb);},100);return;}var swfContainerId=this.swfId+"_container";var swfContainer=document.createElement("div");swfContainer.id=swfContainerId;swfContainer.style.height="1px";swfContainer.style.width="1px";swfContainer.style.position="absolute";swfContainer.style.overflow="hidden";swfContainer.style.right=0;swfContainer.style.top=0;document.body.appendChild(swfContainer);CVP.Store.set(Transport.getReadyCallback(),function(){logger.debug("[Transport.ready] Callback received");cb&&cb();});var flashvars={callPrefix:this.callPrefix,log:"true"};var params={menu:"false",scale:"noScale",allowFullscreen:"true",allowScriptAccess:"always",bgcolor:"#FFFFFF"};var attributes={id:swfId};logger.debug("[Transport.embed] Embedding xhr swf");CVP.swfobject.embedSWF(swfUrl,swfContainerId,"10","10","8.0.0","expressInstall.swf",flashvars,params,attributes);};var createLMDBTimer=function(cb,ms){return new CVP.Utils.Timing.periodically(cb,ms);};var isXML=function(data){return(data&&data.indexOf("<")===0&&data.lastIndexOf(">")===(data.length-1));};var convertToJSON=function(xmlStr){return CVP.Utils.JsonConverter.encodeXmlObject(CVP.Utils.XML.createDoc(xmlStr));};var evalJSON=function(json){return JSON.parse(json);};var LMDB=Class.extend({init:function(options){var self=this;this.setOptions(options);this.events={dataReceived:new CVP.Events.CustomEvent("dataReceived"),dataReceivedError:new CVP.Events.CustomEvent("dataReceivedError")};var onDataReceived=function(url,data){logger.debug("[LMDB.onDataReceived] url: "+url);if(isXML(data)&&self.options.convertXML){logger.debug("[LMDB.onDataReceived] Detected XML - converting");data=convertToJSON(data);}self.events["dataReceived"].dispatch(url,evalJSON(data));};var onDataReceivedError=function(url,error){logger.debug("[LMDB.onDataReceivedError] url: "+url);self.events["dataReceivedError"].dispatch(url,error);};this._transport=new Transport(this.options.lazy);this._transport.on("dataReceived",onDataReceived);this._transport.on("dataReceivedError",onDataReceivedError);},setOptions:function(options){var defaultOptions={convertXML:true};this.options=CVP.Utils.extend((this.options||defaultOptions),(options||{}));logger.debug("[LMDB.setOptions] url: "+this.options.url+", interval: "+this.options.interval);if(this.options.interval&&this.options.url){if(parseInt(this.options.interval)<=0){return;}logger.debug("[LMDB.setOptions] creating timer with interval: "+this.options.interval);this.periodical&&this.periodical.stop();this.periodical=createLMDBTimer(CVP.Utils.bind(this.request,this,this.options.url),this.options.interval);}},getEvents:function(){return this.events;},request:function(url){logger.info("[LMDB.request] url: "+url);this._transport.request(url);},on:function(type,cb){if(!this.events.hasOwnProperty(type)){return;}this.events[type].addListener(CVP.Utils.bind(cb,this));},start:function(immediate){logger.debug("[LMDB.start]");if(typeof immediate==="undefined"){immediate=true;}if(!this.periodical){return;}this.periodical.start();if(immediate){this.request(this.options.url);}},stop:function(){this.periodical&&this.periodical.stop();},getScheduleItems:function(data){var items=[];if(data&&data.hasOwnProperty("LiveFeed")){if(data.LiveFeed.hasOwnProperty("tveLiveSched")){if(data.LiveFeed.tveLiveSched.hasOwnProperty("SchedItem")){return items.concat(data.LiveFeed.tveLiveSched.SchedItem);}}}return items;},getScheduleItem:function(data,filter){var items=this.getScheduleItems(data);var first=(typeof filter==="undefined");var isFunc=CVP.Utils.isFunc(filter);for(var i=0;i<items.length;i++){if(first){return items[i];}if(isFunc){if(filter(items[i])){return items[i];}}else{if(items[i].AiringID==filter){return items[i];}}}return null;}});CVP.PluginManager.register(CVP.PluginManager.LMDB,LMDB);CVP.Plugins.LMDB=CVP.PluginManager.createLMDB({lazy:true});})();CVP.swfobject=function(){var UNDEF="undefined",OBJECT="object",SHOCKWAVE_FLASH="Shockwave Flash",SHOCKWAVE_FLASH_AX="ShockwaveFlash.ShockwaveFlash",FLASH_MIME_TYPE="application/x-shockwave-flash",EXPRESS_INSTALL_ID="SWFObjectExprInst",ON_READY_STATE_CHANGE="onreadystatechange",win=window,doc=document,nav=navigator,plugin=false,domLoadFnArr=[main],regObjArr=[],objIdArr=[],listenersArr=[],storedAltContent,storedAltContentId,storedCallbackFn,storedCallbackObj,isDomLoaded=false,isExpressInstallActive=false,dynamicStylesheet,dynamicStylesheetMedia,autoHideShow=true,ua=function(){var w3cdom=typeof doc.getElementById!=UNDEF&&typeof doc.getElementsByTagName!=UNDEF&&typeof doc.createElement!=UNDEF,u=nav.userAgent.toLowerCase(),p=nav.platform.toLowerCase(),windows=p?/win/.test(p):/win/.test(u),mac=p?/mac/.test(p):/mac/.test(u),webkit=/webkit/.test(u)?parseFloat(u.replace(/^.*webkit\/(\d+(\.\d+)?).*$/,"$1")):false,ie=!+"\v1",playerVersion=[0,0,0],d=null;
if(typeof nav.plugins!=UNDEF&&typeof nav.plugins[SHOCKWAVE_FLASH]==OBJECT){d=nav.plugins[SHOCKWAVE_FLASH].description;if(d&&!(typeof nav.mimeTypes!=UNDEF&&nav.mimeTypes[FLASH_MIME_TYPE]&&!nav.mimeTypes[FLASH_MIME_TYPE].enabledPlugin)){plugin=true;ie=false;d=d.replace(/^.*\s+(\S+\s+\S+$)/,"$1");playerVersion[0]=parseInt(d.replace(/^(.*)\..*$/,"$1"),10);playerVersion[1]=parseInt(d.replace(/^.*\.(.*)\s.*$/,"$1"),10);playerVersion[2]=/[a-zA-Z]/.test(d)?parseInt(d.replace(/^.*[a-zA-Z]+(.*)$/,"$1"),10):0;}}else{if(typeof win.ActiveXObject!=UNDEF){try{var a=new ActiveXObject(SHOCKWAVE_FLASH_AX);if(a){d=a.GetVariable("$version");if(d){ie=true;d=d.split(" ")[1].split(",");playerVersion=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}}}catch(e){}}}return{w3:w3cdom,pv:playerVersion,wk:webkit,ie:ie,win:windows,mac:mac};}(),onDomLoad=function(){if(!ua.w3){return;}if((typeof doc.readyState!=UNDEF&&doc.readyState=="complete")||(typeof doc.readyState==UNDEF&&(doc.getElementsByTagName("body")[0]||doc.body))){callDomLoadFunctions();}if(!isDomLoaded){if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("DOMContentLoaded",callDomLoadFunctions,false);}if(ua.ie&&ua.win){doc.attachEvent(ON_READY_STATE_CHANGE,function(){if(doc.readyState=="complete"){doc.detachEvent(ON_READY_STATE_CHANGE,arguments.callee);callDomLoadFunctions();}});if(win==top){(function(){if(isDomLoaded){return;}try{doc.documentElement.doScroll("left");}catch(e){setTimeout(arguments.callee,0);return;}callDomLoadFunctions();})();}}if(ua.wk){(function(){if(isDomLoaded){return;}if(!/loaded|complete/.test(doc.readyState)){setTimeout(arguments.callee,0);return;}callDomLoadFunctions();})();}addLoadEvent(callDomLoadFunctions);}}();function callDomLoadFunctions(){if(isDomLoaded){return;}try{var t=doc.getElementsByTagName("body")[0].appendChild(createElement("span"));t.parentNode.removeChild(t);}catch(e){return;}isDomLoaded=true;var dl=domLoadFnArr.length;for(var i=0;i<dl;i++){domLoadFnArr[i]();}}function addDomLoadEvent(fn){if(isDomLoaded){fn();}else{domLoadFnArr[domLoadFnArr.length]=fn;}}function addLoadEvent(fn){if(typeof win.addEventListener!=UNDEF){win.addEventListener("load",fn,false);}else{if(typeof doc.addEventListener!=UNDEF){doc.addEventListener("load",fn,false);}else{if(typeof win.attachEvent!=UNDEF){addListener(win,"onload",fn);}else{if(typeof win.onload=="function"){var fnOld=win.onload;win.onload=function(){fnOld();fn();};}else{win.onload=fn;}}}}}function main(){if(plugin){testPlayerVersion();}else{matchVersions();}}function testPlayerVersion(){var b=doc.getElementsByTagName("body")[0];var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);var t=b.appendChild(o);if(t){var counter=0;(function(){if(typeof t.GetVariable!=UNDEF){var d=t.GetVariable("$version");if(d){d=d.split(" ")[1].split(",");ua.pv=[parseInt(d[0],10),parseInt(d[1],10),parseInt(d[2],10)];}}else{if(counter<10){counter++;setTimeout(arguments.callee,10);return;}}b.removeChild(o);t=null;matchVersions();})();}else{matchVersions();}}function matchVersions(){var rl=regObjArr.length;if(rl>0){for(var i=0;i<rl;i++){var id=regObjArr[i].id;var cb=regObjArr[i].callbackFn;var cbObj={success:false,id:id};if(ua.pv[0]>0){var obj=getElementById(id);if(obj){if(hasPlayerVersion(regObjArr[i].swfVersion)&&!(ua.wk&&ua.wk<312)){setVisibility(id,true);if(cb){cbObj.success=true;cbObj.ref=getObjectById(id);cb(cbObj);}}else{if(regObjArr[i].expressInstall&&canExpressInstall()){var att={};att.data=regObjArr[i].expressInstall;att.width=obj.getAttribute("width")||"0";att.height=obj.getAttribute("height")||"0";if(obj.getAttribute("class")){att.styleclass=obj.getAttribute("class");}if(obj.getAttribute("align")){att.align=obj.getAttribute("align");}var par={};var p=obj.getElementsByTagName("param");var pl=p.length;for(var j=0;j<pl;j++){if(p[j].getAttribute("name").toLowerCase()!="movie"){par[p[j].getAttribute("name")]=p[j].getAttribute("value");}}showExpressInstall(att,par,id,cb);}else{displayAltContent(obj);if(cb){cb(cbObj);}}}}}else{setVisibility(id,true);if(cb){var o=getObjectById(id);if(o&&typeof o.SetVariable!=UNDEF){cbObj.success=true;cbObj.ref=o;}cb(cbObj);}}}}}function getObjectById(objectIdStr){var r=null;var o=getElementById(objectIdStr);if(o&&o.nodeName=="OBJECT"){if(typeof o.SetVariable!=UNDEF){r=o;}else{var n=o.getElementsByTagName(OBJECT)[0];if(n){r=n;}}}return r;}function canExpressInstall(){return !isExpressInstallActive&&hasPlayerVersion("6.0.65")&&(ua.win||ua.mac)&&!(ua.wk&&ua.wk<312);}function showExpressInstall(att,par,replaceElemIdStr,callbackFn){isExpressInstallActive=true;storedCallbackFn=callbackFn||null;storedCallbackObj={success:false,id:replaceElemIdStr};var obj=getElementById(replaceElemIdStr);if(obj){if(obj.nodeName=="OBJECT"){storedAltContent=abstractAltContent(obj);storedAltContentId=null;}else{storedAltContent=obj;storedAltContentId=replaceElemIdStr;}att.id=EXPRESS_INSTALL_ID;if(typeof att.width==UNDEF||(!/%$/.test(att.width)&&parseInt(att.width,10)<310)){att.width="310";}if(typeof att.height==UNDEF||(!/%$/.test(att.height)&&parseInt(att.height,10)<137)){att.height="137";}doc.title=doc.title.slice(0,47)+" - Flash Player Installation";var pt=ua.ie&&ua.win?"ActiveX":"PlugIn",fv="MMredirectURL="+win.location.toString().replace(/&/g,"%26")+"&MMplayerType="+pt+"&MMdoctitle="+doc.title;if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+fv;}else{par.flashvars=fv;}if(ua.ie&&ua.win&&obj.readyState!=4){var newObj=createElement("div");replaceElemIdStr+="SWFObjectNew";newObj.setAttribute("id",replaceElemIdStr);obj.parentNode.insertBefore(newObj,obj);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj);}else{setTimeout(arguments.callee,10);}})();}createSWF(att,par,replaceElemIdStr);}}function displayAltContent(obj){if(ua.ie&&ua.win&&obj.readyState!=4){var el=createElement("div");obj.parentNode.insertBefore(el,obj);el.parentNode.replaceChild(abstractAltContent(obj),el);obj.style.display="none";(function(){if(obj.readyState==4){obj.parentNode.removeChild(obj);}else{setTimeout(arguments.callee,10);}})();}else{obj.parentNode.replaceChild(abstractAltContent(obj),obj);}}function abstractAltContent(obj){var ac=createElement("div");if(ua.win&&ua.ie){ac.innerHTML=obj.innerHTML;}else{var nestedObj=obj.getElementsByTagName(OBJECT)[0];if(nestedObj){var c=nestedObj.childNodes;if(c){var cl=c.length;for(var i=0;i<cl;i++){if(!(c[i].nodeType==1&&c[i].nodeName=="PARAM")&&!(c[i].nodeType==8)){ac.appendChild(c[i].cloneNode(true));}}}}}return ac;}function createSWF(attObj,parObj,id){var r,el=getElementById(id);if(ua.wk&&ua.wk<312){return r;}if(el){if(typeof attObj.id==UNDEF){attObj.id=id;}if(ua.ie&&ua.win){var att="";for(var i in attObj){if(attObj[i]!=Object.prototype[i]){if(i.toLowerCase()=="data"){parObj.movie=attObj[i];}else{if(i.toLowerCase()=="styleclass"){att+=' class="'+attObj[i]+'"';}else{if(i.toLowerCase()!="classid"){att+=" "+i+'="'+attObj[i]+'"';}}}}}var par="";for(var j in parObj){if(parObj[j]!=Object.prototype[j]){par+='<param name="'+j+'" value="'+parObj[j]+'" />';}}el.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+att+">"+par+"</object>";objIdArr[objIdArr.length]=attObj.id;r=getElementById(attObj.id);}else{var o=createElement(OBJECT);o.setAttribute("type",FLASH_MIME_TYPE);for(var m in attObj){if(attObj[m]!=Object.prototype[m]){if(m.toLowerCase()=="styleclass"){o.setAttribute("class",attObj[m]);}else{if(m.toLowerCase()!="classid"){o.setAttribute(m,attObj[m]);}}}}for(var n in parObj){if(parObj[n]!=Object.prototype[n]&&n.toLowerCase()!="movie"){createObjParam(o,n,parObj[n]);}}el.parentNode.replaceChild(o,el);r=o;}}return r;}function createObjParam(el,pName,pValue){var p=createElement("param");p.setAttribute("name",pName);p.setAttribute("value",pValue);el.appendChild(p);}function removeSWF(id){var obj=getElementById(id);if(obj&&obj.nodeName=="OBJECT"){if(ua.ie&&ua.win){obj.style.display="none";(function(){if(obj.readyState==4){removeObjectInIE(id);}else{setTimeout(arguments.callee,10);
}})();}else{obj.parentNode.removeChild(obj);}}}function removeObjectInIE(id){var obj=getElementById(id);if(obj){for(var i in obj){if(typeof obj[i]=="function"){obj[i]=null;}}obj.parentNode.removeChild(obj);}}function getElementById(id){var el=null;try{el=doc.getElementById(id);}catch(e){}return el;}function createElement(el){return doc.createElement(el);}function addListener(target,eventType,fn){target.attachEvent(eventType,fn);listenersArr[listenersArr.length]=[target,eventType,fn];}function hasPlayerVersion(rv){var pv=ua.pv,v=rv.split(".");v[0]=parseInt(v[0],10);v[1]=parseInt(v[1],10)||0;v[2]=parseInt(v[2],10)||0;return(pv[0]>v[0]||(pv[0]==v[0]&&pv[1]>v[1])||(pv[0]==v[0]&&pv[1]==v[1]&&pv[2]>=v[2]))?true:false;}function createCSS(sel,decl,media,newStyle){if(ua.ie&&ua.mac){return;}var h=doc.getElementsByTagName("head")[0];if(!h){return;}var m=(media&&typeof media=="string")?media:"screen";if(newStyle){dynamicStylesheet=null;dynamicStylesheetMedia=null;}if(!dynamicStylesheet||dynamicStylesheetMedia!=m){var s=createElement("style");s.setAttribute("type","text/css");s.setAttribute("media",m);dynamicStylesheet=h.appendChild(s);if(ua.ie&&ua.win&&typeof doc.styleSheets!=UNDEF&&doc.styleSheets.length>0){dynamicStylesheet=doc.styleSheets[doc.styleSheets.length-1];}dynamicStylesheetMedia=m;}if(ua.ie&&ua.win){if(dynamicStylesheet&&typeof dynamicStylesheet.addRule==OBJECT){dynamicStylesheet.addRule(sel,decl);}}else{if(dynamicStylesheet&&typeof doc.createTextNode!=UNDEF){dynamicStylesheet.appendChild(doc.createTextNode(sel+" {"+decl+"}"));}}}function setVisibility(id,isVisible){if(!autoHideShow){return;}var v=isVisible?"visible":"hidden";if(isDomLoaded&&getElementById(id)){getElementById(id).style.visibility=v;}else{createCSS("#"+id,"visibility:"+v);}}function urlEncodeIfNecessary(s){var regex=/[\\\"<>\.;]/;var hasBadChars=regex.exec(s)!=null;return hasBadChars&&typeof encodeURIComponent!=UNDEF?encodeURIComponent(s):s;}var cleanup=function(){if(ua.ie&&ua.win){window.attachEvent("onunload",function(){var ll=listenersArr.length;for(var i=0;i<ll;i++){listenersArr[i][0].detachEvent(listenersArr[i][1],listenersArr[i][2]);}var il=objIdArr.length;for(var j=0;j<il;j++){removeSWF(objIdArr[j]);}for(var k in ua){ua[k]=null;}ua=null;for(var l in CVP.swfobject){CVP.swfobject[l]=null;}CVP.swfobject=null;});}}();return{registerObject:function(objectIdStr,swfVersionStr,xiSwfUrlStr,callbackFn){if(ua.w3&&objectIdStr&&swfVersionStr){var regObj={};regObj.id=objectIdStr;regObj.swfVersion=swfVersionStr;regObj.expressInstall=xiSwfUrlStr;regObj.callbackFn=callbackFn;regObjArr[regObjArr.length]=regObj;setVisibility(objectIdStr,false);}else{if(callbackFn){callbackFn({success:false,id:objectIdStr});}}},getObjectById:function(objectIdStr){if(ua.w3){return getObjectById(objectIdStr);}},embedSWF:function(swfUrlStr,replaceElemIdStr,widthStr,heightStr,swfVersionStr,xiSwfUrlStr,flashvarsObj,parObj,attObj,callbackFn){var callbackObj={success:false,id:replaceElemIdStr};if(ua.w3&&!(ua.wk&&ua.wk<312)&&swfUrlStr&&replaceElemIdStr&&widthStr&&heightStr&&swfVersionStr){setVisibility(replaceElemIdStr,false);addDomLoadEvent(function(){widthStr+="";heightStr+="";var att={};if(attObj&&typeof attObj===OBJECT){for(var i in attObj){att[i]=attObj[i];}}att.data=swfUrlStr;att.width=widthStr;att.height=heightStr;var par={};if(parObj&&typeof parObj===OBJECT){for(var j in parObj){par[j]=parObj[j];}}if(flashvarsObj&&typeof flashvarsObj===OBJECT){for(var k in flashvarsObj){if(typeof par.flashvars!=UNDEF){par.flashvars+="&"+k+"="+flashvarsObj[k];}else{par.flashvars=k+"="+flashvarsObj[k];}}}if(hasPlayerVersion(swfVersionStr)){var obj=createSWF(att,par,replaceElemIdStr);if(att.id==replaceElemIdStr){setVisibility(replaceElemIdStr,true);}callbackObj.success=true;callbackObj.ref=obj;}else{if(xiSwfUrlStr&&canExpressInstall()){att.data=xiSwfUrlStr;showExpressInstall(att,par,replaceElemIdStr,callbackFn);return;}else{setVisibility(replaceElemIdStr,true);}}if(callbackFn){callbackFn(callbackObj);}});}else{if(callbackFn){callbackFn(callbackObj);}}},switchOffAutoHideShow:function(){autoHideShow=false;},ua:ua,getFlashPlayerVersion:function(){return{major:ua.pv[0],minor:ua.pv[1],release:ua.pv[2]};},hasFlashPlayerVersion:hasPlayerVersion,createSWF:function(attObj,parObj,replaceElemIdStr){if(ua.w3){return createSWF(attObj,parObj,replaceElemIdStr);}else{return undefined;}},showExpressInstall:function(att,par,replaceElemIdStr,callbackFn){if(ua.w3&&canExpressInstall()){showExpressInstall(att,par,replaceElemIdStr,callbackFn);}},removeSWF:function(objElemIdStr){if(ua.w3){removeSWF(objElemIdStr);}},createCSS:function(selStr,declStr,mediaStr,newStyleBoolean){if(ua.w3){createCSS(selStr,declStr,mediaStr,newStyleBoolean);}},addDomLoadEvent:addDomLoadEvent,addLoadEvent:addLoadEvent,getQueryParamValue:function(param){var q=doc.location.search||doc.location.hash;if(q){if(/\?/.test(q)){q=q.split("?")[1];}if(param==null){return urlEncodeIfNecessary(q);}var pairs=q.split("&");for(var i=0;i<pairs.length;i++){if(pairs[i].substring(0,pairs[i].indexOf("="))==param){return urlEncodeIfNecessary(pairs[i].substring((pairs[i].indexOf("=")+1)));}}}return"";},expressInstallCallback:function(){if(isExpressInstallActive){var obj=getElementById(EXPRESS_INSTALL_ID);if(obj&&storedAltContent){obj.parentNode.replaceChild(storedAltContent,obj);if(storedAltContentId){setVisibility(storedAltContentId,true);if(ua.ie&&ua.win){storedAltContent.style.display="block";}}if(storedCallbackFn){storedCallbackFn(storedCallbackObj);}}isExpressInstallActive=false;}}};}();var bind=Utils.bind;var byId=Utils.byId;var empty=Utils.empty;var extend=Utils.extend;var hasOwn=Utils.hasOwn;var indexOf=Utils.indexOf;var isArray=Utils.isArray;var isFlagActive=Utils.isFlagActive;var isFunc=Utils.isFunc;var isRelativePath=Utils.isRelativePath;var isString=Utils.isString;var joinKeys=Utils.joinKeys;var nil=Utils.isNull;var now=Utils.now;var print=Utils.print;var slice=Utils.slice;var template=Utils.template;var undef=Utils.undef;var Asset=Utils.Asset;var CommandQueue=Utils.CommandQueue;var Dependency=Utils.Dependency;var DependencyManager=Utils.DependencyManager;var XMLUtils=Utils.XML;var Event=Events.CustomEvent;var log=CVP.Log.getLogger();var Aspen=window.Aspen;(function(){if(Aspen){return;}var VERSION="1.0.3";var ANALYTICS_BASE_URL=CDN_PREFIX+"/xslo/cvp/config/";var BATCH_MODE_TOTAL="total";var BATCH_MODE_TIMER="timer";var BATCH_MODE_NONE="none";var LoadState={WAITING:"loadStateWaiting",LOADING:"loadStateLoading",READY:"loadStateReady",FAILED:"loadStateFailed"};var log=(function(){var globalFnName="logJSAspen";var globalFn=null;return(function(){if(debugFlag){var string=["[aspen]"].concat(slice(arguments)).join(" | ");if(typeof window.console==="object"&&isFunc(window.console.log)){window.console.log(string);}globalFn=globalFn||(isFunc(window[globalFnName])&&window[globalFnName]);if(globalFn){globalFn(string);}}});}());var AspenComm=(function(){var REMOTE="http://aspen-qa.turner.com",xhr,init,inited=false,queue=[],dequeue,request,queue_request,make_request;init=function(remote){log("[easyXDM]","init",remote);REMOTE=remote;xhr=new CVP.easyXDM.Rpc({swf:CDN_PREFIX+"/xslo/cvp/easyxdm/swf/easyxdm.swf",remote:REMOTE+"/static/xdm_iframe.html"},{remote:{request:{}}});log("[easyXDM]","init AspenComm");inited=true;init=function(){throw new Error("already init'ed - ignored");};dequeue();};request=function(config,succ,fail){if(inited){make_request(config,succ,fail);}else{queue_request(config,succ,fail);}};queue_request=function(){queue.push(arguments);};dequeue=function(){var args=null;while((args=queue.shift())!=null){make_request.apply(null,args);}};make_request=function(options,succ,fail){log("[easyXDM]","make request",options);var config,successFn,errorFn;config=extend({method:"POST"},options);successFn=function(response){var json=response.data;if(typeof json==="string"&&json.charAt(0).match(/[{\[]/)){try{json=JSON.parse(json);}catch(e){log(e);}}log("[easyXDM]","request success",response);succ(json,response.status,response.headers);
};errorFn=function(response){var json=response.data;if(typeof json==="string"&&json.charAt(0).match(/[{\[]/)){try{json=JSON.parse(json);}catch(e){log(e);}}fail(json,response.status,response.message);};xhr.request(config,successFn,errorFn);};return({init:init,request:request});}());var bootstrap=function(fn){log("[easyXDM]","bootstrap",fn);if(!("easyXDM" in CVP)){var assetLoader=new CVP.Utils.Asset(CDN_PREFIX+"/xslo/cvp/easyxdm/js/easyXDM.ugly.js");var loadFailure=function(){throw new Error("[easyXDM] failed to install easyXDM");};var loadSuccess=function(){if(!("easyXDM" in window)){loadFailure();return;}CVP.easyXDM=window.easyXDM.noConflict("CVP");fn();};assetLoader.eSuccess.addListener(loadSuccess,this);assetLoader.eFailure.addListener(loadFailure,this);assetLoader.load();}};var TransportFormat={JSON:"json",JSONP:"jsonp"};var TransportManager={init:function(config){this._config=config;this._transportFormat=this._config.transportFormats.shift();this._bootstrapped=false;},bootstrapTM:function(){log("TransportManager","bootstrap","_bootstrapped:",this._bootstrapped);if(this._transportFormat===TransportFormat.JSON){if(!this._bootstrapped){var servicesUrl=this._config.servicesUrl;bootstrap(function(){AspenComm.init(servicesUrl);});this._bootstrapped=true;log("TransportManager","bootstrap","transportFormat",this._transportFormat);}}},createRequest:function(request,data,success,failure,scope){log("TransportManager","createRequest");if(this._transportFormat===TransportFormat.JSON){AspenComm.request({url:request+"."+this._transportFormat,data:{aspenJson:JSON.stringify(data)}},bind(success,scope),bind(failure,scope));}else{if(this._transportFormat===TransportFormat.JSONP){var jsonpUrl=this._config.servicesUrl+request+"."+this._transportFormat;jsonpUrl+="?aspenJson="+encodeURIComponent(JSON.stringify(data)).replace(/%20/g,"+");Ajax.getJSONP({jsonpCallback:"parseCVPServicesInitialization",url:jsonpUrl,error:bind(failure,scope),success:bind(success,scope)});}}},fallback:function(){log("current transport format failed",this._transportFormat);this._transportFormat=this._config.transportFormats.shift();if(this._transportFormat){log("trying next transport format",this._transportFormat);return true;}else{return false;}}};var BatchService=Class.extend({init:function(config,aspenInstance){this._enabled=false;this._queue=[];this._config=config;this._aspen=aspenInstance||window.Aspen;this._timer=null;this._postTimerEvent=bind(this._postTimerEvent,this);this._firstPostTimerEvent=bind(this._firstPostTimerEvent,this);this._flushBatch=bind(this.post,this);addBeforeUnLoadEvent(this._flushBatch);},start:function(config){this._config=config;this._enabled=true;if(this._aspen.config.batchMode==BATCH_MODE_TIMER){var random=Math.ceil(Math.random()*this._aspen.config.batchModeAmount);if(random==this._aspen.config.batchModeAmount){random-=1;if(random<=0){random=0.5;}}log("random time: "+random);setTimeout(this._firstPostTimerEvent,random*1000);}},add:function(message){if(!this._aspen.config.enabled){log("Aspen is disabled via aspenanalytics config. Message not added.");return;}if(this._config.batchThrottled){log("Batching is throttled. Message not added.");return;}log("Adding message to batch queue.");this._queue.push(message);if(!this._enabled){log("Batch service not enabled. Queuing message.");return;}if(this._aspen.config.batchMode==BATCH_MODE_TIMER&&this._timer==null){log("Starting timer on message-add.");this._timer=setTimeout(this._postTimerEvent,this._aspen.config.batchModeAmount*1000);}else{if((this._aspen.config.batchMode==BATCH_MODE_TOTAL&&this._queue.length>=this._aspen.config.batchModeAmount)||this._aspen.config.batchMode==BATCH_MODE_NONE||this._aspen.config.batchMode!=BATCH_MODE_TIMER){this.post();}}if(!empty(this._queue)){if(message.eventType=="error"){this.flushByError(message.eventData);}else{if((message.eventType!="error")&&(typeof this._aspen.config.highPriorityEvents!="undefined")){this.flushByEvent(message.eventType);}}}},post:function(){if(this._config.postThrottled){log("Batch posting is throttled. Batch not posted.");return;}var data={"sessionId":this._config.sessionId,"events":this._queue};log("send batch string");if(this._aspen.config.batchContentEncoding=="gzip"){var jsonString="?aspenJson="+JSON.stringify(data);var uriEncodedString=encodeURIComponent(jsonString).replace(/%20/g,"+");var gzipEncodedString=uriEncodedString;data=gzipEncodedString;}TransportManager.createRequest(this._aspen.config.batchApi,data,this._postSuccess,this._postFailure,this);this._queue=[];},_postTimerEvent:function(){if(empty(this._queue)){log("postTimer - no messages to post");this._timer=null;}else{log("postTimer - queue.length: "+this._queue.length);this.post();this._timer=setTimeout(this._postTimerEvent,this._aspen.config.batchModeAmount*1000);}},_firstPostTimerEvent:function(){if(empty(this._queue)){log("firstPostTimer - no messages to post");}else{log("firstPostTimer - queue.length: "+this._queue.length);this.post();}},_postSuccess:function(data){log("post success: "+data);},_postFailure:function(url){log("post failed: "+url);},flushByError:function(message){if(isString(message.errorCode)&&isString(this._aspen.config.highPriorityErrors)){var errorCode=message.errorCode;var errorCodeType=errorCode.substring(0,2);var errorCodeSub=errorCode.substring(2,4);var errorCodeLevel=errorCode.substring(4,6);var errorCodeNumber=errorCode.substring(6);var priorityArray=this._aspen.config.highPriorityErrors.split(/[, ]+/);var typeStr="";var subtypeStr="";var levelStr="";var codeNumberStr="";var types=[];var subtypes=[];var levels=[];var codeNumbers=[];for(var i=0,endi=priorityArray.length;i<endi;++i){switch(i){case 0:typeStr=priorityArray[i];types=typeStr.split("+");break;case 1:subtypeStr=priorityArray[i];subtypes=subtypeStr.split("+");break;case 2:levelStr=priorityArray[i];levels=levelStr.split("+");break;case 3:codeNumberStr=priorityArray[i];codeNumbers=codeNumberStr.split("+");break;}}for(i=0,endi=types.length;i<endi;++i){var type=types[i];if((errorCodeType==type)||(type=="*")){for(var j=0,endj=subtypes.length;j<endj;++j){var subtype=subtypes[j];if((errorCodeSub==subtype)||(subtype=="*")){for(var k=0,endk=levels.length;k<endk;++k){var level=levels[k];if((errorCodeLevel==level)||(level=="*")){for(var l=0,endl=codeNumbers.length;l<endl;++l){var codeNumber=codeNumbers[l];if((errorCodeNumber==codeNumber)||(codeNumber=="*")){log("[flushByError] found match, flushing batch");this.post();}}}}}}}}}},flushByEvent:function(messageType){if(isString(this._aspen.config.highPriorityEvents)){var priorityArray=this._aspen.config.highPriorityEvents.split(/[, ]+/);for(var i=0,endi=priorityArray.length;i<endi;++i){var type=priorityArray[i];if(type==messageType){log("[flushBatchByEvent] found match, flushing batch");this.post();}}}},setSessionId:function(id){this._config.sessionId=id;},setBatchThrottled:function(throttle){this._config.batchThrottled=throttle;},setPostThrottled:function(throttle){this._config.postThrottled=throttle;},disableTimer:function(){if(this._aspen.config.batchMode==BATCH_MODE_TIMER){clearTimeout(this._timer);}}});var ConfigFileDependency=Dependency.extend({init:function(options){var basePath=options.basePath||"";this._loadSuccessCallback=options.success||Function.prototype;log("Using config base path: "+basePath);var analyticsConfigUrl=basePath+"/aspenanalytics.json?_="+now();log("config url: ",analyticsConfigUrl);this._super(analyticsConfigUrl,true);},load:function(){Ajax.getJSONP({jsonpCallback:"cvp_onAnalyticsConfigReceived",url:this._assetUrl,success:bind(this._loadConfigSuccess,this),error:bind(this._loadConfigFailure,this)});},_loadConfigSuccess:function(data){log("Config loaded successfully");this._loadSuccessCallback(data,this._assetUrl);this._success();},_loadConfigFailure:function(url){log("Config failed to load",url);this._failure();},getDesc:function(){return"Aspen ConfigDependency: "+this._assetUrl;}});var SessionId=(function(){var sessionId;return({set:function(value){if(sessionId){log("SessionId - sessionId is already '"+sessionId+"'; will NOT set to '"+value+"'");
return;}log("SessionId - setting sessionId to '"+value+"'");sessionId=value;},get:function(){log("SessionId - retreiving ID '"+sessionId+"'");return sessionId;}});}());var createAspenInstance=function(options){var useSharedSessionToken=true;var aspenAppSignature={"applicationName":"cvp","applicationVersion":CVP.version,"platformName":"javascript","platformVersion":undefined};if(typeof options==="object"){if("aspenAppSignature" in options){aspenAppSignature=extend({},aspenAppSignature,options.aspenAppSignature);}if("useSharedSessionToken" in options){useSharedSessionToken=!!options.useSharedSessionToken;}}return({initialized:false,ready:false,batchService:null,sessionObject:{},serviceUrlRoot:"",isThrottled:true,timeDifference:0,progressReportInterval:30,_throttledTimeRecord:{},_retryTimer:null,_retries:0,_retriesMade:0,_retryTime:0,_savedSession:{},_messageQueue:[],_loadState:LoadState.WAITING,_configLoaded:false,_dependenciesLoaded:false,init:function(options){var self=this;if(this.initialized){log("INFO - Aspen is already set up!");return;}this._helloRetry=bind(this._helloRetry,this);this.initialized=true;this._options=options||{};this._options.site=this._options.site||_cvpsetup.site;if(empty(this._options.site)){log("Unable to start Aspen, no site provided");return;}this.batchService=new BatchService({batchThrottled:true,postThrottled:true},this);this._loadState=LoadState.LOADING;Events.onReady(function(){var basePath=self._options.configBaseUrl||ANALYTICS_BASE_URL+self._options.site;var dependency=new ConfigFileDependency({basePath:basePath,success:bind(self._setupConfig,self)});dependency.eSuccess.addListener(self._onDependenciesLoaded,self);dependency.eFailure.addListener(self._onDependenciesLoadFailure,self);dependency.load();});},_setupConfig:function(data,url){var config=extend({},data["default"],("context" in this._options?data[this._options.context]:null));config.enabled=config.enabled==="true"&&!empty(config.servicesUrl);config.batchMode=config.batchMode||"total";config.batchModeAmount=config.batchModeAmount&&Number(config.batchModeAmount)||10;config.helloRetryCount=!isNaN(config.helloRetryCount=Number(config.helloRetryCount))?config.helloRetryCount:5;config.helloRetryTime=config.helloRetryTime&&Number(config.helloRetryTime)||10000;config.batchContentEncoding=config.batchContentEncoding||"json";config.transportFormats=config.transportFormats&&config.transportFormats.split(/[, ]+/)||[TransportFormat.JSONP];log("enabled: ",config.enabled);log("servicesUrl: ",config.servicesUrl);log("batchMode: ",config.batchMode);log("batchModeAmount: ",config.batchModeAmount);log("helloRetryCount: ",config.helloRetryCount);log("helloRetryTime: ",config.helloRetryTime);log("batchContentEncoding: ",config.batchContentEncoding);log("transportFormats: ",config.transportFormats);this.config=config;this.configSourceUrl=url;this.send(this.config,"aspenConfigDetails");},_onDependenciesLoaded:function(){this._loadState=LoadState.READY;log("_onDependenciesLoaded - all required dependencies successfully loaded.");if(this.config.enabled){log("analytics enabled via config");TransportManager.init({transportFormats:this.config.transportFormats,servicesUrl:this.config.servicesUrl});this.serviceUrlRoot=this.config.servicesUrl;this._hello();}else{log("analytics disabled via config");this._initFailure();}},_onDependenciesLoadFailure:function(url){this._loadState=LoadState.FAILED;log("_onDependenciesLoadFailure - one or more required dependencies failed to load.");},_hello:function(){log("hello");var sessionId=SessionId.get();var sessionToken=useSharedSessionToken?SessionToken.read():SessionToken.create();var data=extend({},aspenAppSignature,{aspenConfigUrl:this.configSourceUrl,propertyName:this._options.site,pageUrl:document.URL,context:this._options.context,debug:this._options.dt?"true":"false",sessionId:sessionId,sessionToken:sessionToken,protocol:"1.0"});TransportManager.bootstrapTM();TransportManager.createRequest(this.config.helloApi,data,this._helloSuccess,this._helloFailure,this);this._retryTimer=setTimeout(this._helloRetry,this.config.helloRetryTime);this._isRetrying=true;},_helloSuccess:function(config){log("_helloSuccess");clearTimeout(this._retryTimer);this.isThrottled=isString(config.throttled)?config.throttled!=="no":this.isThrottled;this.timeDifference=config.timestamp?config.timestamp-now():this.timeDifference;this.progressReportInterval=config.progressReportInterval||this.progressReportInterval;log("config.throttled: "+config.throttled);log("config.sessionId: "+config.sessionId);log("throttled: "+this.isThrottled);log("timeDifference: "+this.timeDifference);log("progressReportInterval: "+this.progressReportInterval);if(config.sessionId){SessionId.set(config.sessionId);}this.batchService.start({batchThrottled:false,postThrottled:true,sessionId:""});this.batchService.setSessionId(SessionId.get());this.batchService.setPostThrottled(this.isThrottled);this._initSuccess();},_helloFailure:function(url){log("_helloFailure url: "+url);if(TransportManager.fallback()){this._hello();}},_helloRetry:function(){log("helloRetry");if(this._retries==this.config.helloRetryCount){log("retries exhasted");clearTimeout(this._retryTimer);this._retries=0;if(TransportManager.fallback()){this._hello();}else{log("retries exhasted, fallbacks exhausted, aspen is disabled");this.isThrottled=true;this.batchService.setBatchThrottled(true);this.batchService.setPostThrottled(true);this.batchService.disableTimer();}}else{this._retries+=1;this._retryTime=this._retries*this.config.helloRetryTime;this._savedSession.retries=this._retries;this._savedSession.retryTime=this._retryTime;this._hello();}},isMessageExcluded:function(message){return(isString(this.config.messageExcludes)&&this.config.messageExcludes.indexOf(message)!==-1);},send:function(message,type){if(this.disabled){log("send - Aspen is disabled, message was not sent");return;}message.timestamp=(message.timestamp||now())+this.timeDifference;if(!this.ready){log("send - Aspen's not ready, queuing message");this._messageQueue.push({message:message,type:type});return;}if(this.isThrottled){log("Add message to batch is throttled! Message not added.");return;}if(this.isMessageExcluded(type)){log("message excluded by config, not added to batch",type);return;}this._send(message,type);},_send:function(message,type){switch(type){case"appConfig":message=extend({},aspenAppSignature,message);message.aspenConfigUrl=this.configSourceUrl;break;case"contentProgress":if(this._throttledTimeRecord.contentProgress&&message.timestamp<(this._throttledTimeRecord.contentProgress+(this.progressReportInterval*1000))){return;}this._throttledTimeRecord.contentProgress=message.timestamp;break;}if("applicationName" in aspenAppSignature&&!("applicationName" in message)){message.applicationName=aspenAppSignature.applicationName;}var batchObj={};batchObj.eventType=type;batchObj.eventData=message;log("add to batch json message: "+JSON.stringify(batchObj));this.batchService.add(batchObj);},convertTimeToSecString:function(secs){return(typeof secs==="number"&&isFinite(secs)?secs.toFixed(3):undefined);},_initSuccess:function(){log("Successful init");this.ready=true;for(var i=0,len=this._messageQueue.length;i<len;++i){this.send(this._messageQueue[i].message,this._messageQueue[i].type);}this.send({screenWidth:screen.width,screenHeight:screen.height,browserName:navigator.appName,userAgent:navigator.userAgent,platform:navigator.platform},"systemInfo");this._initSuccess=function(){};},_initFailure:function(){log("Failed init");this.disabled=true;}});};Aspen=window.Aspen=createAspenInstance();Aspen.createInstance=createAspenInstance;var SessionToken=(function(){var sessionToken=Utils.getQueryParam("sessionToken");if(sessionToken){Aspen.send({},"authSessionReload");}return({create:function(){return Utils.randomString(25);},read:function(){if(!sessionToken){log("SessionToken - sessionToken does not exist; creating anew");sessionToken=this.create();}log("SessionToken - retreiving sessionToken '"+sessionToken+"'");
return sessionToken;}});}());Aspen.getSessionToken=function(){return SessionToken.read();};})();CVP.getSessionToken=Aspen.getSessionToken;(function(){var ConditionalTask=function(condition,success,interval){this._interval=nil(interval)?10:interval;this._maxTries=500;this._condition=condition;this._success=success;this._tries=0;this.conditionWrapper=bind(function(){var ret=this._condition();if(ret){clearInterval(this._timer);this._success();}else{if(this._tries>this._maxTries){log.warn("condition never met!");clearInterval(this._timer);}}++this._tries;},this);this.start=function(){this._timer=setInterval(this.conditionWrapper,this._interval);};};var ConfigUtils={stringReplace:function(str,entry,uriEncode){var patterns=this.getReplacementPatterns(str),i=0,endi=0,pattern,replaceStr="";if(!empty(patterns)){for(endi=patterns.length;i<endi;++i){pattern=patterns[i];replaceStr="";replaceStr=this.getReplacementText(pattern,entry);if(empty(replaceStr)){replaceStr="";}else{if(uriEncode){replaceStr=encodeURI(replaceStr);}}str=str.replace(pattern,replaceStr);}}return str;},getReplacementPatterns:function(str){return(str&&str.match(/[$][{][^}]*[}]/g));},getReplacementText:function(pattern,entry){var replaceStr="",nodeName="",array=[],objName="";switch(pattern){case"${page.domain}":replaceStr=document.domain;break;case"${page.url}":replaceStr=location.href;break;case"${videoId}":case"${video.id}":if(entry){replaceStr=entry.getId();}break;default:nodeName=pattern.substr(2,pattern.length-3);array=nodeName.split(".");objName=array[0];if(array.length>1){nodeName=nodeName.substr(objName.length+1);switch(objName){case"video":if(entry){replaceStr=XMLUtils.getNodeValue(entry._xmlEntry,nodeName);}break;case"javascript":if(window.cvpSearchTheClient){replaceStr=window.cvpSearchTheClient(null,nodeName);}break;default:replaceStr=pattern;break;}}else{replaceStr=pattern;}}return replaceStr;}};var Loader=Class.extend({init:function(){this.eLoaded=new Event("LoadedEvent");this.eLoadError=new Event("LoadErrorEvent");},load:function(url,options){var self=this;options=extend({ajax:{}},options);var success=function(data){log.debug("Loader","success:",url);self.eLoaded.dispatch(data);};var error=function(requestObj,textStatus,errorThrown){log.error("Loader","error:",url,"text:",textStatus);self.eLoadError.dispatch(requestObj,textStatus,errorThrown);};var ajaxOptions=extend({success:success,error:error},options.ajax);ajaxOptions.url=url;this._sendRequest(ajaxOptions);},_sendRequest:function(ajaxOptions){Ajax.get(ajaxOptions);}});var JSONPLoader=Loader.extend({init:function(){this._super();},_sendRequest:function(ajaxOptions){Ajax.getJSONP(ajaxOptions);}});var XMLLoader=Class.extend({init:function(){this._loader=new Loader();this._loader.eLoaded.addListener(this._onLoaded,this);this._loader.eLoadError.addListener(this._onLoadError,this);this.eLoaded=new Event();this.eLoadError=new Event();},load:function(url,options){this._loader.load(url,options);},_onLoaded:function(xmlStr){var xDoc=null;if(xmlStr){xDoc=XMLUtils.createDoc(xmlStr);if(!xDoc){xmlStr=XMLUtils.clean(xmlStr);xDoc=XMLUtils.createDoc(xmlStr);}}log.debug("XMLLoader","XML loaded");this.eLoaded.dispatch(xDoc);},_onLoadError:function(requestObj,textStatus,errorThrown){log.error("XMLParser","onLoadError:",textStatus);if(textStatus==="parsererror"){log.error("XMLParser","ParseError...attempting to create an xml doc manually");var xmlStr=requestObj.responseText;xmlStr=XMLUtils.clean(xmlStr);var xDoc=XMLUtils.createDoc(xmlStr);if(xDoc){this.eLoaded.dispatch(xDoc);}else{this.eLoadError.dispatch(requestObj,textStatus,errorThrown);}}}});var UberLoader=Class.extend({init:function(){this._loader=null;this.eLoaded=new Event();this.eLoadError=new Event();},load:function(url,options){this._createLoader(url);this._loader.load(url,options);},_createLoader:function(url){if(this._loader){this._destroyLoader();}var ext=this._getFileType(url);switch(ext){case"xml":this._loader=new XMLLoader();break;case"json":this._loader=new JSONPLoader();break;default:this._loader=new Loader();break;}this._loader.eLoaded.addListener(this._onLoaded,this);this._loader.eLoadError.addListener(this._onLoadError,this);},_getFileType:function(url){var match=String(url).match(/\.([^.?#]+)(?:[?#]|$)/);var ext=match?match[1]:"";return ext;},_destroyLoader:function(){this._loader.eLoaded.removeListener(this._onLoaded,this);this._loader.eLoadError.removeListener(this._onLoadError,this);this._loader=null;},_onLoaded:function(data){this.eLoaded.dispatch(data);},_onLoadError:function(requestObj,textStatus,errorThrown){this.eLoadError.dispatch(requestObj,textStatus,errorThrown);}});var Parser=Class.extend({init:function(){this._loader=this._createLoader();this._loader.eLoaded.addListener(this.onLoaded,this);this._loader.eLoadError.addListener(this.onLoadError,this);this.eParseCompleted=new Event();this.eParseError=new Event();},_createLoader:function(){return new UberLoader();},parse:function(url){log.debug("Parser","Loading the file to parse",url);this.load(url);},load:function(url,options){this._loader.load(url,options);},onLoaded:function(data){log.debug("Parser","Data loaded");this.parseData(data);},onLoadError:function(requestObj,textStatus,errorThrown){log.error("Parser","onLoadError:",textStatus);this._fireLoadedFailure();},parseData:function(xml){},_fireLoadedSuccess:function(){log.debug("Parser","successfully Loaded asset");this.eParseCompleted.dispatch();},_fireLoadedFailure:function(){log.error("Parser","failed to Load asset");this.eParseError.dispatch();}});var BootStrapper=(function(){var _params={};var _mapping={};var _appConfig={};var _containerInfo={};var _configInfo={omniture:{},share:{},embed:{}};var _adPolicy={ads:{attr:{type:"NONE"}}};var MappingParser=Parser.extend({init:function(){this._super();},load:function(url){var options={ajax:{jsonpCallback:"cvp_onMappingReceived"}};this._super(url,options);},parseData:function(data){var mappings,profile,map;if(undef(data)||undef(data.mappings)){this.eParseError.dispatch();return;}mappings=data.mappings;profile=_params.profile;if(empty(profile)){this.onLoadError(null,"No mapping profile provided","Invalid mapping profile");return;}for(map in mappings){if(mappings[map].profile===profile){_mapping=mappings[map];}}if(empty(_mapping)){this.onLoadError(null,"No mapping profile '"+profile+"' found","Invalid mapping profile");return;}this._fireLoadedSuccess();}});var AppConfigParser=Parser.extend({init:function(){this._super();},load:function(url){var options={ajax:{jsonpCallback:"cvp_onAppConfigReceived"}};this._super(url,options);},parseData:function(data){_appConfig=data.appConfig;this._fireLoadedSuccess();}});var ContainerParser=Parser.extend({init:function(){this._super();},parseData:function(xml){var i=0,endi=0,docElement=xml.documentElement,contextName=_params.context||"",elementName=_params.element||"",contexts=null,context=null,element=null,defaultNode=null,policies=null,adPolicySrc=null,adPolicyContext=null;defaultNode=docElement.getElementsByTagName("default");policies=(defaultNode.length&&defaultNode[0].getElementsByTagName("policies"))||[];if(policies.length){adPolicySrc=XMLUtils.getParamValue(policies[0],"adPolicySrc");adPolicyContext=XMLUtils.getParamValue(policies[0],"adPolicyContext");}_containerInfo.elementName=elementName;_containerInfo.adPolicySrc=adPolicySrc;_containerInfo.adPolicyContext=adPolicyContext;contexts=docElement.getElementsByTagName("context");for(endi=contexts.length;i<endi;++i){if(XMLUtils.getAttribute(contexts[i],"name")===contextName){context=contexts[i];break;}}if(context){var elements=context.getElementsByTagName("element");for(i=0,endi=elements.length;i<endi;++i){if(XMLUtils.getAttribute(elements[i],"id")===elementName){element=elements[i];break;}}if(!element){element=elements[0];}if(element){elementName=XMLUtils.getAttribute(element,"id");policies=element.getElementsByTagName("policies");if(policies.length>0){adPolicySrc=XMLUtils.getParamValue(policies[0],"adPolicySrc");adPolicyContext=XMLUtils.getParamValue(policies[0],"adPolicyContext");
}var players=element.getElementsByTagName("player");var playerName=XMLUtils.getAttribute(players[players.length-1],"playerInstance");if(empty(playerName)){playerName=contextName;}_containerInfo.playerInstance=playerName;}}if(!empty(elementName)){_containerInfo.elementName=elementName;}if(!empty(adPolicySrc)){_containerInfo.adPolicySrc=adPolicySrc;}if(!empty(adPolicyContext)){_containerInfo.adPolicyContext=adPolicyContext;}Utils.print(_containerInfo,"_containerInfo");this._fireLoadedSuccess();},parseParams:function(obj,name,value){switch(name){case"adPolicySrc":obj.adPolicySrc=value;break;case"adPolicyContext":obj.adPolicyContext=value;break;default:obj[name]=value;}}});var ConfigParser=Parser.extend({init:function(){this._super();},parseData:function(xml){var self=this,docElement=xml.documentElement,playerInstanceName=_containerInfo.playerInstance||"",player=null,players=docElement.getElementsByTagName("player"),node=null,defaultNode=null,process;while(players.length){node=players[players.length-1];if(XMLUtils.getAttribute(node,"name")===playerInstanceName){player=node.cloneNode(true);}docElement.removeChild(node);}process=function(xml,objToAssign){if(nil(xml)){return;}var childNodes=xml.childNodes,xmlLength=childNodes.length,childNode,obj,i=0;for(;i<xmlLength;++i){childNode=childNodes[i];obj=self.findMapping(childNode.nodeName);if(!nil(obj)){self.parseAttributes(obj,childNode);if(childNode.childNodes.length){process(childNode,obj);}}else{if(childNode.nodeName==="param"){self.parseParams(objToAssign,XMLUtils.getAttribute(childNode,"name"),XMLUtils.getAttribute(childNode,"value"));}}}};defaultNode=docElement.getElementsByTagName("default");if(defaultNode.length>0){process(defaultNode[0],_configInfo);}if(!nil(player)){process(player,_configInfo);}Utils.print(_configInfo,"_configInfo");players=player=null;this._fireLoadedSuccess();},parseParams:function(obj,name,value){switch(name){default:obj[name]=value;}},parseAttributes:function(obj,node){if(node.hasAttributes){if(!obj.attr){obj.attr={};}XMLUtils.assignAttributes(obj.attr,node.attributes);}},findMapping:function(nodeName){var obj=null;switch(nodeName){default:obj=null;}return obj;}});var AdPolicyParser=Parser.extend({init:function(){this._super();},parseData:function(xml){var self=this,i=0,endi=0,docElement=xml.documentElement,adContextName=_containerInfo.adPolicyContext||"",context=null,contexts=docElement.getElementsByTagName("context"),process,defaultNode;for(endi=contexts.length||0;i<endi;++i){if(XMLUtils.getAttribute(contexts[i],"name")===adContextName){context=contexts[i];break;}}process=function(xml,objToAssign){if(nil(xml)){return;}var childNodes=xml.childNodes,xmlLength=childNodes.length,childNode,obj,i=0;for(;i<xmlLength;++i){childNode=childNodes[i];obj=self.findMapping(childNode.nodeName);if(!nil(obj)){self.parseAttributes(obj,childNode);if(childNode.childNodes.length){process(childNode,obj);}}else{if(childNode.nodeName==="param"){self.parseParams(objToAssign,XMLUtils.getAttribute(childNode,"name"),XMLUtils.getAttribute(childNode,"value"));}}}};defaultNode=docElement.getElementsByTagName("default");if(defaultNode.length!==0){process(defaultNode[0],_adPolicy);}if(!nil(context)){process(context,_adPolicy);}Utils.print(_adPolicy,"_adPolicy");contexts=context=null;this._fireLoadedSuccess();},parseParams:function(obj,name,value){switch(name){case"adApi":obj.apiUrl=value;break;case"adManRootUrl":obj.adManRootUrl=value;break;case"adServerRootUrl":obj.adServerRootUrl=value;break;case"adVideoRootUrl":obj.adVideoRootUrl=value;break;case"adVideoExtension":obj.adVideoExtension=value;break;case"additionalVideoSegvars":obj.additionalVideoSegVars=value;break;case"additionalSyncSegvars":obj.additionalSyncSegVars=value;break;case"adSection":obj.adSection=value;break;case"adNetworkId":obj.adNetworkId=value;break;case"adVideoNetworkId":obj.adVideoNetworkId=value;break;case"adVideoAssetId":obj.adVideoAssetId=value;break;case"adPlayerProfile":obj.adPlayerProfile=value;break;case"renderersUrl":obj.renderersUrl=value;break;case"externalSlots":obj.externalSlots=isFlagActive(value,obj.externalSlots);break;case"adLiveContentDuration":obj.liveDuration=value;break;default:obj[name]=value;}},parseAttributes:function(obj,node){if(node.hasAttributes){if(!obj.attr){obj.attr={};}XMLUtils.assignAttributes(obj.attr,node.attributes);}},findMapping:function(nodeName){var obj=null;switch(nodeName){case"adServer":obj=_adPolicy.ads;break;}return obj;}});var MappingDependency=Dependency.extend({init:function(){this._super.apply(this,arguments);this.required=true;this._parser=new MappingParser();this._parser.eParseCompleted.addListener(this._onParseCompleted,this);this._parser.eParseError.addListener(this._onParseError,this);},load:function(){log.info("MappingDependency","loading xml",this._assetUrl);this._parser.parse(this._assetUrl);},_onParseCompleted:function(){if(!_mapping||empty(_mapping.url)){log.error("Unable to retrieve the mapping file.");this._failure();return;}var appConfigUrl=Utils.replaceExtension(_mapping.url,"xml","json");this._manager.addDependency(new AppConfigDependency(appConfigUrl,true));this._success();},_onParseError:function(){this._failure();},getDesc:function(){return"MappingDependency: "+this._assetUrl;}});var AppConfigDependency=Dependency.extend({init:function(){this._super.apply(this,arguments);this.required=true;this._parser=new AppConfigParser();this._parser.eParseCompleted.addListener(this._onParseCompleted,this);this._parser.eParseError.addListener(this._onParseError,this);},load:function(){log.info("AppConfigDependency","loading xml",this._assetUrl);this._parser.parse(this._assetUrl);},_onParseCompleted:function(){if(!_appConfig||empty(_appConfig.containerUrl)||empty(_appConfig.configUrl)){log.error("Unable to retrieve the appConfig file.");this._failure();return;}this._manager.addDependency(new ContainerDependency(_appConfig.containerUrl,true));this._manager.addDependency(new ConfigDependency(_appConfig.configUrl,true));this._success();},_onParseError:function(){this._failure();},getDesc:function(){return"AppConfigDependency: "+this._assetUrl;}});var ContainerDependency=Dependency.extend({init:function(){this._super.apply(this,arguments);this.required=true;this._parser=new ContainerParser();this._parser.eParseCompleted.addListener(this._onParseCompleted,this);this._parser.eParseError.addListener(this._onParseError,this);},load:function(){log.info("ContainerDependency","loading xml",this._assetUrl);this._parser.parse(this._assetUrl);},_onParseCompleted:function(){if(!empty(_containerInfo.adPolicySrc)){this._manager.addDependency(new AdPolicyDependency(_containerInfo.adPolicySrc,true));}this._success();},_onParseError:function(){this._failure();},getDesc:function(){return"ContainerDependency: "+this._assetUrl;}});var ConfigDependency=Dependency.extend({init:function(){this._super.apply(this,arguments);this.required=true;this._parser=new ConfigParser();this._parser.eParseCompleted.addListener(this._onParseCompleted,this);this._parser.eParseError.addListener(this._onParseError,this);},load:function(){this._parser.parse(this._assetUrl);},_onParseCompleted:function(){if(this._manager){if(!empty(_configInfo.omniture.omniture_account)){log.info("ContainerDependency","adding Omniture dependency");}}this._success();},_onParseError:function(){this._failure();},getDesc:function(){return"ConfigDependency: "+this._assetUrl;}});var AdPolicyDependency=Dependency.extend({init:function(){this._super.apply(this,arguments);this.required=true;this._parser=new AdPolicyParser();this._parser.eParseCompleted.addListener(this._onParseCompleted,this);this._parser.eParseError.addListener(this._onParseError,this);},load:function(){log.info("AdPolicyDependency","loading xml",this._assetUrl);this._parser.parse(this._assetUrl);},_onParseCompleted:function(){var type=_adPolicy.ads.attr.type.toLowerCase();if(type==="freewheel"){log.info("ContainerDependency","adding FW dependency");this._manager.addDependency(new Dependency(_params.freewheelJsUrl,true));
}else{if(type==="dfp"){log.info("ContainerDependency","adding DFP dependency");this._manager.addDependency(new Dependency(AD_DFP_URL,true));}}this._success();},_onParseError:function(){this._failure();},getDesc:function(){return"AdPolicyDependency: "+this._assetUrl;}});var BootStrapper=Class.extend({init:function(mappingUrl,params){this._mappingUrl=mappingUrl;_params=params||{};this.eSuccess=new Event();this.eFailure=new Event();},load:function(){this._bootStrapper=new DependencyManager();this._bootStrapper.addDependency(new MappingDependency(this._mappingUrl),true);this._bootStrapper.eSuccess.addListener(this._success,this);this._bootStrapper.eFailure.addListener(this._failure,this);this._bootStrapper.load();},_success:function(){var event={data:{mapping:_mapping,appConfig:_appConfig,containerInfo:_containerInfo,configInfo:_configInfo,adPolicy:_adPolicy}};this.eSuccess.dispatch(event);},_failure:function(){this.eFailure.dispatch();}});return BootStrapper;})();var CMS=Class.extend({init:function(){this._catalogDataURL="";this._mediaUrl="";this._requestPendingQueue=[];this._videoCatalog=[];this._requests={};this._loader=new XMLLoader();this._loader.eLoaded.addListener(this._onContentIdRequestComplete,this);this._loader.eLoadError.addListener(this._onContentIdRequestIOError,this);this.eRequestCompleted=new Event("CmsRequestCompletedEvent");},addContentId:function(contentId){var entry=this.getContentId(contentId);if(nil(entry)){this._requestPendingQueue.push(contentId);}else{var index=contentId.split("|")[1];contentId=contentId.split("|")[0];this._notifyListeners(contentId,contentId,index);}if(this._requestPendingQueue.length===1){this._processNextRequest();}},getContentId:function(contentId){contentId=contentId.split("|")[0];var i=0,ct=this._videoCatalog.length;for(;i<ct;++i){var entry=this._videoCatalog[i];if(entry.getId()===contentId){return entry;}}return null;},clear:function(){this._videoCatalog=[];},setDataUrl:function(url){this._catalogDataURL=url;},setMediaUrl:function(url){this._mediaUrl=url;},_getRequestUrl:function(contentId){var requestUrl;var start=this._catalogDataURL.substr(0).search(/\$\{/);if(start!==-1){var end=this._catalogDataURL.substr(start).search(/\}/);if(end!==-1){var pattern=this._catalogDataURL.substr(start,end+1);requestUrl=this._catalogDataURL.replace(pattern,contentId);}}else{requestUrl=this._catalogDataURL+"/"+contentId+".xml";}return requestUrl;},_createContentEntryFromRequestData:function(requestData,contentId){try{var entry=new ContentCatalogEntry(requestData);entry.setMediaUrl(this._mediaUrl);return entry;}catch(e){alert(this._getRequestUrl(contentId)+": "+e.message);}return null;},_processNextRequest:function(){if(this._requestPendingQueue.length>0){var contentId=this._requestPendingQueue[0].split("|")[0];this._requestVideoWithId(contentId);}},_requestVideoWithId:function(contentId){var url=this._getRequestUrl(contentId);this._loader.load(url);},_onContentIdRequestComplete:function(data){var request=this._requestPendingQueue[0].split("|");var contentId=request[0];var requestIndex=request[1];if(data){var entry=this._createContentEntryFromRequestData(data,contentId);if(!entry||!entry.hasFiles()){this._notifyListeners(contentId,contentId,requestIndex,"No URLLoader");}else{entry.requestId=contentId;this._videoCatalog.push(entry);this._notifyListeners(entry.getId(),entry.requestId,requestIndex,"");}}else{this._notifyListeners(contentId,contentId,requestIndex,"No URLLoader");}this._requestPendingQueue.shift();this._processNextRequest();},_onContentIdRequestIOError:function(){var request=this._requestPendingQueue[0].split("|");var contentId=request[0];var requestIndex=request[1];this._notifyListeners(contentId,contentId,"IOError : "+event.text);this._requestPendingQueue.shift();this._processNextRequest();},_notifyListeners:function(contentId,requestId,index,errorMsg){this.eRequestCompleted.dispatch(contentId,requestId,index,errorMsg);}});var ContentCatalogEntry=Class.extend({init:function(xml){var anchor,files,f,file,fKey,fFallback,fValue,path,ext,images,image,iWidth,iHeight,iKey,iValue,lastDot,ads,ad,adKey,adValue;anchor=document.createElement("a");this._xmlEntry=xml.documentElement;this._requestId=null;this._mediaUrl="";this._name=XMLUtils.getNodeValue(this._xmlEntry,"slug");this._title=XMLUtils.getNodeValue(this._xmlEntry,"headline");this._category=XMLUtils.getNodeValue(this._xmlEntry,"category");this._trt=+XMLUtils.getNodeValue(this._xmlEntry,"trt");files=this._xmlEntry.getElementsByTagName("files");if(files.length){files=files[0].childNodes;this._fileList={};for(f in files){file=files[f];if(file.nodeType!==1||file.nodeName!=="file"){continue;}fKey=XMLUtils.getAttribute(file,"bitrate");fFallback=XMLUtils.getAttribute(file,"fallback");fValue=XMLUtils.getNodeValue(file);ext="";anchor.href=this.sanitizeUrl(fValue);path=anchor.pathname;lastDot=path.lastIndexOf(".");if(path&&~lastDot){ext=path.substring(lastDot+1);}anchor.href="javascript:";log.debug("ContentCatalogEntry",fKey,fValue,ext);this._fileList[fKey]={url:fValue,fallback:fFallback,ext:ext};}}else{log.warn("ContentCatalogEntry","No file entries found!");}images=this._xmlEntry.getElementsByTagName("images");if(images.length){images=images[0].childNodes;this._imageList={};for(image in images){if(images[image].nodeType!==1){continue;}iWidth=XMLUtils.getAttribute(images[image],"width");iHeight=XMLUtils.getAttribute(images[image],"height");iValue=XMLUtils.getNodeValue(images[image]);log.debug("ContentCatalogEntry","images",iWidth,iHeight,iValue);iKey=iWidth+"|"+iHeight;this._imageList[iKey]={url:iValue,width:iWidth,height:iHeight};}}ads=this._xmlEntry.getElementsByTagName("ads");if(ads.length){ads=ads[0].childNodes;this._adList={};for(ad in ads){if(ads[ad].nodeType!==1){continue;}adKey=XMLUtils.getAttribute(ads[ad],"type");adValue=XMLUtils.getNodeValue(ads[ad]);log.debug("ContentCatalogEntry","ad",adKey,adValue);this._adList[adKey]={url:adValue};}}},hasFiles:function(){return !empty(this._fileList);},setMediaUrl:function(url){this._mediaUrl=url;},getMediaUrl:function(){return this._mediaUrl;},getId:function(){var attr=XMLUtils.getAttribute(this._xmlEntry,"id");if(!empty(attr)){return attr;}else{return this._requestId;}},getName:function(){return this._name;},getTitle:function(){return this._title;},getCategory:function(){return this._category;},getTrt:function(){return this._trt;},isAdSensitive:function(){var value=XMLUtils.getNodeValue(this._xmlEntry,"isAdSensitive");return isFlagActive(value,false);},getSource:function(){var src=XMLUtils.getAttribute(this._xmlEntry,"source");return src||undefined;},getOriginId:function(){var originId=XMLUtils.getAttribute(this._xmlEntry,"originId");return originId||undefined;},getMode:function(){var isLive=XMLUtils.getAttribute(this._xmlEntry,"isLive");return !empty(isLive)?"live":"vod";},sanitizeUrl:function(url){if(isRelativePath(url)){url=this._mediaUrl+url;}return url;},getContentUrl:function(quality){var url=null,dbgFound=false,bitrate;for(bitrate in this._fileList){if(bitrate===quality){url=this.sanitizeUrl(this._fileList[bitrate].url);dbgFound=true;break;}}if(!dbgFound){log.warn("Config XML specifies a '"+quality+"' bitrate entry, but there is no <file> node in video XML where bitrate attribute is '"+quality+"'.");}else{if(empty(url)){log.warn("text attribute is empty in the video XML for the <file> node whose quality is '"+quality+"'.");}}return url;},getContentUrlFromFallback:function(fallback){var url=null,file=null,bitrate="";for(bitrate in this._fileList){file=this._fileList[bitrate];if(!(empty(file.fallback))&&fallback===file.fallback){url=this.sanitizeUrl(file.url);break;}}return url;},getContentUrlFromType:function(ext){var url=null,file=null,bitrate;for(bitrate in this._fileList){file=this._fileList[bitrate];if(ext===file.ext){url=this.sanitizeUrl(file.url);break;}}return url;},getThumbnailUrl:function(width,height){var url=null,key=width+"|"+height,k;for(k in this._imageList){if(k===key){url=this._imageList[k].url;break;
}}return url;},getAdUrl:function(type){return((this._adList&&this._adList[type]&&this._adList[type].url)||null);},getXML:function(){return this._xmlEntry;}});var AspenController=(function(){var inited=false;var log=CVP.Log.getLogger("ASPEN").debug;function send(type,data){log("AspenController - send",arguments);Aspen.send(data,type);}function init(options){log("AspenController - init",arguments);if(inited){return;}inited=true;Aspen.init(options);}return({send:send,init:init});})();var PlayerInstance=(function(){var _params={};var _mapping={};var _appConfig={};var _containerInfo={};var _configInfo={omniture:{},share:{},embed:{}};var _adPolicy={ads:{attr:{type:"NONE"}}};var BasePlayer=Class.extend({init:function(options){this.options=extend({containerElement:"",elementId:"",autostart:Browser.allowedAutoPlay,controls:true,width:0,height:0},options);this.containerElement=byId(this.options.containerElement);this.elementId=this.options.elementId;if(empty(this.elementId)){log.error("Invalid element id...exiting");throw new Error("Invalid element id");}this.playerOptions={};this.width=this.options.width;this.height=this.options.height;this.airplay=(!Browser.isOS(Browser.IOS)&&(undef(_params.iosAirplay)||undef(_configInfo.iosAirplay)))?"":'x-webkit-airplay="allow"';this.perVideoFallbacks=undef(_params.perVideoFallbacks)?[]:_params.perVideoFallbacks;this.element=null;this.rendering=false;this.position={top:null,right:null,bottom:null,left:null};this.eRendered=new Event();this.eContentMetadata=new Event();this.eContentPlay=new Event();this.eContentPause=new Event();this.eContentEnd=new Event();this.eContentPlayhead=new Event();this.eContentBuffering=new Event();this.eContentVolume=new Event();this.eContentError=new Event();this.eContentResize=new Event();this.eTrackingContentSeek=new Event();this.eTrackingContentSeekEnd=new Event();this.eFullscreenChange=new Event();this.eFullscreenError=new Event();this.eTrackingMuted=new Event();this.eTrackingPaused=new Event();},getMarkup:function(){return"";},render:function(containerElement){log.debug("Player","render");if(!empty(containerElement)){this.containerElement=byId(containerElement);}if(nil(this.containerElement)){log.error("Container element could not be found...cannot render...exiting");throw new Error("Container could not be found");}var markup=this.getMarkup();this.rendering=true;this.containerElement.innerHTML=markup;var self=this;new ConditionalTask(function(){if(!nil(byId(self.elementId))){return true;}},function(){self.rendering=false;self.element=byId(self.elementId);self.fireRendered();}).start();},rendered:function(){return this.element&&this.element.parentNode===this.containerElement;},show:function(){if(this.element){if(this.position.left){this.element.style.left=this.position.left;}}},hide:function(){if(this.element){this.position.left=this.element.style.left;this.element.style.left="-5000px";}},remove:function(){log.debug("Player","remove");if(nil(this.containerElement)){log.error("Container element could not be found .. cannot remove");throw new Error("Container element could not be found");}var element=byId(this.elementId);while(element.firstChild){element.removeChild(element.firstChild);}element.parentNode.removeChild(element);CVP.unregisterInstance(this.elementId);},addPlayerListeners:function(){},removePlayerListeners:function(){},fireRendered:function(){this.eRendered.dispatch();},firePlay:function(){this.eContentPlay.dispatch(this._catalogEntry.getId());},fireEnded:function(){this.eContentEnd.dispatch(this._catalogEntry.getId());}});var SeekingMonitor=(function(){var playheadThreshold=250;var seekingThrottle=400;var seekEndDelay=600;function SeekingMonitor(){this._playheadAtSeekStart=null;this._seekStartTime=null;this._seekEndTimer=null;this._unhandleTimeupdate=bind(this._unhandleTimeupdate,this);this._handleTimeupdate=bind(this._handleTimeupdate,this);this._handleSeeking=bind(this._handleSeeking,this);this._handleSeeked=bind(this._handleSeeked,this);this.emitSeeking=bind(this.emitSeeking,this);this.emitSeeked=bind(this.emitSeeked,this);this.on={seeking:new Event("seeking"),seeked:new Event("seeked")};}SeekingMonitor.prototype={setup:function(element){log.log("SeekingMonitor::setup");this.element=element;this._lastPlayhead=this.element.currentTime||0;this.element.addEventListener("timeupdate",this._handleTimeupdate,false);this.element.addEventListener("seeking",this._unhandleTimeupdate,false);this.element.addEventListener("seeking",this._handleSeeking,false);this.element.addEventListener("seeked",this._handleSeeked,false);},teardown:function(){log.log("SeekingMonitor::teardown");if(!this.element){return;}this.element.removeEventListener("timeupdate",this._handleTimeupdate);this.element.removeEventListener("seeking",this._unhandleTimeupdate);this.element.removeEventListener("seeking",this._handleSeeking);this.element.removeEventListener("seeked",this._handleSeeked);},_resetSeekEndTimer:function(){if(this._seekEndTimer){log.log("SeekingMonitor::_resetSeekEndTimer","pushing seek end out further");window.clearTimeout(this._seekEndTimer);}this._seekEndTimer=window.setTimeout(this.emitSeeked,seekEndDelay);},_unhandleTimeupdate:function(){log.log("SeekingMonitor::_unhandleTimeupdate");this.element.removeEventListener("timeupdate",this._handleTimeupdate);this.element.removeEventListener("seeking",this._unhandleTimeupdate);},_handleTimeupdate:function(event){var currentPlayhead=this.element.currentTime;var now=Utils.now();var then=this._lastPlayheadTime||(this._lastPlayheadTime=now);var lastPlayhead=this._lastPlayhead;var timeDiff=now-then;if(timeDiff<playheadThreshold){return;}var playheadDiff=Math.floor(Math.abs(currentPlayhead-lastPlayhead)*1000);var expectedDiff=Math.abs(this.element.playbackRate||1)*timeDiff;log.debug("SeekingMonitor::_handleTimeupdate","currentTime",this.element.currentTime,"playheadDiff",playheadDiff,"expectedDiff",expectedDiff);if(playheadDiff>expectedDiff+playheadThreshold){log.debug("SeekingMonitor::_handleTimeupdate","manually handling seeking via timeupdate");this._handleSeeking(event);}this._lastPlayhead=currentPlayhead;this._lastPlayheadTime=now;},_canEmitSeeking:function(){return(Utils.now()-this._seekStartTime>seekingThrottle&&Math.abs(this.element.currentTime-this._playheadAtSeekStart)>1);},_handleSeeking:function(event){var currentPlayhead=this.element.currentTime;var threshold=playheadThreshold/1000;if(currentPlayhead<threshold){log.debug("SeekingMonitor::_handleSeeking","ignoring seek!","currentTime < "+threshold+":",this.element.currentTime);return;}var seekStart=false;if(nil(this._playheadAtSeekStart)){log.debug("SeekingMonitor::_handleSeeking","start of seek!","currentTime",this.element.currentTime);seekStart=true;this._playheadAtSeekStart=currentPlayhead;this._seekStartTime=Utils.now();}if(seekStart||this._canEmitSeeking()){this.emitSeeking();}this._resetSeekEndTimer();},_handleSeeked:function(event){log.log("SeekingMonitor::_handleSeeked");this._resetSeekEndTimer();},emitSeeking:function(){log.log("SeekingMonitor::emitSeeking");this.on.seeking.dispatch();},emitSeeked:function(){log.log("SeekingMonitor::emitSeeked");this._playheadAtSeekStart=null;this._seekStartTime=null;this.on.seeked.dispatch();}};return SeekingMonitor;})();var VideoPlayer=BasePlayer.extend({init:function(options){this._super(options);this.playerOptions.controls=this.options.controls;this.playerOptions.autoplay=(Browser.allowedAutoPlay&&this.options.autostart)||false;this._supportedFileTypes=this._determineSupportedFileTypes();this._firePlay=false;this._addedListeners=false;this._loaded=false;this._muted=false;this._paused=false;this._buffering=false;this._timeAtSeekBegin=null;this._seeking=false;this._fullscreen=false;this._seekingMonitor=new SeekingMonitor();this._seekingMonitor.on.seeking.addListener(this._onContentSeeking,this);this._seekingMonitor.on.seeked.addListener(this._onContentSeeked,this);this._onLoadedMetaDataBind=bind(this._onLoadedMetaData,this);this._onContentPlayBind=bind(this._onContentPlay,this);
this._onContentEndBind=bind(this._onContentEnd,this);this._onContentPauseBind=bind(this._onContentPause,this);this._onContentPlayingBind=bind(this._onContentPlaying,this);this._onContentErrorBind=bind(this._onContentError,this);this._onContentPlayheadBind=bind(this._onContentPlayhead,this);this._onContentBufferingBind=bind(this._onContentBuffering,this);this._onContentVolumeBind=bind(this._onContentVolume,this);this._onW3FullscreenChangeBind=bind(this._onW3FullscreenChange,this);this._onWebKitFullscreenChangeBind=bind(this._onWebKitFullscreenChange,this);this._onMozFullscreenChangeBind=bind(this._onMozFullscreenChange,this);this._onWebKitBeginFullscreenBind=bind(this._onWebKitBeginFullscreen,this);this._onWebKitEndFullscreenBind=bind(this._onWebKitEndFullscreen,this);this._onW3FullscreenErrorBind=bind(this._onW3FullscreenError,this);this._onWebKitFullscreenErrorBind=bind(this._onWebKitFullscreenError,this);this._onMozFullscreenErrorBind=bind(this._onMozFullscreenError,this);},_setupSeekingMonitor:function(){this._seekingMonitor.setup(this.element);},_teardownSeekingMonitor:function(){this._seekingMonitor.teardown();},render:function(options){this._super(options);this.eRendered.addListener(this.addFullscreenListeners,this);},firePause:function(){this.eTrackingPaused.dispatch({contentId:this._catalogEntry.getId(),playhead:this.element.currentTime,paused:this._paused});this.eContentPause.dispatch(this._catalogEntry.getId(),this._paused);},fireBuffering:function(){this.eContentBuffering.dispatch(this._catalogEntry.getId(),this._buffering);},fireMetadata:function(){this.eContentMetadata.dispatch(this._catalogEntry.getId(),this.element.duration||this._catalogEntry.getTrt(),+(this.width),+(this.height));},firePlayhead:function(){this.eContentPlayhead.dispatch(this._catalogEntry.getId(),this.element.currentTime,this.element.duration);},fireSeek:function(){this.eTrackingContentSeek.dispatch({contentId:this._catalogEntry.getId(),previousPlayhead:this._timeAtSeekBegin,newPlayhead:this.element.currentTime,duration:this.element.duration});},fireSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch({contentId:this._catalogEntry.getId(),previousPlayhead:this._timeAtSeekBegin,newPlayhead:this.element.currentTime,duration:this.element.duration});},getMarkup:function(){return template('<video id="{0}" width={1} height={2} controls {3}></video>',this.elementId,this.width,this.height,this.airplay);},play:(!Browser.allowedAutoPlay?function(catalogEntry){this._catalogEntry=catalogEntry;var url=this._getFileUrl(catalogEntry)||"";log.debug("VideoPlayer","url to play (autoplay disallowed):",url);this.setDefaultOptions();this._setThumbnail();this.element.src=url;this.element.load();this.element.play();this._firePlay=true;}:function(catalogEntry){this._catalogEntry=catalogEntry;var url=this._getFileUrl(catalogEntry)||"";log.debug("VideoPlayer","url to play (autoplay allowed):",url);if(!this.playerOptions.autoplay){this._setThumbnail();log.debug("VideoPlayer","displaying thumbnail since video is not autoplay-ing");}this.element.src=url;this.element.load();}),pause:function(){this.element.pause();},resume:function(){if(this._paused){this.element.play();}},seek:function(seconds){if(!this._loaded){log.warn("VideoPlayer","cannot seek a video that has not loaded.");return;}this.element.currentTime=seconds;},setVolume:function(v){this.element.volume=v;},getVolume:function(){return this.element.volume;},mute:function(){this.element.muted=true;},unmute:function(){this.element.muted=false;},resize:function(width,height){this.element.width=width;this.element.height=height;this._onContentResize();},getFullscreenElement:function(){return document.fullscreenElement||document.webkitFullscreenElement||document.webkitCurrentFullScreenElement||document.mozFullscreenElement;},_requestFullscreen:function(el){var methodNames=["requestFullscreen","requestFullScreen","webkitRequestFullscreen","webkitRequestFullScreen","webkitEnterFullscreen","webkitEnterFullScreen","mozRequestFullScreen"];for(var name,i=0,endi=methodNames.length;i<endi;++i){name=methodNames[i];if(name in el&&typeof el[name]==="function"){return el[name]();}}},_exitFullscreen:function(){var methodNames=["exitFullscreen","cancelFullscreen","cancelFullScreen","webkitExitFullscreen","webkitExitFullScreen","webkitCancelFullscreen","webkitCancelFullScreen","mozCancelFullScreen"];for(var name,i=0,endi=methodNames.length;i<endi;++i){name=methodNames[i];if(name in document&&typeof document[name]==="function"){return document[name]();}}},goFullscreen:function(){if(Browser.forcesFullscreen){log.warn("VideoPlayer","goFullscreen is not permitted on devices that automatically play video in fullscreen.");return;}var uiElement=this.element;if(this.getFullscreenElement()===uiElement){try{this._exitFullscreen();}catch(e){log.error("VideoPlayer","goFullscreen failed to exit fullscreen",e.message);}}else{try{this._requestFullscreen(uiElement);}catch(e){log.error("VideoPlayer","goFullscreen failed to enter fullscreen",e.message);}}},getDimensions:function(){return({width:this.element.width,height:this.element.height,videoWidth:this.element.videoWidth,videoHeight:this.element.videoHeight});},setDefaultOptions:function(){this.setOptions(this.playerOptions);},setOptions:function(options){options=options||{};var option;for(option in options){if(hasOwn(options,option)){this.element[option]=options[option];}}},_setThumbnail:function(){var image=this.getThumbnail();log.debug("VideoPlayer","_setThumbnail",image);if(image){if(this.element.poster){this.element.removeAttribute("poster");}this.element.poster=image;}},getThumbnail:function(){return(this._catalogEntry?this._catalogEntry.getThumbnailUrl(this.width,this.height):"");},_onLoadedMetaData:function(){log.debug("VideoPlayer","_onLoadedMetaData");this._loaded=true;this.fireMetadata();if(Browser.allowedAutoPlay){this._onLoaded();}},_onLoaded:function(){log.debug("VideoPlayer","_onLoaded");this.setDefaultOptions();this._firePlay=true;this.element.play();},_onContentPlay:function(){log.debug("VideoPlayer","_onContentPlay");if(this._paused){this._paused=false;this.firePause();}if(this._firePlay){this.firePlay();this._firePlay=false;}},_onContentPlaying:function(){log.debug("VideoPlayer","_onContentPlaying");if(this._buffering){this._buffering=false;this.fireBuffering();}},_onContentPause:function(){log.debug("VideoPlayer","_onContentPause");this._paused=true;if(this.element.currentTime!==this.element.duration){this.firePause();}},_onContentPlayhead:function(){if(!this._seeking){this.firePlayhead();}},_onContentSeeking:function(){log.debug("VideoPlayer","_onContentSeeking");this._seeking=true;if(nil(this._timeAtSeekBegin)){this._timeAtSeekBegin=this.element.currentTime;}this.fireSeek();},_onContentSeeked:function(){log.debug("VideoPlayer","_onContentSeeked");this.fireSeekEnd();this._seeking=false;this._timeAtSeekBegin=null;},_onContentEnd:function(){log.debug("VideoPlayer","_onContentEnd");this.fireEnded();},_onContentError:function(event){var errorMessage=CVP.MEDIA_ERR_UNKNOWN;if(event.target&&event.target.error){switch(event.target.error.code){case event.target.error.MEDIA_ERR_ABORTED:errorMessage=CVP.MEDIA_ERR_ABORTED;break;case event.target.error.MEDIA_ERR_NETWORK:errorMessage=CVP.MEDIA_ERR_NETWORK;break;case event.target.error.MEDIA_ERR_DECODE:errorMessage=CVP.MEDIA_ERR_DECODE;break;case event.target.error.MEDIA_ERR_SRC_NOT_SUPPORTED:errorMessage=CVP.MEDIA_ERR_SRC_NOT_SUPPORTED;break;}}log.error("VideoPlayer","_onContentError",errorMessage);this.eContentError.dispatch(this._catalogEntry.getId(),errorMessage);},_onContentBuffering:function(){log.debug("VideoPlayer","_onContentBuffering");if(!this._rendered){return;}this._buffering=true;this.fireBuffering();},_onContentVolume:function(){var muteTransition=this._muted!==this.element.muted;log.debug("VideoPlayer","_onContentVolume");if(muteTransition){this._muted=this.element.muted;this.eTrackingMuted.dispatch({contentId:this._catalogEntry.getId(),muted:this.element.muted});
}this.eContentVolume.dispatch(this.element.muted,this.element.volume);},_onContentResize:function(){log.debug("VideoPlayer","_onContentResize");this.eContentResize.dispatch(this.element.width,this.element.height,this._fullscreen);},_onFullscreenChange:function(isFullscreen,fullscreenElement){if(!isFullscreen||(isFullscreen&&fullscreenElement===this._videoPlayer.element)){if(isFullscreen!==this._fullscreen){this._fullscreen=isFullscreen;this.eFullscreenChange.dispatch(this._fullscreen,fullscreenElement);}}},_onW3FullscreenChange:function(){var fullscreenElement=document.fullscreenElement;var fullscreenEnabled=!!(document.fullscreenEnabled||document.fullscreen)||!!(fullscreenElement);log.debug("VideoPlayer","_onW3FullscreenChange",fullscreenEnabled,fullscreenElement);this.eFullscreenChange.dispatch(fullscreenEnabled,fullscreenElement);},_onWebKitFullscreenChange:function(){var fullscreenElement=document.webkitFullscreenElement;var fullscreenEnabled=!!(document.webkitIsFullScreen)||!!(fullscreenElement);log.debug("VideoPlayer","_onWebKitFullscreenChange",fullscreenEnabled,fullscreenElement);this.eFullscreenChange.dispatch(fullscreenEnabled,fullscreenElement);},_onMozFullscreenChange:function(){var fullscreenElement=document.mozFullScreenElement;var fullscreenEnabled=!!(document.mozFullScreen||document.fullScreen)||!!(fullscreenElement);log.debug("VideoPlayer","_onMozFullscreenChange",fullscreenEnabled,fullscreenElement);this.eFullscreenChange.dispatch(fullscreenEnabled,fullscreenElement);},_onWebKitBeginFullscreen:function(){var fullscreenElement=this.element;var fullscreenEnabled=true;log.debug("VideoPlayer","_onWebKitBeginFullscreen",fullscreenEnabled,fullscreenElement);this.eFullscreenChange.dispatch(fullscreenEnabled,fullscreenElement);},_onWebKitEndFullscreen:function(){var fullscreenElement=null;var fullscreenEnabled=false;log.debug("VideoPlayer","_onWebKitEndFullscreen",fullscreenEnabled,fullscreenElement);this.eFullscreenChange.dispatch(fullscreenEnabled,fullscreenElement);},_onFullscreenError:function(){log.debug("VideoPlayer","_onFullscreenError");},_onW3FullscreenError:function(){log.debug("VideoPlayer","_onW3FullscreenError");this.eFullscreenError.dispatch();},_onWebKitFullscreenError:function(){log.debug("VideoPlayer","_onWebKitFullscreenError");this.eFullscreenError.dispatch();},_onMozFullscreenError:function(){log.debug("VideoPlayer","_onMozFullscreenError");this.eFullscreenError.dispatch();},addFullscreenListeners:function(){if(!this.element||this._addedFullscreenListeners){return;}log.debug("VideoPlayer","addFullscreenListeners");this.element.addEventListener("webkitbeginfullscreen",this._onWebKitBeginFullscreenBind,false);this.element.addEventListener("webkitendfullscreen",this._onWebKitEndFullscreenBind,false);document.addEventListener("fullscreenchange",this._onW3FullscreenChangeBind,false);document.addEventListener("webkitfullscreenchange",this._onWebKitFullscreenChangeBind,false);document.addEventListener("mozfullscreenchange",this._onMozFullscreenChangeBind,false);document.addEventListener("fullscreenerror",this._onW3FullscreenErrorBind,false);document.addEventListener("webkitfullscreenerror",this._onWebKitFullscreenErrorBind,false);document.addEventListener("mozfullscreenerror",this._onMozFullscreenErrorBind,false);this._addedFullscreenListeners=true;},removeFullscreenListeners:function(){if(!this.element||!this._addedFullscreenListeners){return;}log.debug("VideoPlayer","removeFullscreenListeners");this.element.removeEventListener("webkitbeginfullscreen",this._onWebKitBeginFullscreenBind,false);this.element.removeEventListener("webkitendfullscreen",this._onWebKitEndFullscreenBind,false);this.eFullscreenChange.removeListener(this._onFullscreenChange,this);document.removeEventListener("fullscreenchange",this._onW3FullscreenChangeBind,false);document.removeEventListener("webkitfullscreenchange",this._onWebKitFullscreenChangeBind,false);document.removeEventListener("mozfullscreenchange",this._onMozFullscreenChangeBind,false);this.eFullscreenError.removeListener(this._onFullscreenError,this);document.removeEventListener("fullscreenerror",this._onW3FullscreenErrorBind,false);document.removeEventListener("webkitfullscreenerror",this._onWebKitFullscreenErrorBind,false);document.removeEventListener("mozfullscreenerror",this._onMozFullscreenErrorBind,false);this._addedFullscreenListeners=false;},addPlayerListeners:function(){if(this.element&&!this._addedListeners){log.debug("VideoPlayer","addPlayerListeners");this.element.addEventListener("loadedmetadata",this._onLoadedMetaDataBind,false);this.element.addEventListener("play",this._onContentPlayBind,false);this.element.addEventListener("ended",this._onContentEndBind,false);this.element.addEventListener("playing",this._onContentPlayingBind,false);this.element.addEventListener("pause",this._onContentPauseBind,false);this.element.addEventListener("timeupdate",this._onContentPlayheadBind,false);this.element.addEventListener("error",this._onContentErrorBind,false);this.element.addEventListener("waiting",this._onContentBufferingBind,false);this.element.addEventListener("volumechange",this._onContentVolumeBind,false);this._setupSeekingMonitor();this._addedListeners=true;}},removePlayerListeners:function(){if(this.element&&this._addedListeners){log.debug("VideoPlayer","removePlayerListeners");this.element.removeEventListener("loadedmetadata",this._onLoadedMetaDataBind,false);this.element.removeEventListener("play",this._onContentPlayBind,false);this.element.removeEventListener("ended",this._onContentEndBind,false);this.element.removeEventListener("playing",this._onContentPlayingBind,false);this.element.removeEventListener("pause",this._onContentPauseBind,false);this.element.removeEventListener("timeupdate",this._onContentPlayheadBind,false);this.element.removeEventListener("error",this._onContentErrorBind,false);this.element.removeEventListener("waiting",this._onContentBufferingBind,false);this.element.removeEventListener("volumechange",this._onContentVolumeBind,false);this._teardownSeekingMonitor();this._addedListeners=false;}},_getFileUrl:function(catalogEntry){var url="";url=this._getFileByParameterFallback(catalogEntry);if(!url){url=this._getFileByFallback(catalogEntry);}if(!url){url=catalogEntry.getContentUrl(_configInfo.lowBitrate);if(!this._isFileSupported(url)){log.info("VideoPlayer","File is not supported!",url);log.info("VideoPlayer","Attempting to find a compatible file");url=this._getFileBySupportedType(catalogEntry);if(empty(url)){url=this._getFileByConfigFallbackParam(catalogEntry);}log.info("VideoPlayer","Found:",url);}}else{log.info("VideoPlayer","Fallback file found",url);}if(!url){log.error("VideoPlayer","No valid media file found!",catalogEntry.getId());}return url;},_getFileByParameterFallback:function(catalogEntry){var i=0,endi=this.perVideoFallbacks.length,dvf,criteria;for(;i<endi;++i){dvf=this.perVideoFallbacks[i];criteria=ConfigUtils.stringReplace(dvf.criteria,catalogEntry,false);if(dvf.evaluate(criteria)){return ConfigUtils.stringReplace(dvf.filter,catalogEntry,false);}}return null;},_getFileByConfigFallbackParam:function(catalogEntry){var str=_configInfo.fallbackFilenameIOS;if(empty(str)){return str;}else{str=ConfigUtils.stringReplace(str,catalogEntry,false);}return str;},_getFileByFallback:function(catalogEntry){if(Browser.isOS(Browser.IOS)){return catalogEntry.getContentUrlFromFallback("iOS");}},_getFileBySupportedType:function(catalogEntry){var url=null,i=0,len=this._supportedFileTypes.length;for(;i<len&&empty(url);++i){url=catalogEntry.getContentUrlFromType(this._supportedFileTypes[i]);}return url;},_isFileSupported:function(url){if(!empty(url)){var ext=url.indexOf(".")>-1?url.substring(url.lastIndexOf(".")+1):url,i=0,len=this._supportedFileTypes.length;for(;i<len;++i){if(ext===this._supportedFileTypes[i]){return true;}}}return false;},_determineSupportedFileTypes:function(){var fileTypes=[];if(!Browser.isPlatform(Browser.DESKTOP)&&Browser.supports.m3u8){fileTypes.push("m3u8");
}if(Browser.supports.mp4){fileTypes.push("mp4");}return fileTypes;}});var DummyPlayStartStrategy=Class.extend({init:function(element,poster,autostart){log.debug("[StartStrategy] init: ",arguments);this.eReady=new Event();this._element=element;this._poster=poster;this._autostart=autostart;this._elementSrc=CDN_PREFIX+"/xslo/cvp/assets/video/blank.mp4";},execute:function(){var self=this,fired=false,events=this._getEventList();var listeners=function(add,cb){var method=add?"addEventListener":"removeEventListener";for(var i=0,len=events.length;i<len;i++){self._element[method](events[i],cb);}};var cb=function(event){log.debug("[StartStrategy] received: ",event.type);listeners(false,cb);if(!fired){fired=true;self._element.controls="";self._element.pause();self._fireReady();}};log.debug("[StartStrategy] execute");listeners(true,cb);if(this._poster){if(this._element.poster){this._element.removeAttribute("poster");}this._element.poster=this._poster;}this._element.controls=true;this._element.src=this._elementSrc;this._element.load();if(this._autostart){this._element.play();}},_getEventList:function(){var events=["click","loadedmetadata","play"];return events;},_fireReady:function(){this.eReady.dispatch();}});var AdServerProxy=Class.extend({init:function(){this.eAdPlay=new Event();this.eAdPlayhead=new Event();this.eAdEnd=new Event();this.eAdError=new Event();this.eTrackingAdStart=new Event();this.eTrackingAdComplete=new Event();this._adServerType=_adPolicy.ads.attr.type.toLowerCase();this._adServer=this._createImpl();if(!this._adServer){log.warn("AdServerProxy","Unable to create ad server impl.");return;}this._adServer.eAdPlay.addListener(this._onAdPlay,this);this._adServer.eAdPlayhead.addListener(this._onAdPlayhead,this);this._adServer.eAdEnd.addListener(this._onAdEnd,this);this._adServer.eAdError.addListener(this._onAdError,this);this._adServer.eTrackingAdStart.addListener(this._onTrackingAdStart,this);this._adServer.eTrackingAdComplete.addListener(this._onTrackingAdComplete,this);},_createImpl:function(){var type=this._adServerType;switch(type){case"freewheel":return new FreeWheelImpl();case"dfp":return new DFPImpl();default:return null;}},setAdSection:function(adSection){if(this._adServer){this._adServer.setAdSection(adSection);}},getAdSection:function(){if(this._adServer){return this._adServer.getAdSection();}},setAdKeyValue:function(key,value){if(this._adServer){this._adServer.setAdKeyValue(key,value);}},getAdKeyValue:function(key){if(this._adServer){return this._adServer.getAdKeyValue(key);}},getAdKeyValues:function(){if(this._adServer){return this._adServer.getAdKeyValues();}},setVideoDisplayBase:function(videoDisplayBase){if(this._adServer){this._adServer.setVideoDisplayBase(videoDisplayBase);}},isEnabled:function(){return this._adServer?this._adServer.enabled:false;},playPreroll:function(){if(this._adServer){this._adServer.playPreroll();}},playPostroll:function(){if(this._adServer){this._adServer.playPostroll();}},loadAds:function(catalogEntry){if(this._adServer){this._adServer.loadAds(catalogEntry);}},getCurrentAdId:function(){if(this._adServer){return this._adServer.currentAdId;}return"";},getCurrentAdDuration:function(){if(this._adServer){return this._adServer.currentAdDuration;}return 0;},getCurrentAdType:function(){return this._convertAdType(this._adServer.currentAdType);},_convertAdType:function(adType){switch(this._adServerType){case"freewheel":switch(adType){case FreeWheelImpl.PREROLL:return AdServerProxy.PREROLL;case FreeWheelImpl.POSTROLL:return AdServerProxy.POSTROLL;}break;case"dfp":switch(adType){case DFPImpl.PREROLL:return AdServerProxy.PREROLL;case DFPImpl.POSTROLL:return AdServerProxy.POSTROLL;}break;}return"";},_onAdPlay:function(event){var data={ads:[],token:"",mode:"standard",id:this.getCurrentAdId(),duration:this.getCurrentAdDuration(),blockId:"",adType:this.getCurrentAdType()};log.debug("AdServerProxy","_onAdPlay",data.adType);this.eAdPlay.dispatch(data);},_onAdPlayhead:function(playhead,duration){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments);},_onAdEnd:function(event){var data={token:"",mode:"standard",id:this.getCurrentAdId(),blockId:"",adType:this.getCurrentAdType()};log.debug("AdServerProxy","_onAdEnd",data.adType);this.eAdEnd.dispatch(data);},_onAdError:function(event){var data={id:this.getCurrentAdId(),adType:this.getCurrentAdType(),errors:[]};this.eAdError.dispatch(data);},_onTrackingAdStart:function(event){this.eTrackingAdStart.dispatch();},_onTrackingAdComplete:function(event){this.eTrackingAdComplete.dispatch();}});AdServerProxy.PREROLL="preroll";AdServerProxy.POSTROLL="postroll";var AdImplBase=Class.extend({init:function(){this._keyValues={};this._adServerInfo=_adPolicy.ads;},setAdSection:function(adSection){this._adSection=adSection;},getAdSection:function(adSection){return this._adSection;},setAdKeyValue:function(key,value){if(key){if(value===null){delete this._keyValues[key];}else{this._keyValues[key]=value;}}},getAdKeyValue:function(key){return this._keyValues[key]||undefined;},getAdKeyValues:function(){return this._keyValues;},getConfigProperty:function(key){var value=null;var required=false;switch(key){case"adApi":value=this._adServerInfo.apiUrl;required=true;break;case"adServerRootUrl":value=this._adServerInfo.adServerRootUrl;required=true;break;case"adNetworkId":value=this._adServerInfo.adNetworkId;required=true;break;case"adVideoNetworkId":value=this._adServerInfo.adVideoNetworkId;required=true;break;case"adVideoAssetId":value=this._adServerInfo.adVideoAssetId;required=true;break;case"adSection":value=this._adServerInfo.adSection;required=true;break;case"adPlayerProfile":value=this._adServerInfo.adPlayerProfile;required=true;break;case"renderersUrl":value=this._adServerInfo.renderersUrl;required=false;break;case"sensitiveFallbackId":value=this._adServerInfo.sensitiveFallbackId;required=false;break;case"adLiveContentDuration":value=this._adServerInfo.liveDuration;required=false;break;}if(empty(value)){if(required){log.error("the following required ad server config value is missing:",key);}else{log.warn("the following optional ad server config value is missing:",key);}}return value;}});var FreeWheelImpl=AdImplBase.extend({init:function(){log.debug("FreeWheelImpl","Instantiating");this._super.apply(this,arguments);this._freewheel=null;if(!undef(window.tv)&&window.tv.freewheel){if(!FreeWheelImpl.initialized){FreeWheelImpl.PREROLL=window.tv.freewheel.SDK.TIME_POSITION_CLASS_PREROLL;FreeWheelImpl.POSTROLL=window.tv.freewheel.SDK.TIME_POSITION_CLASS_POSTROLL;FreeWheelImpl.initialized=true;}}else{this.enabled=false;}this.currentAdType="";this.currentAdId="";this.currentAdDuration=0;this._adSection=this.getConfigProperty("adSection");this._adProgress=0;this._adTimer=null;this._adTimerDelay=1000;this._adIncrementor=bind(function(){this._adProgress=Math.floor(this._adProgress+(this._adTimerDelay/1000));if(this._adProgress<=this.currentAdDuration){this.onAdPlayhead(this._adProgress,this.currentAdDuration);}},this);this._ads={};this.eAdPlayhead=new Event();this.eAdPlay=new Event();this.eAdEnd=new Event();this.eAdError=new Event();this.eTrackingAdStart=new Event();this.eTrackingAdComplete=new Event();},setVideoDisplayBase:function(videoDisplayBase){if(!undef(window.tv)&&!undef(window.tv.freewheel)){this.displayBase=videoDisplayBase;this.enabled=true;}},loadAds:function(catalogEntry){this._catalogEntry=catalogEntry;this._ads[FreeWheelImpl.PREROLL]=[];this._ads[FreeWheelImpl.POSTROLL]=[];var serverUrl=this.getConfigProperty("adServerRootUrl")+"/ad/g/1?nw="+this.getConfigProperty("adNetworkId")+"&prof="+this.getConfigProperty("adNetworkId")+":turner_html5"+"&flag=+sltp+exvt+slcb+unka+unks;";var duration=catalogEntry.getTrt();var adId=(empty(this._adServerInfo.adVideoAssetId)?catalogEntry.getId():ConfigUtils.stringReplace(this._adServerInfo.adVideoAssetId,catalogEntry,false));this._freewheel=new window.tv.freewheel.SDK.AdManager();this._freewheel.setServerURL(serverUrl);this._freewheel.setVideoAsset(adId,duration);this._freewheel.setSiteSection(this._adSection);
this._freewheel.registerVideoDisplayBase(this.displayBase);var keyValues=this.getAdKeyValues();for(var key in keyValues){if(hasOwn(keyValues,key)){this._freewheel.addKeyValue(key,keyValues[key]);}}this._freewheel.submitRequest(bind(this.playPreroll,this),2000);},playPreroll:function(freewheelData){log.debug("FreeWheelImpl","playPreroll");this._parseData(freewheelData);this.currentAdType=FreeWheelImpl.PREROLL;this._adPlay(FreeWheelImpl.PREROLL,bind(this.onPrerollCompleted,this));},_parseData:function(freewheelData){var fw=freewheelData;var ads=fw&&fw.success&&fw.response&&fw.response.ads&&fw.response.ads.ads;if(isArray(ads)&&ads.length!==0){try{var adsLen=ads.length;var findAdById=function(adId){for(var i=0;i<adsLen;i++){if(ads[i].adId==adId){return ads[i];}}return null;};var adSlots=fw.response.siteSection.videoPlayer.videoAsset.adSlots;for(var i=0,len=adSlots.length;i<len;i++){var id=adSlots[i].selectedAds[0].adId;var ad=findAdById(id);if(ad){if(adSlots[i].timePositionClass=="preroll"){this._ads[FreeWheelImpl.PREROLL].push(ad);}else{if(adSlots[i].timePositionClass=="postroll"){this._ads[FreeWheelImpl.POSTROLL].push(ad);}}}}}catch(e){}}},onPrerollCompleted:function(){log.debug("FreeWheelImpl","onPrerollCompleted");this._adEnd();},playPostroll:function(){log.debug("FreeWheelImpl","playPostroll");this.currentAdType=FreeWheelImpl.POSTROLL;this._adPlay(FreeWheelImpl.POSTROLL,bind(this.onPostrollCompleted,this));},onPostrollCompleted:function(){log.debug("FreeWheelImpl","onPostrollCompleted");this._adEnd();},_adPlay:function(adType,cb){var entry=this._catalogEntry;if(entry.isAdSensitive()){this._adError("catalogEntry specified 'isAdSensitive'; skipping ad play.");return;}var slots=this._ads[adType];if(!slots.length){this._adError("no slots provided for the ad type: "+adType);return;}var slot=slots[0];this.currentAdId=slot.adId;this.currentAdDuration=slot.creatives[0].duration;this._adProgress=0;this._adTimer=window.setInterval(this._adIncrementor,this._adTimerDelay);this.eTrackingAdStart.dispatch(entry);this.eAdPlay.dispatch(entry);this._freewheel.playSlots(adType,cb);},_adEnd:function(){var entry=this._catalogEntry;if(this._adTimer!==null){window.clearInterval(this._adTimer);this._adTimer=null;this.eTrackingAdComplete.dispatch(entry);}this.eAdEnd.dispatch(entry);this._freewheel.dispose();this.currentAdId="";},_adError:function(event){log.debug("FreeWheelImpl","_onAdError",event);this.eAdError.dispatch(event);},onAdPlayhead:function(playhead,duration){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments);}});FreeWheelImpl.PREROLL=null;FreeWheelImpl.POSTROLL=null;var DFPImpl=AdImplBase.extend({init:function(){log.debug("DFPImpl","Instantiating");this._super.apply(this,arguments);this.enabled=false;this._loader=new window.google.ima.AdsLoader();this._loader.addEventListener(window.google.ima.AdsLoadedEvent.Type.ADS_LOADED,bind(this._onAdsLoaded,this));this._loader.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,bind(this._onAdLoadError,this));this.currentAdType="";this.currentAdId="";this.currentAdDuration=0;this._adSection=this.getConfigProperty("adSection");this.eAdPlayhead=new Event();this.eAdPlay=new Event();this.eAdEnd=new Event();this.eAdError=new Event();this.eTrackingAdStart=new Event();this.eTrackingAdComplete=new Event();},setVideoDisplayBase:function(videoDisplayBase){log.debug("DFP","setVideoDisplayBase",videoDisplayBase);if(!undef(window.google)&&!undef(window.google.ima.AdsLoader)){this.displayBase=videoDisplayBase;this.enabled=true;log.debug("DFP","setVideoDisplayBase","videoDisplayBase","enabling");}},loadAds:function(catalogEntry){this._catalogEntry=catalogEntry;this.playPreroll();},playPreroll:function(){var preroll=this._catalogEntry.getAdUrl("preroll");var url=this._constructAdUrl(preroll,this._catalogEntry);this.currentAdType=DFPImpl.PREROLL;this.loadAds(url);},playPostroll:function(){var postroll=this._catalogEntry.getAdUrl("postroll");var url=this._constructAdUrl(postroll,this._catalogEntry);this.currentAdType=DFPImpl.POSTROLL;this.loadAds(url);},_loadAdUrl:function(url){log.debug("DFP","_loadAdUrl - adTag",url);var adsRequest={adTagUrl:url,adType:"video"};this._loader.requestAds(adsRequest);},_constructAdUrl:function(entryAdTag,catalogEntry){var adTag="";var baseUrl=this.getConfigProperty("adServerRootUrl");if(empty(entryAdTag)){adTag=baseUrl;}else{if(isRelativePath(entryAdTag)){adTag=this._addToTag(baseUrl,entryAdTag);}else{adTag=entryAdTag;}}var keyValues=this.getAdKeyValues();for(var key in keyValues){if(hasOwn(keyValues,key)){var newPair=key+"="+this._keyValues[key];adTag=this._addToTag(adTag,newPair);}}adTag=ConfigUtils.stringReplace(adTag,catalogEntry);return adTag;},_addToTag:function(adTag,pair){if(!adTag){return pair;}var delimiter=";";if(adTag.charAt(adTag.length-1)===";"){delimiter="";}return adTag+delimiter+pair;},_onAdsLoaded:function(event){log.debug("DFP","_onAdsLoaded");var adsManager=event.getAdsManager();adsManager.addEventListener(window.google.ima.AdErrorEvent.Type.AD_ERROR,bind(this._onAdError,this));adsManager.addEventListener(window.google.ima.AdEvent.Type.CONTENT_PAUSE_REQUESTED,bind(this._onPauseRequested,this));adsManager.addEventListener(window.google.ima.AdEvent.Type.CONTENT_RESUME_REQUESTED,bind(this._onResumeRequested,this));try{this.eAdPlay.dispatch();var playSettings={restoreContentState:false};var element=document.getElementById(this.displayBase).getElementsByTagName("video")[0];adsManager.play(element,playSettings);}catch(adError){log.error("DFP","ad play error",adError.toString());}},_onAdLoadError:function(){log.debug("DFP","_onAdLoadError");this.eAdError.dispatch();},_onPauseRequested:function(){log.debug("DFP","_onPauseRequested");},_onResumeRequested:function(){log.debug("DFP","_onResumeRequested");this.eAdEnd.dispatch();},_onAdError:function(event){log.debug("DFP","_onAdError",event.toString());this.eAdError.dispatch();}});DFPImpl.PREROLL="dfpPreroll";DFPImpl.POSTROLL="dfpPostroll";var PlayerController=Class.extend({init:function(){this._commandQ=new CommandQueue();this._videoPlayer=new VideoPlayer({containerElement:"player_container",elementId:_params.id||"cvp_videoPlayer_"+now(),width:_params.width,height:_params.height,controls:true,autostart:_params.autostart});this._videoPlayer.eRendered.addListener(this._onRendered,this);this._videoPlayer.eFullscreenChange.addListener(this._onFullscreenChange,this);this._videoPlayer.eContentMetadata.addListener(this._onContentMetadata,this);this._videoPlayer.eContentPlay.addListener(this._onContentPlay,this);this._videoPlayer.eContentPause.addListener(this._onContentPause,this);this._videoPlayer.eContentEnd.addListener(this._onContentEnd,this);this._videoPlayer.eContentPlayhead.addListener(this._onContentPlayhead,this);this._videoPlayer.eContentBuffering.addListener(this._onContentBuffering,this);this._videoPlayer.eContentVolume.addListener(this._onContentVolume,this);this._videoPlayer.eContentError.addListener(this._onContentError,this);this._videoPlayer.eContentResize.addListener(this._onContentResize,this);this._adProxy=new AdServerProxy();this._adProxy.eAdPlayhead.addListener(this._onAdPlayhead,this);this._adProxy.eAdPlay.addListener(this._onAdPlay,this);this._adProxy.eAdEnd.addListener(this._onAdEnd,this);this._adProxy.eAdError.addListener(this._onAdError,this);this._adProxy.eTrackingAdStart.addListener(this._onTrackingAdStart,this);this._adProxy.eTrackingAdComplete.addListener(this._onTrackingAdComplete,this);this._videoPlayer.eContentPlay.addListener(this._onTrackingContentPlay,this);this._videoPlayer.eContentEnd.addListener(this._onTrackingContentEnd,this);this._videoPlayer.eTrackingContentSeek.addListener(this._onTrackingContentSeek,this);this._videoPlayer.eTrackingContentSeekEnd.addListener(this._onTrackingContentSeekEnd,this);this._videoPlayer.eTrackingMuted.addListener(this._onTrackingMuted,this);this._videoPlayer.eTrackingPaused.addListener(this._onTrackingPaused,this);this._currentContentId="";this._contentQueue=[];this._isShimmed=false;
this._firstPlay=true;this._delayPlayerControls=false;this._triggeredAd=false;this._currentAdDuration=0;this._currentAdPlayhead=0;this._totalAdPlayTime=0;this._trackingAdStart=0;this._trackingAdTimer=null;this._getElapsedTrackingAdTime=function(){return(this._trackingAdStart===0?0:(now()-this._trackingAdStart)/1000);};this._getTotalTrackingAdTime=function(){return this._totalAdPlayTime+this._getElapsedTrackingAdTime();};this._tallyTotalTrackingAdTime=function(){this._totalAdPlayTime+=this._getElapsedTrackingAdTime();};this._startTrackingAdTimer=function(){if(this._trackingAdTimer!==null){return;}this._trackingAdStart=now();this._trackingAdTimer=window.setInterval(bind(this._onTrackingAdProgress,this),60000);};this._stopTrackingAdTimer=function(){if(this._trackingAdTimer===null){return;}this._tallyTotalTrackingAdTime();window.clearInterval(this._trackingAdTimer);this._trackingAdTimer=null;this._trackingAdStart=0;};this._currentContentDuration=0;this._currentContentPlayhead=0;this._totalContentPlayTime=0;this._trackingContentStart=0;this._trackingContentTimer=null;this._getElapsedTrackingContentTime=function(){return(this._trackingContentStart===0?0:(now()-this._trackingContentStart)/1000);};this._getTotalTrackingContentTime=function(){return this._totalContentPlayTime+this._getElapsedTrackingContentTime();};this._tallyTotalTrackingContentTime=function(){this._totalContentPlayTime+=this._getElapsedTrackingContentTime();};this._startTrackingContentTimer=function(){if(this._trackingContentTimer!==null){return;}this._trackingContentStart=now();this._trackingContentTimer=window.setInterval(bind(this._onTrackingContentProgress,this),60000);};this._stopTrackingContentTimer=function(){if(this._trackingContentTimer===null){return;}this._tallyTotalTrackingContentTime();window.clearInterval(this._trackingContentTimer);this._trackingContentTimer=null;this._trackingContentStart=0;};this.eRendered=new Event();this.eContentMetadata=new Event();this.eContentBegin=new Event();this.eContentPlay=new Event();this.eContentPause=new Event();this.eContentEnd=new Event();this.eContentComplete=new Event();this.eContentPlayhead=new Event();this.eContentBuffering=new Event();this.eContentVolume=new Event();this.eContentError=new Event();this.eContentResize=new Event();this.eTrackingAdStart=new Event();this.eTrackingAdComplete=new Event();this.eTrackingAdProgress=new Event();this.eTrackingAdCountdown=new Event();this.eTrackingContentPlay=new Event();this.eTrackingContentEnd=new Event();this.eTrackingContentBegin=new Event();this.eTrackingContentProgress=new Event();this.eTrackingContentComplete=new Event();this.eTrackingContentSeek=new Event();this.eTrackingContentSeekEnd=new Event();this.eTrackingFullscreen=new Event();this.eTrackingMuted=new Event();this.eTrackingPaused=new Event();this.eAdPlayhead=new Event();this.eAdPlay=new Event();this.eAdEnd=new Event();this.eAdError=new Event();},render:function(containerElement){this._adProxy.setVideoDisplayBase(containerElement);this._videoPlayer.render(containerElement);},remove:function(){this._videoPlayer.remove();},_onRendered:function(type){log.debug("_onRendered",type);this._commandQ.execute();this.eRendered.dispatch();},play:function(catalogEntry){log.debug("PlayerController","play",catalogEntry.getId());this._catalogEntry=catalogEntry;if(!this._videoPlayer.rendered()){this._commandQ.push(this.play,this,arguments);return;}this._executePlayStrategy(bind(this._playMedia,this));},reset:function(){log.debug("PlayerController","reset","determine if shim is needed");if(this._firstPlay&&_params.autostart&&!Browser.allowedAutoPlay&&!this._isShimmed){log.debug("PlayerController","reset","first play - run DummyPlayStartStrategy");var dummyStrategy=new DummyPlayStartStrategy(this._videoPlayer.element,null,true);this._videoPlayer.removePlayerListeners();this._delayPlayerControls=true;dummyStrategy.eReady.addListener(bind(function(){log.debug("PlayerController","reset","shim DummyPlayStartStrategy was successful");this._firstPlay=false;dummyStrategy=null;},this));log.debug("PlayerController","reset","executing DummyPlayStartStrategy for shim");dummyStrategy.execute();this._isShimmed=true;}else{log.debug("PlayerController","reset","not first play or in process of being shimmed - no shim needed");}},_executePlayStrategy:function(playFunc){log.debug("PlayerController","_executePlayStrategy");if(this._firstPlay&&!Browser.allowedAutoPlay){log.debug("PlayerController","_executePlayStrategy","first play");this._videoPlayer.removePlayerListeners();this._delayPlayerControls=true;var dummyStrategy=new DummyPlayStartStrategy(this._videoPlayer.element,this._catalogEntry.getThumbnailUrl(this._videoPlayer.width,this._videoPlayer.height),_params.autostart);dummyStrategy.eReady.addListener(function(){log.debug("PlayerController","_executePlayStrategy","DummyPlayStartStrategy was successful");playFunc();dummyStrategy=null;});dummyStrategy.execute();}else{log.debug("PlayerController","_executePlayStrategy","not first play - allow to play");playFunc();}},_playMedia:function(){log.debug("PlayerController","_playMedia");this._firstPlay=false;this._onTrackingContentBegin(this._catalogEntry.getId());this._onContentBegin(this._catalogEntry.getId());if(this._adProxy.isEnabled()){this._adProxy.loadAds(this._catalogEntry);}else{this._playContent();}},_playContent:function(){log.debug("PlayerController","_playContent");if(this._delayPlayerControls){this._videoPlayer.playerOptions.controls=false;}this._videoPlayer.addPlayerListeners();this._videoPlayer.play(this._catalogEntry);},queue:function(catalogEntry){log.debug("PlayerController","queue",catalogEntry.getId());this._contentQueue.push(catalogEntry);},emptyQueue:function(){this._contentQueue=[];},pause:function(){this._videoPlayer.pause();},resume:function(){this._videoPlayer.resume();},seek:function(seconds){this._videoPlayer.seek(seconds);},resize:function(width,height){this._videoPlayer.resize(width,height);},goFullscreen:function(){this._videoPlayer.goFullscreen();},setVolume:function(v){this._videoPlayer.setVolume(v);},getVolume:function(){return this._videoPlayer.getVolume();},mute:function(){this._videoPlayer.mute();},unmute:function(){this._videoPlayer.unmute();},setAdSection:function(ssid){this._adProxy.setAdSection(ssid);},getAdSection:function(){return this._adProxy.getAdSection();},setAdKeyValue:function(key,value){this._adProxy.setAdKeyValue(key,value);},getAdKeyValue:function(key){return this._adProxy.getAdKeyValue(key);},getAdKeyValues:function(){return this._adProxy.getAdKeyValues();},_onContentMetadata:function(contentId,duration,width,height){log.debug("PlayerController","_onContentMetadata");this._currentContentDuration=duration;this.eContentMetadata.dispatch.apply(this.eContentMetadata,arguments);},_onContentBegin:function(contentId){log.debug("PlayerController","_onContentBegin");this._currentContentId=contentId;this.eContentBegin.dispatch.apply(this.eContentBegin,arguments);},_onContentPlay:function(){log.debug("PlayerController","_onContentPlay");if(this._delayPlayerControls){this._videoPlayer.setOptions({controls:true});}this._mediaClass="CONTENT";this.eContentPlay.dispatch.apply(this.eContentPlay,arguments);},_onContentPause:function(){log.debug("PlayerController","_onContentPause");this.eContentPause.dispatch.apply(this.eContentPause,arguments);},_onContentEnd:function(){log.debug("PlayerController","_onContentEnd");this._mediaClass="";this.eContentEnd.dispatch.apply(this.eContentEnd,arguments);if(this._adProxy.isEnabled()){this._videoPlayer.setOptions({controls:false});this._adProxy.playPostroll(this._catalogEntry);}else{this._onContentComplete.apply(this,arguments);}},_onContentComplete:function(){log.debug("PlayerController","_onContentComplete");this._onTrackingContentComplete();this.eContentComplete.dispatch.call(this.eContentComplete,this._catalogEntry.getId());if(this._contentQueue.length){this.play(this._contentQueue.shift());}},_onContentPlayhead:function(contentId,playhead,duration){this._currentContentPlayhead=playhead;
this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,arguments);},_onContentBuffering:function(){log.debug("PlayerController","_onContentBuffering");this.eContentBuffering.dispatch.apply(this.eContentBuffering,arguments);},_onContentVolume:function(){log.debug("PlayerController","_onContentVolume");this.eContentVolume.dispatch.apply(this.eContentVolume,arguments);},_onContentError:function(){log.debug("PlayerController","_onContentError");this.eContentError.dispatch.apply(this.eContentError,arguments);},_onContentResize:function(){log.debug("PlayerController","_onContentResize");this.eContentResize.dispatch.apply(this.eContentResize,arguments);},_onFullscreenChange:function(isFullscreen,fullscreenElement){this._onTrackingFullscreen(this._catalogEntry.getId(),isFullscreen);if(this._mediaClass==="CONTENT"){var dimensions=isFullscreen?{width:window.screen.width,height:window.screen.height}:this._videoPlayer.getDimensions();this._onContentResize(dimensions.width,dimensions.height,isFullscreen);}},_onTrackingAdStart:function(){log.debug("PlayerController","_onTrackingAdStart",arguments);this._startTrackingAdTimer();var dimensions=this._videoPlayer.getDimensions();this.eTrackingAdStart.dispatch({"adTitle":this._adProxy.currentAdId,"adWidth":dimensions.videoWidth,"adHeight":dimensions.videoHeight,"adSection":this.getAdSection(),"contentId":this._catalogEntry.getId(),"originId":this._catalogEntry.getOriginId(),"mediaUrl":this._catalogEntry.getMediaUrl(),"adType":this._adProxy.currentAdType,"adDuration":this._adProxy.currentAdDuration,"adBlock":0,"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingAdComplete:function(){log.debug("PlayerController","_onTrackingAdComplete",arguments);this._stopTrackingAdTimer();this.eTrackingAdComplete.dispatch({"adTitle":this._adProxy.currentAdId,"adType":this._adProxy.currentAdType,"adBlock":0,"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingAdProgress:function(){log.debug("PlayerController","_onTrackingAdProgress",arguments);this.eTrackingAdProgress.dispatch({"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"playheadTime":this._currentAdPlayhead,"grossProgressMarker":0,"adType":this._adProxy.currentAdType,"adTotalPlaytime":this._getTotalTrackingAdTime()});},_onTrackingAdCountdown:function(secs){log.debug("PlayerController","_onTrackingAdCountdown",arguments);this.eTrackingAdCountdown.dispatch({"adMode":"standard","secs":secs});},_onTrackingContentPlay:function(){log.debug("PlayerController","_onTrackingContentPlay",arguments);this._startTrackingContentTimer();this.eTrackingContentPlay.dispatch({"contentId":this._catalogEntry.getId(),"originId":this._catalogEntry.getOriginId(),"mediaUrl":this._catalogEntry.getMediaUrl(),"length":this._catalogEntry.getTrt(),"grossLength":this._catalogEntry.getTrt(),"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingContentEnd:function(){log.debug("PlayerController","_onTrackingContentEnd",arguments);this._stopTrackingContentTimer();this.eTrackingContentEnd.dispatch({"contentId":this._catalogEntry.getId(),"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingContentBegin:function(){log.debug("PlayerController","_onTrackingContentBegin",arguments);this.eTrackingContentBegin.dispatch({"contentId":this._catalogEntry.getId(),"originId":this._catalogEntry.getOriginId(),"contentMode":this._catalogEntry.getMode(),"contentSource":this._catalogEntry.getSource(),"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingContentProgress:function(){log.debug("PlayerController","_onTrackingContentProgress",arguments);var dimensions=this._videoPlayer.getDimensions();this.eTrackingContentProgress.dispatch({"contentId":this._catalogEntry.getId(),"originId":this._catalogEntry.getOriginId(),"playerWidth":dimensions.width,"playerHeight":dimensions.height,"percent":Math.floor(this._currentContentDuration/this._currentContentPlayhead*100),"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"playheadTime":this._currentContentPlayhead,"progressMarker":0,"grossProgressMarker":0,"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingContentComplete:function(){log.debug("PlayerController","_onTrackingContentComplete",arguments);this.eTrackingContentComplete.dispatch({"contentId":this._catalogEntry.getId(),"percent":100,"totalPlayTime":this._getTotalTrackingAdTime()+this._getTotalTrackingContentTime(),"playheadTime":this._currentContentPlayhead,"progressMarker":0,"grossProgressMarker":0,"adTotalPlayTime":this._getTotalTrackingAdTime()});},_onTrackingContentSeek:function(){log.debug("PlayerController","_onTrackingContentSeek");this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,arguments);},_onTrackingContentSeekEnd:function(){log.debug("PlayerController","_onTrackingContentSeekEnd");this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,arguments);},_onTrackingFullscreen:function(){log.debug("PlayerController","_onTrackingFullscreen");this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,arguments);},_onTrackingMuted:function(){log.debug("PlayerController","_onTrackingMuted");this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,arguments);},_onTrackingPaused:function(dataObj){log.debug("PlayerController","_onTrackingPaused");if(dataObj.paused){this._stopTrackingContentTimer();}else{this._startTrackingContentTimer();}this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,arguments);},_onAdPlayhead:function(playhead,duration){this._currentAdPlayhead=playhead;this._currentAdDuration=duration;this._onTrackingAdCountdown(Math.ceil(duration-playhead));this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments);},_onAdPlay:function(event){var ads=event.ads,token=event.token,mode=event.mode,id=event.id,duration=event.duration,blockId=event.blockId,adType=event.adType;log.debug("PlayerController","_onAdPlay","event",event);this._triggeredAd=true;this._mediaClass="AD";this.eAdPlay.dispatch.call(this.eAdPlay,token,mode,id,duration,blockId,adType);this._videoPlayer.removePlayerListeners();},_onAdEnd:function(event){var token=event.token,mode=event.mode,id=event.id,blockId=event.blockId,adType=event.adType;log.debug("PlayerController","_onAdEnd","event",event);this._mediaClass="";if(this._triggeredAd){this.eAdEnd.dispatch.call(this.eAdEnd,token,mode,id,blockId,adType);}this._onAdComplete(adType);},_onAdError:function(event){var i=0,endi=0,error=null,severity=null,adErrors=event.errors,adType=event.adType,errStack=[],severityLevel={INFO:1,WARN:2,ERROR:3,FATAL:4};log.debug("PlayerController","_onAdError");if(undef(event)){errStack.push({severity:"WARN",name:"Received no params to callback, assuming no ad played"});}else{if(!event.success){errStack.push({severity:"ERROR",name:"Did not receive successful response to ad request"});}if(adErrors&&adErrors.length!==0){errStack.concat(adErrors);}}for(endi=errStack.length;i<endi;++i){error=errStack[i];severity=(error.severity&&severityLevel[error.severity])||severityLevel.INFO;log.debug("PlayerController","_onAdError",error.severity,error.name);if(severity>severityLevel.WARN){this.eAdError.dispatch.call(this.eAdError,error.name);}}this._onAdComplete(adType);},_onAdComplete:function(adType){this._triggeredAd=false;if(adType===AdServerProxy.PREROLL){this._playContent();}else{this._onContentComplete(this._currentContentId);}}});var PlayerInstance=function(pdata){var data=pdata||{},configData=data.configData||{};_params=data.params||_params;_mapping=configData.mapping||_mapping;_appConfig=configData.appConfig||_appConfig;
_containerInfo=configData.containerInfo||_containerInfo;_configInfo=configData.configInfo||_configInfo;_adPolicy=configData.adPolicy||_adPolicy;return new PlayerController();};return PlayerInstance;})();var CVPManager=Class.extend({init:function(){this._configData={};this.ePlayerLoaded=new Event();this.ePlayerLoadError=new Event();this.ePlayerRendered=new Event();this.eContentMetadata=new Event();this.eContentBegin=new Event();this.eContentPlay=new Event();this.eContentPause=new Event();this.eContentEnd=new Event();this.eContentComplete=new Event();this.eContentPlayhead=new Event();this.eContentBuffering=new Event();this.eContentVolume=new Event();this.eContentError=new Event();this.eContentResize=new Event();this.eAdPlayhead=new Event();this.eAdPlay=new Event();this.eAdEnd=new Event();this.eAdError=new Event();this.eTrackingAdStart=new Event();this.eTrackingAdComplete=new Event();this.eTrackingAdProgress=new Event();this.eTrackingAdCountdown=new Event();this.eTrackingContentPlay=new Event();this.eTrackingContentBegin=new Event();this.eTrackingContentProgress=new Event();this.eTrackingContentComplete=new Event();this.eTrackingContentSeek=new Event();this.eTrackingContentSeekEnd=new Event();this.eTrackingFullscreen=new Event();this.eTrackingMuted=new Event();this.eTrackingPaused=new Event();this._loadingEntryQueue={};this._params={};},load:function(options){this._params=this._options=options;this._params.site=this._params.flashVars&&this._params.flashVars.site;this._params.profile=this._params.flashVars&&this._params.flashVars.profile;this._params.context=this._params.flashVars&&this._params.flashVars.context;this._params.contentId=this._params.flashVars&&this._params.flashVars.contentId;this._params.autostart=this._params.flashVars&&isFlagActive(this._params.flashVars.autostart,false);this._params.containerUrl=this._params.flashVars&&this._params.flashVars.containerUrl;this._params.configUrl=this._params.flashVars&&this._params.flashVars.configUrl;this._params.aspenContext=this._params.flashVars&&this._params.flashVars.aspenContext;this._params.dt=this._params.flashVars&&this._params.flashVars.superduperdevtime;this._params.requestTimeout=this._params.flashVars&&+this._params.flashVars.requestTimeout;if(this._params.requestTimeout){Ajax.JSONP.requestTimeout=this._params.requestTimeout;}this._params.requestRetries=this._params.flashVars&&+this._params.flashVars.requestRetries;if(this._params.requestRetries){Ajax.JSONP.maxRetries=this._params.requestRetries;}var mappingUrl=this._calculateMappingUrl(this._params.site);if(empty(mappingUrl)){log.error("Unable to calculate mapping file url. Failing.");this._bootStrapFailure();return;}this._bootStrapper=new BootStrapper(mappingUrl,this._params);this._bootStrapper.eSuccess.addListener(this._bootStrapSuccess,this);this._bootStrapper.eFailure.addListener(this._bootStrapFailure,this);this._bootStrapper.load();AspenController.init({dt:this._params.dt,context:this._params.aspenContext||this._params.context,site:this._params.site});},_calculateMappingUrl:function(site){if(empty(site)){return null;}var url=Utils.replaceExtension(MAPPING_FILE,"xml","json");if(!this._params.dt){url=template(MAPPING_PATH,site)+url;}return url;},_bootStrapSuccess:function(event){if(!event||!event.data){log.error("MainController","Unable to retrieve config data - failing.");this._bootStrapFailure();return;}this._configData=event.data;log.debug("MainController","_bootStrapSuccess");this._playerController=new PlayerInstance({params:this._params,configData:this._configData});this._playerController.eRendered.addListener(this._onRendered,this);this._playerController.eContentMetadata.addListener(this._onContentMetadata,this);this._playerController.eContentBegin.addListener(this._onContentBegin,this);this._playerController.eContentPlay.addListener(this._onContentPlay,this);this._playerController.eContentPause.addListener(this._onContentPause,this);this._playerController.eContentEnd.addListener(this._onContentEnd,this);this._playerController.eContentComplete.addListener(this._onContentComplete,this);this._playerController.eContentPlayhead.addListener(this._onContentPlayhead,this);this._playerController.eContentBuffering.addListener(this._onContentBuffering,this);this._playerController.eContentVolume.addListener(this._onContentVolume,this);this._playerController.eContentError.addListener(this._onContentError,this);this._playerController.eContentResize.addListener(this._onContentResize,this);this._playerController.eAdPlayhead.addListener(this._onAdPlayhead,this);this._playerController.eAdPlay.addListener(this._onAdPlay,this);this._playerController.eAdEnd.addListener(this._onAdEnd,this);this._playerController.eAdError.addListener(this._onAdError,this);this._playerController.eTrackingAdStart.addListener(this._onTrackingAdStart,this);this._playerController.eTrackingAdComplete.addListener(this._onTrackingAdComplete,this);this._playerController.eTrackingAdProgress.addListener(this._onTrackingAdProgress,this);this._playerController.eTrackingAdCountdown.addListener(this._onTrackingAdCountdown,this);this._playerController.eTrackingContentPlay.addListener(this._onTrackingContentPlay,this);this._playerController.eTrackingContentBegin.addListener(this._onTrackingContentBegin,this);this._playerController.eTrackingContentProgress.addListener(this._onTrackingContentProgress,this);this._playerController.eTrackingContentEnd.addListener(this._onTrackingContentEnd,this);this._playerController.eTrackingContentComplete.addListener(this._onTrackingContentComplete,this);this._playerController.eTrackingContentSeek.addListener(this._onTrackingContentSeek,this);this._playerController.eTrackingContentSeekEnd.addListener(this._onTrackingContentSeekEnd,this);this._playerController.eTrackingFullscreen.addListener(this._onTrackingFullscreen,this);this._playerController.eTrackingMuted.addListener(this._onTrackingMuted,this);this._playerController.eTrackingPaused.addListener(this._onTrackingPaused,this);this._cms=new CMS();this._cms.setDataUrl(this._configData.configInfo.dataSrc);this._cms.setMediaUrl(this._configData.configInfo.mediaSrc);this._cms.eRequestCompleted.addListener(this._onCmsRequestCompleted,this);(function(configData){var ad=configData&&configData.adPolicy&&configData.adPolicy.ads||{};var config=configData.configInfo||{};var container=configData.containerInfo||{};var elementData={"cvpElementId":container.elementName,"adApi":ad.apiUrl,"adServerRootUrl":ad.adServerRootUrl,"adNetworkId":ad.adNetworkId,"adVideoNetworkId":ad.adVideoNetworkId,"adVideoAssetId":ad.adVideoAssetId,"adSection":ad.adSection,"adPlayerProfile":ad.adPlayerProfile,"renderersUrl":ad.renderersUrl,"sensitiveFallbackId":ad.sensitiveFallbackId,"adLiveContentDuration":ad.liveDuration,"mediaSrc":config.mediaSrc,"dataSrc":config.dataSrc,"adPolicyUrl":container.adPolicySrc};AspenController.send("appConfig",{"playerConfigUrl":configData.appConfig&&configData.appConfig.configUrl,"osName":Browser.os.name,"osVersion":Browser.os.version&&String(Browser.os.version),"deviceName":Browser.name,"deviceVersion":Browser.version&&String(Browser.version),"propertyName":this._params.site,"containerName":document.URL});AspenController.send("elementConfig",elementData);}).call(this,this._configData);this.ePlayerLoaded.dispatch();},_bootStrapFailure:function(){log.debug("MainController","_bootStrapFailure");this.ePlayerLoadError.dispatch();},render:function(containerElement){this._playerController.render(containerElement);},remove:function(){this._playerController.remove();},_onRendered:function(){if(!nil(this._params.contentId)){this.playContentWithId(this._params.contentId);}this.ePlayerRendered.dispatch();},playContentWithId:function(id,options){log.debug("MainController","playContentWithId",id);var index=this._getNextIndexForId(id);var key=id+"|"+index;log.debug("MainController","playContentWithId","key",key);this._loadingEntryQueue[key]={play:true,additionalParams:options};this.reset();this._cms.addContentId(key,options);
},queueContentWithId:function(id,options){log.debug("MainController","queueContentWithId",id);var index=this._getNextIndexForId(id);var key=id+"|"+index;log.debug("MainController","queueContentWithId","key",key);this._loadingEntryQueue[key]={play:false,additionalParams:options};this._cms.addContentId(key,options);},reset:function(){this._playerController.reset();},pause:function(){this._playerController.pause();},resume:function(){this._playerController.resume();},seek:function(seconds){this._playerController.seek(seconds);},resize:function(width,height){this._playerController.resize(width,height);},goFullscreen:function(){this._playerController.goFullscreen();},setVolume:function(v){this._playerController.setVolume(v);},getVolume:function(){return this._playerController.getVolume();},mute:function(){this._playerController.mute();},unmute:function(){this._playerController.unmute();},getContentEntry:function(id){var catalogEntry=this._cms.getContentId(id);return Utils.JsonConverter.encodeXmlObject(catalogEntry.getXML());},setAdSection:function(ssid){this._playerController.setAdSection(ssid);},setAdKeyValue:function(key,value){this._playerController.setAdKeyValue(key,value);},getCurrentPlayer:function(){return this._configData.containerInfo.elementName;},_onContentMetadata:function(contentId,duration,width,height){AspenController.send("videoConfig",{cvpElementId:this.getCurrentPlayer(),videoXmlJson:this.getContentEntry(contentId)});this.eContentMetadata.dispatch.apply(this.eContentMetadata,arguments);},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,arguments);},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,arguments);},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,arguments);},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,arguments);},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,arguments);},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,arguments);},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,arguments);},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,arguments);},_onContentError:function(contentId,errorMessage){this.eContentError.dispatch.apply(this.eContentError,arguments);},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,arguments);},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,arguments);},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,arguments);},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,arguments);},_onAdError:function(errorMessage){this.eAdError.dispatch.apply(this.eAdError,arguments);},_onTrackingAdStart:function(data){AspenController.send("adStart",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,adType:data.adType,adBlockId:undefined,adSection:data.adSection,adAssetId:data.adTitle,width:String(data.adWidth),height:String(data.adHeight),duration:String(data.adDuration),slotId:undefined,adInstances:undefined});this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,arguments);},_onTrackingAdComplete:function(data){AspenController.send("adStop",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,adType:data.adType,adBlockId:undefined,adAssetId:data.adTitle,slotId:undefined});this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,arguments);},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,arguments);},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,arguments);},_onTrackingContentPlay:function(data){AspenController.send("contentPlay",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,originId:data.originId,contentType:data.contentType,duration:String(data.length),joinTime:Aspen.convertTimeToSecString(data.totalPlayTime),mediaPath:data.mediaUrl,bandwidth:undefined,serverIp:undefined,ccAvailable:undefined,dvrAvailable:undefined});this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,arguments);},_onTrackingContentBegin:function(data){AspenController.send("contentStart",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,originId:data.originId,playOptions:undefined,mode:data.contentMode,propertyName:data.contentSource});this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,arguments);},_onTrackingContentProgress:function(data){AspenController.send("contentProgress",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,originId:data.originId,timeSpentBuffering:undefined,timeSpentPlaying:Aspen.convertTimeToSecString(data.totalPlayTime),playHead:Aspen.convertTimeToSecString(data.playheadTime),playerWidth:String(data.playerWidth),playerHeight:String(data.playerHeight),ccAvailable:undefined,ccEnabled:undefined,ccTrackLang:undefined,dvrAvailable:undefined,dvrEnabled:undefined,dvrWindow:undefined,dvrStart:undefined});this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,arguments);},_onTrackingContentEnd:function(data){AspenController.send("contentStop",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId});},_onTrackingContentComplete:function(data){AspenController.send("contentFinish",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId});this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,arguments);},_onTrackingContentSeek:function(data){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,arguments);},_onTrackingContentSeekEnd:function(data){AspenController.send("contentSeek",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,videoContentCount:undefined,seekFrom:Aspen.convertTimeToSecString(data.previousPlayhead),seekTo:Aspen.convertTimeToSecString(data.newPlayhead),dvrAvailable:undefined,dvrEnabled:undefined});this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,arguments);},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,arguments);},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,arguments);},_onTrackingPaused:function(data){AspenController.send("contentPause",{cvpElementId:this.getCurrentPlayer(),contentId:data.contentId,videoContentCount:undefined,contentPlayHead:Aspen.convertTimeToSecString(data.playhead),isPaused:String(data.paused)});this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,arguments);},_onCmsRequestCompleted:function(contentId,requestId,index,errorMsg){log.debug("_onCmsRequestCompleted",contentId,requestId,index,errorMsg);var key=requestId+"|"+index;var catalogEntry=this._cms.getContentId((contentId+"|"+index));if(empty(catalogEntry)){log.error("onCmsRequestCompleted","no catalogEntry for contentId '"+contentId+"'");return;}if(empty(this._loadingEntryQueue[key])){log.warn("onCmsRequestCompleted","no entry for key '"+key+"' found in loading queue");return;}log.debug("onCmsRequestCompleted",contentId,this._loadingEntryQueue[key].play);if(this._loadingEntryQueue[key].play){this._playerController.emptyQueue();this._playerController.play(catalogEntry,this._loadingEntryQueue[key].additionalParams);}else{this._playerController.queue(catalogEntry,this._loadingEntryQueue[key].additionalParams);}delete this._loadingEntryQueue[key];},_getNextIndexForId:function(contentId){var index=0,p,q,id,n;for(p in this._loadingEntryQueue){q=p.split("|");if(q&&q.length>1){id=q[0];n=+(q[1]);if(id===contentId&&!isNaN(n)&&n>=index){index=n+1;}}}return index;}});CVP.Players._HTML5Player=Class.extend({init:function(options){this._manager=new CVPManager();this._manager.ePlayerLoaded.addListener(this._onPlayerLoaded,this);this._manager.ePlayerLoadError.addListener(this._onPlayerLoadError,this);this._manager.ePlayerRendered.addListener(this._onPlayerRendered,this);this._manager.eContentMetadata.addListener(this._onContentMetadata,this);
this._manager.eContentBegin.addListener(this._onContentBegin,this);this._manager.eContentPlay.addListener(this._onContentPlay,this);this._manager.eContentPause.addListener(this._onContentPause,this);this._manager.eContentEnd.addListener(this._onContentEnd,this);this._manager.eContentComplete.addListener(this._onContentComplete,this);this._manager.eContentPlayhead.addListener(this._onContentPlayhead,this);this._manager.eContentBuffering.addListener(this._onContentBuffering,this);this._manager.eContentVolume.addListener(this._onContentVolume,this);this._manager.eContentError.addListener(this._onContentError,this);this._manager.eContentResize.addListener(this._onContentResize,this);this._manager.eAdPlayhead.addListener(this._onAdPlayhead,this);this._manager.eAdPlay.addListener(this._onAdPlay,this);this._manager.eAdEnd.addListener(this._onAdEnd,this);this._manager.eAdError.addListener(this._onAdError,this);this._manager.eTrackingAdStart.addListener(this._onTrackingAdStart,this);this._manager.eTrackingAdComplete.addListener(this._onTrackingAdComplete,this);this._manager.eTrackingAdProgress.addListener(this._onTrackingAdProgress,this);this._manager.eTrackingAdCountdown.addListener(this._onTrackingAdCountdown,this);this._manager.eTrackingContentPlay.addListener(this._onTrackingContentPlay,this);this._manager.eTrackingContentBegin.addListener(this._onTrackingContentBegin,this);this._manager.eTrackingContentProgress.addListener(this._onTrackingContentProgress,this);this._manager.eTrackingContentComplete.addListener(this._onTrackingContentComplete,this);this._manager.eTrackingContentSeek.addListener(this._onTrackingContentSeek,this);this._manager.eTrackingContentSeekEnd.addListener(this._onTrackingContentSeekEnd,this);this._manager.eTrackingFullscreen.addListener(this._onTrackingFullscreen,this);this._manager.eTrackingMuted.addListener(this._onTrackingMuted,this);this._manager.eTrackingPaused.addListener(this._onTrackingPaused,this);this.ePlayerLoaded=new Event();this.ePlayerLoadError=new Event();this.ePlayerReady=new Event();this.eContentMetadata=new Event();this.eContentBegin=new Event();this.eContentPlay=new Event();this.eContentPause=new Event();this.eContentEnd=new Event();this.eContentComplete=new Event();this.eContentPlayhead=new Event();this.eContentBuffering=new Event();this.eContentVolume=new Event();this.eContentError=new Event();this.eContentResize=new Event();this.eAdPlayhead=new Event();this.eAdPlay=new Event();this.eAdEnd=new Event();this.eAdError=new Event();this.eTrackingAdStart=new Event();this.eTrackingAdComplete=new Event();this.eTrackingAdProgress=new Event();this.eTrackingAdCountdown=new Event();this.eTrackingContentPlay=new Event();this.eTrackingContentBegin=new Event();this.eTrackingContentProgress=new Event();this.eTrackingContentComplete=new Event();this.eTrackingContentSeek=new Event();this.eTrackingContentSeekEnd=new Event();this.eTrackingFullscreen=new Event();this.eTrackingMuted=new Event();this.eTrackingPaused=new Event();this._manager.load(options);},render:function(containerElement){this._manager.render(containerElement);},reset:function(){this._manager.reset();},remove:function(){this._manager.remove();},getDefaultPlayer:function(){return this._manager.getCurrentPlayer();},play:function(id,options){this._manager.playContentWithId(id,options);},queue:function(id,options){this._manager.queueContentWithId(id,options);},pause:function(){this._manager.pause();},resume:function(){this._manager.resume();},seek:function(seconds){this._manager.seek(seconds);},resize:function(width,height){this._manager.resize(width,height);},goFullscreen:function(){this._manager.goFullscreen();},setVolume:function(v){this._manager.setVolume(v);},getVolume:function(){return this._manager.getVolume();},mute:function(){this._manager.mute();},unmute:function(){this._manager.unmute();},getContentEntry:function(id){return this._manager.getContentEntry(id);},setAdSection:function(ssid){this._manager.setAdSection(ssid);},setAdKeyValue:function(key,value){this._manager.setAdKeyValue(key,value);},_mungeArgs:function(argv){var args=slice(argv);args.unshift(this.getDefaultPlayer());return args;},_onPlayerLoaded:function(){this.ePlayerLoaded.dispatch();},_onPlayerLoadError:function(){this.ePlayerLoadError.dispatch();},_onPlayerRendered:function(){this.ePlayerReady.dispatch.apply(this.ePlayerReady,this._mungeArgs(arguments));},_onContentMetadata:function(){this.eContentMetadata.dispatch.apply(this.eContentMetadata,this._mungeArgs(arguments));},_onContentBegin:function(){this.eContentBegin.dispatch.apply(this.eContentBegin,this._mungeArgs(arguments));},_onContentPlay:function(){this.eContentPlay.dispatch.apply(this.eContentPlay,this._mungeArgs(arguments));},_onContentPause:function(){this.eContentPause.dispatch.apply(this.eContentPause,this._mungeArgs(arguments));},_onContentEnd:function(){this.eContentEnd.dispatch.apply(this.eContentEnd,this._mungeArgs(arguments));},_onContentComplete:function(){this.eContentComplete.dispatch.apply(this.eContentComplete,this._mungeArgs(arguments));},_onContentPlayhead:function(){this.eContentPlayhead.dispatch.apply(this.eContentPlayhead,this._mungeArgs(arguments));},_onContentBuffering:function(){this.eContentBuffering.dispatch.apply(this.eContentBuffering,this._mungeArgs(arguments));},_onContentVolume:function(){this.eContentVolume.dispatch.apply(this.eContentVolume,this._mungeArgs(arguments));},_onContentError:function(){this.eContentError.dispatch.apply(this.eContentError,this._mungeArgs(arguments));},_onContentResize:function(){this.eContentResize.dispatch.apply(this.eContentResize,this._mungeArgs(arguments));},_onAdPlayhead:function(){this.eAdPlayhead.dispatch.apply(this.eAdPlayhead,this._mungeArgs(arguments));},_onAdPlay:function(){this.eAdPlay.dispatch.apply(this.eAdPlay,this._mungeArgs(arguments));},_onAdEnd:function(){this.eAdEnd.dispatch.apply(this.eAdEnd,this._mungeArgs(arguments));},_onAdError:function(){this.eAdError.dispatch.apply(this.eAdError,this._mungeArgs(arguments));},_onTrackingAdStart:function(){this.eTrackingAdStart.dispatch.apply(this.eTrackingAdStart,this._mungeArgs(arguments));},_onTrackingAdComplete:function(){this.eTrackingAdComplete.dispatch.apply(this.eTrackingAdComplete,this._mungeArgs(arguments));},_onTrackingAdProgress:function(){this.eTrackingAdProgress.dispatch.apply(this.eTrackingAdProgress,this._mungeArgs(arguments));},_onTrackingAdCountdown:function(){this.eTrackingAdCountdown.dispatch.apply(this.eTrackingAdCountdown,this._mungeArgs(arguments));},_onTrackingContentPlay:function(){this.eTrackingContentPlay.dispatch.apply(this.eTrackingContentPlay,this._mungeArgs(arguments));},_onTrackingContentBegin:function(){this.eTrackingContentBegin.dispatch.apply(this.eTrackingContentBegin,this._mungeArgs(arguments));},_onTrackingContentProgress:function(){this.eTrackingContentProgress.dispatch.apply(this.eTrackingContentProgress,this._mungeArgs(arguments));},_onTrackingContentComplete:function(){this.eTrackingContentComplete.dispatch.apply(this.eTrackingContentComplete,this._mungeArgs(arguments));},_onTrackingContentSeek:function(){this.eTrackingContentSeek.dispatch.apply(this.eTrackingContentSeek,this._mungeArgs(arguments));},_onTrackingContentSeekEnd:function(){this.eTrackingContentSeekEnd.dispatch.apply(this.eTrackingContentSeekEnd,this._mungeArgs(arguments));},_onTrackingFullscreen:function(){this.eTrackingFullscreen.dispatch.apply(this.eTrackingFullscreen,this._mungeArgs(arguments));},_onTrackingMuted:function(){this.eTrackingMuted.dispatch.apply(this.eTrackingMuted,this._mungeArgs(arguments));},_onTrackingPaused:function(){this.eTrackingPaused.dispatch.apply(this.eTrackingPaused,this._mungeArgs(arguments));}});}());addBeforeUnLoadEvent(CVP.cleanup);window.CVP=CVP.Utils.extend(CVPconstructor,window.CVP,CVP);}(window,document));var CNNVIDEO=function(r,E){var ac="0.4",h=window.jQuery,w=h.trim(r),g=h(w.substring(0,1)!=="#"?"#"+r:r),P=false,X=false,G=g.attr("id"),e=G+"-videowrapper",u,K,s,y,C,n,k,m,ad,ab,F,W,V,H,a,p,f,c,J,T,R,M,b,o,Y,Q,D,z,q,B,A,ae,S,l,t,N,U,v,Z,L=String.prototype.split.call("onContentMetadata onPlayerReady onContentBegin onContentPlay onContentPause onContentEnd onContentComplete onContentBuffering onTrackingContentSeek onContentVolume onContentError onAdPlay onAdEnd"," "),d,aa,I={},O=h.extend({},{video:"/tech/2012/01/11/ces-2012-3d-tvs.cnn",embedMetaDiv:true,network:"cnn",profile:"desktop",context:"main",section:"",thumb:"http://i2.cdn.turner.com/cnn/dam/assets/120307022252-romney-gingrich-santorum-split-story-top.jpg",autostart:false,width:"640",height:"360",preset:"custom",bypassTracking:false,diagnostics:{section:"default"}},E);
O.diagnostics.version=ac;O.diagnostics.adsection=E.adsection||"default";O.fullscreenbitrate=1300;if(O.isLive){y="http://i.cdn.turner.com/cnn/.e/img/3.0/video/416_player_Click_to_watch_off.png";C="http://i.cdn.turner.com/cnn/.e/img/3.0/video/416_player_click_to_watch_on.png";n=145;}else{y="http://i.cdn.turner.com/cnn/.e/img/3.0/video/416_player_Click_to_play_off.png";C="http://i.cdn.turner.com/cnn/.e/img/3.0/video/416_player_click_to_play_on.png";n=136;}u=E.adsection||false;K=".cnnvideo_wrapper{ position: relative; }.cnnvideo_playcontainer{ position: absolute; top:0px; left: 0px; cursor: pointer; background: url("+y+") no-repeat; }.cnnvideo_click_standard { width:"+n+"px; height:42px;}.cnnvideo_playcontainer:hover{ background: url("+C+") no-repeat; }#adCountdown {background: black; color: white; font-size: 10px; height: 18px; padding: 1px 5px; position: absolute; bottom: 0; width: 406px; } #source{ color: #666666; } .vidSource{ color: #999999; } .vidSource a{ color: #6AB9D3; }.vidSource a:hover{ color: #CA0002; }";if(O.preset&&O.preset!=="custom"){switch(O.preset){case"right-rail-preview":O.embedMetaDiv=false;O.width="300";O.height="169";O.autostart=true;O.bypassTracking=true;O.context="tve_prev";break;case"homepage":O.width="416";O.height="234";O.profile="desktop";O.context="sectionfront";break;case"sectionfront":O.width="416";O.height="230";O.profile="desktop";O.context="sectionfront";break;case"debates":O.width="768";O.height="432";O.profile="desktop";O.context="2012debates";break;case"storypage":O.width="640";O.height="360";O.profile="desktop";O.context="main";break;case"blog":O.width="512";O.height="288";break;case"large":O.width="768";O.height="432";break;case"xlarge":O.width="960";O.height="540";break;case"leanback":O.width="1280";O.height="720";break;case"stunt_player":O.context="stunt_player";break;case"t1_tvcnn":case"t1_tvhln":case"t1_tvcnni":O.autostart=false;O.context=O.preset;O.preset="custom";break;default:}}d=function(){var af=/\b(Kindle|Fire|Silk)\b/ig.exec(window.navigator.userAgent);if(af){return"kindle";}af=/\b(Android)\b/ig.exec(window.navigator.userAgent);if(af){return"android";}return null;};V=function(){var af=h('<div class="cnnvideo_wrapper" id="'+e+'"></div>');g.html(af);return af;};H=function(ag,af){X.play(ag,af||{});};a=function(){if(X){X.pause();}};A=function(){var af=X.getDuration();if(!X){af=0;}return af;};ae=function(){var af=X.getPlayhead();if(!X){af=0;}return af;};Z=function(){var af;if(X){af=X.getAbsolutePlayhead();}else{af=-1;}return af;};p=function(){if(X){X.resume();}};z=function(ag,af,ah){if(X){X.resize(ag,af,ah);}};B=function(af){if(X){X.seek(af);}};q=function(af){if(!S){S=X.getContentEntry(af);}return S;};l=function(ah){var ag=q(ah),af;if(ag){af=h.parseJSON(ag);if(af&&af.broadcastStartTime){return af.broadcastStartTime;}}return 0;};t=function(){return O.video;};f=function(af){X.setAdSection(af);};c=function(af){return(af.indexOf("cvptve/")!==-1);};J=function(af){return(af.indexOf("cvplive/")!==-1);};T=function(ah){var ag=O.diagnostics||{},af=ah||X.getContentId();ag.deliveryType="O";if(c(af)){ag.deliveryType="T";}else{if(J(af)){ag.deliveryType="L";}}return ag;};R=function(){if(u!==undefined){f(u);}H(O.video,{convivaMetadata:T()});};M=function(af){if(X){return;}var ai,ag=L.length,ak,aj=d(),al=aj?"html5":"flash";X=new window.CVP({id:"cvp_"+G,width:O.width,height:O.height,playerType:al,perVideoFallbacks:[{evaluate:function(){return al==="html5"&&O.isLive;},filter:O.videoStreamUrl}],flashVars:{context:O.context,site:O.network,profile:O.profile},embed:{containerSwf:"http://z.cdn.turner.com/xslo/cvp/assets/container/2.0.4.0/cvp_main_container.swf",options:{quality:"high",bgcolor:"#000000",allowFullScreen:"true",allowScriptAccess:"always",wMode:"transparent"}},onCVPReady:function(){R();},onPlayerReady:function(am){g.triggerHandler("onPlayerReady",{type:"onPlayerReady",playerId:am});},onContentBegin:function(am,an){g.triggerHandler("onContentBegin",{type:"onContentBegin",playerId:am,contentId:an});},onContentPlay:function(am,an){g.triggerHandler("onContentPlay",{type:"onContentPlay",playerId:am,contentId:an});},onContentComplete:function(am,an){g.triggerHandler("onContentComplete",{type:"onContentComplete",playerId:am,contentId:an});},onContentEnd:function(am,an){g.triggerHandler("onContentEnd",{type:"onContentEnd",playerId:am,contentId:an});},onContentPlayhead:function(am,ap,an,ao){g.triggerHandler("onContentPlayhead",{type:"onContentPlayhead",playerId:am,contentId:ap,playhead:an,duration:ao});},onAdPlay:function(ao,ap,ar,at,aq,an,am){g.triggerHandler("adPlay",{type:"adPlay",playerId:ao,token:ap,mode:ar,id:at,duration:aq,segmentId:an,adType:am});},onAdEnd:function(ao,ap,ar,at,aq,an,am){g.triggerHandler("onAdEnd",{type:"onAdEnd",playerId:ao,token:ap,mode:ar,id:at,duration:aq,segmentId:an,adType:am});},onContentBuffering:function(am,ao,an){g.triggerHandler("onContentBuffering",{type:"onContentBuffering",playerId:am,contentId:ao,buffering:an});},onTrackingContentSeek:function(an,am){g.triggerHandler("onTrackingContentSeek",{type:"onTrackingContentSeek",playerId:an,dataObj:am});},onContentPause:function(am,ao,an){g.triggerHandler("onContentPause",{type:"onContentPause",playerId:am,contentId:ao,paused:an});},onTrackingFullscreen:function(an,am){g.triggerHandler("onTrackingFullscreen",{type:"onTrackingFullscreen",playerId:an,dataObj:am});},onTrackingAdCountdown:function(am,an){h(g.parent()).find("#adCountdown").each(function(ao,ap){this.innerHTML="Your video will play in  "+an.secs+" secs";});}});function ah(){return g.triggerHandler("event",arguments);}for(ai=0;ai<ag;ai+=1){ak=L[ai];if(!(X.hasOwnProperty(ak))){X[ak]=ah();}}if(typeof af==="function"){af();}};b=function(){if(h('style[title="cnnvideo"]').length>0){return;}var ag=document.getElementsByTagName("head")[0],ah=document.createElement("style"),af;ah.type="text/css";ah.title="cnnvideo";if(ah.styleSheet){ah.styleSheet.cssText=K;}else{af=document.createTextNode(K);ah.appendChild(af);}ag.appendChild(ah);};o=function(){var ag=Math.ceil(O.width/2)-100,af=Math.ceil(O.height/2)-30;return'<a class="cnnvideo_clicklink" href="#" title="Click to watch this video"><div class="cnnvideo_playcontainer cnnvideo_click_standard" style="top:'+af+"px;left:"+ag+'px;"></div></a>';};Y=function(){return['<img src="',O.thumb,'" width="',O.width,'" height="',O.height,'" alt="',O.alt||"Watch this video",'" />'].join("");};N=function(){if(O.headline){var af;if(O.headlineUrl){af="<a href="+O.headlineUrl+">"+O.headline+"</a>";}else{af=O.headline;}return'<div class="cnn_mtt1imgh videoHeadline"><div class="cnn_mtt1imghtitle"><h1><span>'+af+"</span></h1></div></div>";}};U=function(){if(w!==undefined&&w!==null){h("#"+w).append('<div id="adCountdown" style="display: none;"></div>');}};v=function(){if(O.source){var af;if(O.sourceUrl){af="<a href="+O.sourceUrl+' target="_blank">'+O.source+"</a>";}else{af=O.source;}return'<div id="source">Source: <span class="vidSource">'+af+"</span></div>";}};Q=function(){if(g&&(O!==undefined&&O!==null&&O.embedMetaDiv)){g.parent().append('<div id="adCountdown"></div>');}g.find(".videoHeadline").remove();P.empty();X.embed(e);};D=function(){M(function(){Q();});};g.on("onPlayerReady",function(ah,ag){try{X.setAdKeyValue("transactionID",cnnad_transactionID);X.setAdKeyValue("guID",cnnad_readCookie("ug"));}catch(af){}});g.on("onContentBegin",function(ag,af){I.META=new window._jsmd.plugin.gCNNVideoCollection();I.CONTENT=h.parseJSON(X.getContentEntry(af.contentId));});g.on("onContentPlay",function(ah,ag){var af="video-start";if(J(ag.contentId)){if(O.context==="debates_homepage"||O.context==="homepage_large"||O.context==="stunt_player"){window.live_interval="60";}af="video-live";}h(document).find("#adCountdown").each(function(ai,aj){this.innerHTML=v();});if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,af,ag.playerId);}});g.on("onContentEnd",function(ag,af){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-complete",af.playerId);
}});g.on("onContentPlayhead",function(aj,ai){var ag=ai.playhead,ah=ai.duration,ak=ai.contentId,af=ai.playerId;if(I.META!==undefined&&ag!==undefined&&!I.META.get(ak,"hasScrubbed")){if(ag>(ah*0.75)&&!I.META.get(ak,"isSeventyFive")){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-seventyfive",af);}}else{if(ag>(ah*0.5)&&!I.META.get(ak,"isHalf")){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-fifty",af);}}else{if(ag>(ah*0.25)&&!I.META.get(ak,"isTwentyFive")){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-twentyfive",af);}}else{if(ag>(ah*0.1)&&!I.META.get(ak,"isTen")){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-ten",af);}}}}}}});g.on("adPlay",function(ah,ag){var af=ag.playerId;I.CONTENT.ad_duration=ag.duration;if(J(I.CONTENT.id)){I.CONTENT.player_type="live player";}if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-preroll",af);}});g.on("onAdEnd",function(ag,af){document.getElementById("adCountdown").innerHTML=v();if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-midroll-complete",af.playerId);}});g.on("onContentBuffering",function(ag,af){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-buffer",af.playerId);}});g.on("onTrackingContentSeek",function(ag,af){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-scrub",af.playerId);}});g.on("onContentPause",function(ag,af){if(!(O.bypassTracking!==undefined&&O.bypassTracking!==null&&O.bypassTracking==true)){window.sendVideo2Event(I.CONTENT,"video-pause",af.playerId);}});g.on("onTrackingFullscreen",function(ag,af){if(af.dataObj.fullscreen){X.setMaxBitrate(O.fullscreenbitrate);}});b();P=V();if(O.autostart){D();}if(!O.autostart){P.html(Y()+o());if(O.headline){g.append(N());}P.find(".cnnvideo_playcontainer").on("click",function(af){D();af.preventDefault();});}return{getVersion:function(){return ac;},resume:function(){p();},pause:function(){a();},resize:function(ag,af,ah){z(ag,af,ah);},seek:function(af){B(af);},getContentEntry:function(af){return q(af);},getContentPlayhead:function(){return Z();},getDuration:function(){return A();},getPlayHead:function(){return ae();},getStartTime:function(af){return l(af);},getVideoId:function(){return t();}};};window.CNNVIDEO_UTILS=window.CNNVIDEO_UTILS||{Android:function(){return navigator.userAgent.match(/Android/i);},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i);},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i);},Opera:function(){return navigator.userAgent.match(/Opera Mini/i);},Windows:function(){return navigator.userAgent.match(/IEMobile/i);},isMobileClient:function(){return(this.Android()||this.BlackBerry()||this.iOS()||this.Opera()||this.Windows())?true:false;}};window.CNNVIDEO_UTILS.isFlashInstalled=function(){var a=false;if("ActiveXObject" in window){try{a=!!(new ActiveXObject("ShockwaveFlash.ShockwaveFlash"));}catch(b){a=false;}}else{a=!!navigator.mimeTypes["application/x-shockwave-flash"];}return a;};function callCnnVideo(a){window.CNNVIDEOS=window.CNNVIDEOS||{};if(typeof a.preset==="undefined"){a.preset="homepage";}window.CNNVIDEOS[a.key]=window.CNNVIDEO(a.markupid,{video:a.video,thumb:a.thumb,preset:a.preset,diagnostics:{section:"homepage",placement:a.placement},network:"cnn",adsection:a.adsection,headline:a.headline,headlineUrl:a.url,source:a.source,sourceUrl:a.sourceUrl,isLive:a.isLive,videoStreamUrl:a.videoStreamUrl});}
/*!
 * jQuery Tools v1.2.7 - The missing UI library for the Web
 * 
 * overlay/overlay.js
 * 
 * NO COPYRIGHTS OR LICENSES. DO WHAT YOU LIKE.
 * 
 * http://flowplayer.org/tools/
 * 
 */
(function(f){f.tools=f.tools||{version:"v1.2.7"},f.tools.overlay={addEffect:function(k,c,l){h[k]=[c,l];},conf:{close:null,closeOnClick:!0,closeOnEsc:!0,closeSpeed:"fast",effect:"default",fixed:!f.browser.msie||f.browser.version>6,left:"center",load:!1,mask:null,oneInstance:!0,speed:"normal",target:null,top:"10%"}};var e=[],h={};f.tools.overlay.addEffect("default",function(a,m){var l=this.getConf(),k=f(window);l.fixed||(a.top+=k.scrollTop(),a.left+=k.scrollLeft()),a.position=l.fixed?"fixed":"absolute",this.getOverlay().css(a).fadeIn(l.speed,m);},function(b){this.getOverlay().fadeOut(this.getConf().closeSpeed,b);});function g(v,u){var t=this,s=v.add(t),r=f(window),q,p,o,c=f.tools.expose&&(u.mask||u.expose),b=Math.random().toString().slice(10);c&&(typeof c=="string"&&(c={color:c}),c.closeOnClick=c.closeOnEsc=!1);var a=u.target||v.attr("rel");p=a?f(a):null||v;if(!p.length){throw"Could not find Overlay: "+a;}v&&v.index(p)==-1&&v.click(function(d){t.load(d);return d.preventDefault();}),f.extend(t,{load:function(y){if(t.isOpened()){return t;}var k=h[u.effect];if(!k){throw'Overlay: cannot find effect : "'+u.effect+'"';}u.oneInstance&&f.each(e,function(){this.close(y);}),y=y||f.Event(),y.type="onBeforeLoad",s.trigger(y);if(y.isDefaultPrevented()){return t;}o=!0,c&&f(p).expose(c);var z=u.top,w=u.left,m=p.outerWidth({margin:!0}),l=p.outerHeight({margin:!0});typeof z=="string"&&(z=z=="center"?Math.max((r.height()-l)/2,0):parseInt(z,10)/100*r.height()),w=="center"&&(w=Math.max((r.width()-m)/2,0)),k[0].call(t,{top:z,left:w},function(){o&&(y.type="onLoad",s.trigger(y));}),c&&u.closeOnClick&&f.mask.getMask().one("click",t.close),u.closeOnClick&&f(document).on("click."+b,function(d){f(d.target).parents(p).length||t.close(d);}),u.closeOnEsc&&f(document).on("keydown."+b,function(d){d.keyCode==27&&t.close(d);});return t;},close:function(d){if(!t.isOpened()){return t;}d=d||f.Event(),d.type="onBeforeClose",s.trigger(d);if(!d.isDefaultPrevented()){o=!1,h[u.effect][1].call(t,function(){d.type="onClose",s.trigger(d);}),f(document).off("click."+b+" keydown."+b),c&&f.mask.close();return t;}},getOverlay:function(){return p;},getTrigger:function(){return v;},getClosers:function(){return q;},isOpened:function(){return o;},getConf:function(){return u;}}),f.each("onBeforeLoad,onStart,onLoad,onBeforeClose,onClose".split(","),function(d,k){f.isFunction(u[k])&&f(t).on(k,u[k]),t[k]=function(l){l&&f(t).on(k,l);return t;};}),q=p.find(u.close||".close"),!q.length&&!u.close&&(q=f('<a class="close"></a>'),p.prepend(q)),q.click(function(d){t.close(d);}),u.load&&t.load();}f.fn.overlay=function(b){var a=this.data("overlay");if(a){return a;}f.isFunction(b)&&(b={onBeforeLoad:b}),b=f.extend(!0,{},f.tools.overlay.conf,b),this.each(function(){a=new g(f(this),b),e.push(a),f(this).data("overlay",a);});return b.api?a:this;};})(jQuery);function initializeChartbeat(a,c,b){window._sf_startpt=(new Date()).getTime();window._sf_async_config={};window._sf_async_config.uid=37612;window._sf_async_config.useCanonical=true;window._sf_async_config.domain=a;window._sf_async_config.sections=c;window._sf_async_config.authors=b;}function loadChartbeat(d,b){var a=location.host;if(a=="localhost"||a.indexOf("dev.cnn.com")>=0){a="ref.cnn.com";}initializeChartbeat(a,d,b);window._sf_endpt=(new Date()).getTime();var c=document.createElement("script");c.setAttribute("src",(("https:"===document.location.protocol)?"https://a248.e.akamai.net/chartbeat.download.akamai.com/102508/":"http://static.chartbeat.com/")+"js/chartbeat.js");document.body.appendChild(c);}var cnnzite_mod={"binUrlSuffix":"","maxStories":10,"maxTopicLength":20,"maxTopics":4,"topics":[],"updated":0,"urlParams":{},"ziteFeedUrl":"http://trends.cnn.com/summary?","ziteUrlSuffix":"/trends/","ziteSectionName":"","fillTopicTemplate":function(c,a){var b=['<a href="_URL_"><div id="topic_INDEX" class="topic">','<div class="topic_badge"></div>','<div class="topic_title">TITLE</div>',"</div></a>"].join("");
var d=b;d=d.replace(/INDEX/g,a);d=d.replace(/TITLE/g,cnnzite_mod.truncate(c.name,cnnzite_mod.maxTopicLength));d=d.replace(/_URL_/g,c.url+cnnzite_mod.binUrlSuffix);return d;},"setClick":function(){jQuery(".cnn_zitemodule").click(function(){window.location.href=cnnzite_mod.ziteUrlSuffix;});},"fillModuleTemplate":function(){return('<div class="topics">'+cnnzite_mod.topics.join("")+"</div>");},"parse":function(b){var a;for(a=0;(a<b.clusters.length&&a<cnnzite_mod.maxTopics);a=a+1){cnnzite_mod.topics.push(cnnzite_mod.fillTopicTemplate(b.clusters[a],a+1));}},"render":function(){jQuery(".cnn_zitemodule").html(cnnzite_mod.fillModuleTemplate());cnnzite_mod.setClick();},"truncate":function(c,d){var b,a;if(c===null||c.length<=d){return c;}b=d-3;a=c.lastIndexOf(" ",b);if(a===-1){a=b-1;}return c;},"init":function(){cnnzite_mod.ziteSectionName="homepage";if(sectionName=="us"||sectionName=="world"||sectionName=="politics"||sectionName=="tech"||sectionName=="entertainment"){cnnzite_mod.ziteSectionName=sectionName;}cnnzite_mod.binUrlSuffix=(cnnzite_mod.ziteSectionName!=="homepage")?"#"+cnnzite_mod.ziteSectionName.toLowerCase()+"?hpt="+sectionName+"_zite1_featured":"?hpt=hp_zite1_featured";cnnzite_mod.ziteUrlSuffix+=cnnzite_mod.binUrlSuffix;cnnzite_mod.ziteFeedUrl+=(cnnzite_mod.ziteSectionName!=="homepage")?"section="+cnnzite_mod.ziteSectionName.toLowerCase()+"&callback=?":"callback=?";jQuery.getJSON(cnnzite_mod.ziteFeedUrl,{},cnnzite_mod.parse).always(cnnzite_mod.render);}};var cnn_Slider=(typeof Class==="object")?Class.create():{},cnn_SectionTechPulse;var cnnIsIntl=(location.hostname.indexOf("edition.")>-1)?true:false;cnn_Slider.prototype=Object.extend(new cnnHorizontalSlider(),{initialize:function(b){var a=this;this.config=b?b:{};this.defaults={nextButtonContainerId:"cnn_fabTechPulsenext",prevButtonContainerId:"cnn_fabTechPulseprev"};this.settings=Object.extend(this.defaults,this.config);try{this.elIdentifier=this.settings.stripClass||"cnn_SRLTpulse6";this.container=this.settings.stripContainerId||"cnn_TwitterSliderContainer";if(cnnIsIntl){this.viewPort=this.settings.displayWidth||500;}else{this.viewPort=this.settings.displayWidth||600;}this.currentTab=this.settings.currentTab||0;}catch(d){}try{this.prevClick=0;this.nextClick=0;this.locked=false;this.sliderWidth=this.findPanels();this.numScreens=this.sliderWidth;this.negativeOffSetMax=this.setOffSet();this.positiveOffSetMax=0;this.currentPanel=0;this.setSliderWidth();this.buildNav();this.getCurrentOffSet();this.durationMultiplier=0.5;this.containerContainerId="cnn_TwitterSliderContainerContainer";this.nexttimer=window.setInterval(function(){a.startNextSlide();},7000);}catch(c){}},showImages:function(a){},buildNav:function(){var b=$(this.settings.prevButtonContainerId),a=$(this.settings.nextButtonContainerId);b.className="cnn_SRLTplsbtnL cnn_SRLTplsbtnLoff";a.className=this.sliderWidth>1?"cnn_SRLTplsbtnR":"cnn_SRLTplsbtnR cnn_SRLTplsbtnRoff";if(this.sliderWidth>1){b.observe("click",this.startPrevSlideClick.bind(this));a.observe("click",this.startNextSlideClick.bind(this));}},startNextSlide:function(){if((this.currentPanel+1)<this.numScreens){this.btnSlide(this.currentPanel+1);}},startPrevSlide:function(){if($(this.containerContainerId)){$(this.containerContainerId).className="cnn_SRLTpulse5";}if(this.currentPanel>0){this.btnSlide(this.currentPanel-1);}},startNextSlideClick:function(){this.stopNextSlide();this.prevClick=0;if(this.locked){this.nextClick+=1;}else{this.startNextSlide();}},startPrevSlideClick:function(){this.stopNextSlide();this.nextClick=0;if(this.locked){this.prevClick+=1;}else{this.startPrevSlide();}},stopNextSlide:function(){if(this.nexttimer){this.nextClick=0;window.clearInterval(this.nexttimer);delete this.nexttimer;}},checkForNewBtnSlide:function(){if(this.prevClick>0){this.prevClick-=1;this.startPrevSlide();}else{if(this.nextClick>0){this.nextClick-=1;this.startNextSlide();}}},btnSlide:function(a){var e,b,c,d;if(!this.locked){e=this;this.locked=true;this.timer=setTimeout(function(){e.getCurrentOffSet();b=(a*e.viewPort)*-1;c=(b>e.currOffSet)?(b-e.currOffSet):(e.currOffSet-b)*-1;d=(c>0)?e.durationMultiplier*(c/e.viewPort):(e.durationMultiplier*(c/e.viewPort))*-1;if(d<0){d=d*-1;}if(e.currOffSet>e.negativeOffSetMax||e.currOffSet<e.positiveOffSetMax){new Effect.MoveBy($(e.container).id,0,c,{duration:d,beforeStart:function(){e.showImages();},afterFinish:function(){e.locked=false;e.setCurrentPanel();e.checkForNewBtnSlide();}});}},300);}},updateNav:function(){if((this.currentPanel+1)<this.numScreens){$(this.settings.nextButtonContainerId).className="cnn_SRLTplsbtnR";}else{$(this.settings.nextButtonContainerId).className="cnn_SRLTplsbtnR cnn_SRLTplsbtnRoff";if($(this.containerContainerId)){$(this.containerContainerId).className="cnn_SRLTpulse5_REnd";}}if(this.currentPanel>0){$(this.settings.prevButtonContainerId).className="cnn_SRLTplsbtnL";}else{$(this.settings.prevButtonContainerId).className="cnn_SRLTplsbtnL cnn_SRLTplsbtnLoff";}},varDefined:function(val){var t,expression="t = (typeof("+val+') !== "undefined");';eval(expression);return t;},returnVarValue:function(val){return eval(val);}});Event.observe(window,"load",function(){if($("cnn_TwitterSliderContainer")&&typeof cnn_SectionTechPulse!=="object"){cnn_SectionTechPulse=new cnn_Slider();}});